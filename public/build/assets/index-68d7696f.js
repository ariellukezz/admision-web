import{a as t,r as p,J as ke,C as Ce,e as X,a1 as Ee,o as u,c as b,u as m,w as a,F as M,y as I,a4 as N,Z as De,d as s,b as i,t as d,f as k,E as C,s as B,a2 as E,aL as Se,U as Ne,I as ze,S as Ae,j as Fe,B as Me,_ as Te,K as $e,H as Ue,aH as Ye,h as je,i as Pe,k as Ve,l as qe,V as Be,p as He,m as Le,q as Re,M as Ge}from"./app-8369d941.js";import{_ as Je}from"./AuthenticatedLayout-57540248.js";import Qe from"./tipo_observacion-10fbb51a.js";import{D as We,F as Ze}from"./documentos_observacion-8d82516d.js";import{_ as Xe}from"./_plugin-vue_export-helper-c27b6911.js";import{A as Ke}from"./AntdIcon-b45eea86.js";import{S as et}from"./SearchOutlined-207fd9c8.js";import{P as tt}from"./PlusOutlined-7c721285.js";import{a as at,F as ot}from"./FilePdfOutlined-8df3fe03.js";import{E as nt}from"./EyeOutlined-678d42b2.js";import{E as st}from"./EditOutlined-a8fe410c.js";import{D as lt}from"./DeleteOutlined-cadc4f0e.js";import{U as H}from"./UserOutlined-e599f140.js";import"./logotiny-c4b525af.js";import"./Header-93115f93.js";import"./DownOutlined-7371a0b0.js";/* empty css                                                            */import"./DownloadOutlined-84eaa031.js";import"./UploadOutlined-e5599e2d.js";var it={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 632H136V232h752v560zM610.3 476h123.4c1.3 0 2.3-3.6 2.3-8v-48c0-4.4-1-8-2.3-8H610.3c-1.3 0-2.3 3.6-2.3 8v48c0 4.4 1 8 2.3 8zm4.8 144h185.7c3.9 0 7.1-3.6 7.1-8v-48c0-4.4-3.2-8-7.1-8H615.1c-3.9 0-7.1 3.6-7.1 8v48c0 4.4 3.2 8 7.1 8zM224 673h43.9c4.2 0 7.6-3.3 7.9-7.5 3.8-50.5 46-90.5 97.2-90.5s93.4 40 97.2 90.5c.3 4.2 3.7 7.5 7.9 7.5H522a8 8 0 008-8.4c-2.8-53.3-32-99.7-74.6-126.1a111.8 111.8 0 0029.1-75.5c0-61.9-49.9-112-111.4-112s-111.4 50.1-111.4 112c0 29.1 11 55.5 29.1 75.5a158.09 158.09 0 00-74.6 126.1c-.4 4.6 3.2 8.4 7.8 8.4zm149-262c28.5 0 51.7 23.3 51.7 52s-23.2 52-51.7 52-51.7-23.3-51.7-52 23.2-52 51.7-52z"}}]},name:"idcard",theme:"outlined"};const rt=it;function K(x){for(var c=1;c<arguments.length;c++){var f=arguments[c]!=null?Object(arguments[c]):{},v=Object.keys(f);typeof Object.getOwnPropertySymbols=="function"&&(v=v.concat(Object.getOwnPropertySymbols(f).filter(function(_){return Object.getOwnPropertyDescriptor(f,_).enumerable}))),v.forEach(function(_){ut(x,_,f[_])})}return x}function ut(x,c,f){return c in x?Object.defineProperty(x,c,{value:f,enumerable:!0,configurable:!0,writable:!0}):x[c]=f,x}var L=function(c,f){var v=K({},c,f.attrs);return t(Ke,K({},v,{icon:rt}),null)};L.displayName="IdcardOutlined";L.inheritAttrs=!1;const dt=L;const ct={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4",style:{height:"calc(100vh - 98px)"}},pt={class:""},mt={class:"flex justify-between items-center gap-2"},ft={class:"flex justify-between",style:{position:"relative"}},_t={class:"flex justify-between my-4"},vt={class:"flex justify-between gap-2 w-full"},gt={class:"flex gap-2"},bt={style:{}},yt={key:0,class:"flex flex-col"},xt={class:"font-semibold text-gray-800"},ht={class:"text-sm text-gray-500"},Ot={key:1,class:"flex flex-col space-y-1"},wt={class:"flex items-center gap-1"},It={class:"font-medium"},kt={key:0,class:"flex items-center gap-1"},Ct={class:"font-medium"},Et={key:1,class:"text-xs text-gray-400"},Dt={key:0,class:"flex items-center gap-2"},St={class:"text-blue-600 hover:text-blue-800 cursor-pointer text-sm underline"},Nt={key:1,class:"text-gray-400 text-sm"},zt={class:"flex justify-end mt-4"},At={class:"flex justify-center"},Ft={class:"flex justify-end mt-4"},Mt={__name:"index",setup(x){const c=p([]),f=p([]),v=p(""),_=p(1),T=p(10),U=p(0),R=p([]),z=p("vigente"),A=p(null),Y=p([]),j=p(!1),P=p(!1),l=ke({id:null,dni:"",nombres:"",paterno:"",materno:"",tipo_id:null,concepto_id:null,documento_id:null,fecha_sancion:"",fecha_fin_sancion:"",observaciones:""}),D=p(!1),ee={dni:[{required:!0,message:"El DNI es obligatorio"}],nombres:[{required:!0,message:"Los nombres son obligatorios"}],paterno:[{required:!0,message:"El apellido paterno es obligatorio"}],tipo_id:[{required:!0,message:"El tipo es obligatorio"}],fecha_sancion:[{required:!0,message:"La fecha de sanción es obligatoria"}]},te=[{title:"ID",dataIndex:"id",key:"id",width:70,align:"center"},{title:"DATOS PERSONALES",key:"datos_personales",width:250,ellipsis:!0},{title:"FECHAS",key:"fechas",width:150,align:"center"},{title:"TIPO",key:"tipo_observacion",width:200,ellipsis:!0},{title:"CATEGORÍA",key:"categoria",width:180,ellipsis:!0},{title:"DOCUMENTO",key:"documento",width:150,ellipsis:!0},{title:"ESTADO",key:"estado",width:120,align:"center"},{title:"ACCIONES",key:"acciones",width:100,align:"center",fixed:"right"}],ae=Ce(()=>({current:_.value,pageSize:T.value,total:U.value,showSizeChanger:!0,showQuickJumper:!0,showTotal:(o,e)=>`${e[0]}-${e[1]} de ${o} observados`}));X([v,z,A],()=>{_.value=1,O()}),X(_,()=>{O()});const oe=()=>{G(),D.value=!0},G=()=>{Object.assign(l,{id:null,dni:"",nombres:"",paterno:"",materno:"",tipo_id:null,concepto_id:null,documento_id:null,fecha_sancion:"",fecha_fin_sancion:"",observaciones:""})},O=async()=>{j.value=!0;try{let o=`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/all?page=${_.value}&limit=${T.value}`;v.value&&(o+=`&search=${v.value}`),z.value!=="todos"&&(o+=`&vigencia=${z.value}`),A.value&&(o+=`&tipo=${A.value}`);const e=await I.get(o);Y.value=e.data.data||[],U.value=e.data.count||Y.value.length}catch(o){console.error("Error al cargar observados:",o),N.error("Error al cargar los observados")}finally{j.value=!1}},ne=async()=>{try{const o=await I.get("https://servicios-admision.unap.edu.pe/api/v1/observados/tipos-select");R.value=o.data.data}catch(o){console.error("Error al cargar tipos:",o)}},se=async()=>{try{const o=await I.get("https://servicios-admision.unap.edu.pe/api/v1/observados/conceptos-select");f.value=o.data.data}catch(o){console.error("Error al cargar conceptos:",o)}},le=async()=>{try{const o=await I.get("https://servicios-admision.unap.edu.pe/api/v1/observados/documentos-select");c.value=o.data.data}catch(o){console.error("Error al cargar documentos:",o)}},J=o=>o?E(o).format("DD/MM/YYYY"):"-",ie=o=>{const e={"SUPLANTACIÓN DE IDENTIDAD":"red",FALSIFICACIÓN:"volcano",OMISIÓN:"orange",default:"blue"};return e[o]||e.default},re=o=>{const e={"INHABILITACION INDEFINIDA":"red","INHABILITACION TEMPORAL":"orange","SANCIÓN ECONÓMICA":"purple",default:"green"};return e[o]||e.default},ue=o=>{const e=E(),h=o.fecha_fin?E(o.fecha_fin):null;return h?h.isAfter(e)?"green":"red":"blue"},de=o=>{const e=E(),h=o.fecha_fin?E(o.fecha_fin):null;return!h||h.isAfter(e)?"Vigente":"Expirado"},ce=o=>{console.log("Ver detalles:",o)},pe=o=>{Object.assign(l,{id:o.id,dni:o.dni,nombres:o.nombres,paterno:o.paterno,materno:o.materno,tipo_id:o.tipo_id,concepto_id:o.concepto_id,documento_id:o.documento_id,fecha_sancion:o.fecha_sancion,fecha_fin_sancion:o.fecha_fin,observaciones:o.observaciones}),D.value=!0},me=async o=>{try{await I.delete(`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/${o}`),N.success("Observado eliminado correctamente"),O()}catch(e){console.error("Error al eliminar:",e),N.error("Error al eliminar el observado")}},fe=async()=>{try{P.value=!0;const o={...l,fecha_sancion:l.fecha_sancion?E(l.fecha_sancion).format("YYYY-MM-DD"):null,fecha_fin_sancion:l.fecha_fin_sancion?E(l.fecha_fin_sancion).format("YYYY-MM-DD"):null};l.id?(await I.put(`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/${l.id}`,o,{headers:{"Content-Type":"application/json"}}),N.success("Observado actualizado correctamente")):(await I.post("https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones",o,{headers:{"Content-Type":"application/json"}}),N.success("Observado creado correctamente")),O(),D.value=!1,G()}catch(o){console.error("Error:",o),N.error("Error al guardar el observado")}finally{P.value=!1}},_e=(o,e)=>{_.value=o,e.value=e},ve=(o,e)=>{T.value=e};return Ee(()=>{O(),ne(),se(),le()}),(o,e)=>{const h=Se,ge=Ne,F=ze,S=Ae,$=Fe,w=Me,V=Te,q=$e,be=Ue,ye=Ye,xe=je,he=Pe,y=Ve,g=qe,Q=Be,Oe=He,W=Le,we=Re,Ie=Ge;return u(),b(M,null,[t(m(De),{title:"Observados"}),t(Je,null,{default:a(()=>[s("div",ct,[s("div",pt,[e[21]||(e[21]=s("div",{class:"mb-4"},[s("span",{class:"text-xl font-bold text-gray-800"},"Gestión de Observados")],-1)),s("div",mt,[s("div",null,[t(ge,{value:z.value,"onUpdate:value":e[0]||(e[0]=n=>z.value=n),onChange:O},{default:a(()=>[t(h,{value:"vigente"},{default:a(()=>e[18]||(e[18]=[i("Vigente")])),_:1}),t(h,{value:"no-vigente"},{default:a(()=>e[19]||(e[19]=[i("No vigente")])),_:1}),t(h,{value:"todos"},{default:a(()=>e[20]||(e[20]=[i("Todos")])),_:1})]),_:1},8,["value"])]),s("div",ft,[t(F,{type:"text",placeholder:"Buscar por DNI o nombres...",value:v.value,"onUpdate:value":e[1]||(e[1]=n=>v.value=n),style:{"max-width":"460px"},onChange:O},{prefix:a(()=>[t(m(et))]),_:1},8,["value"])])])]),s("div",_t,[s("div",vt,[s("div",null,[t($,{value:A.value,"onUpdate:value":e[2]||(e[2]=n=>A.value=n),style:{"min-width":"232px"},placeholder:"Filtrar por tipo",onChange:O,"allow-clear":""},{default:a(()=>[t(S,{value:"indefinida"},{default:a(()=>e[22]||(e[22]=[i("Inhabilitación indefinida")])),_:1}),t(S,{value:"temporal"},{default:a(()=>e[23]||(e[23]=[i("Inhabilitación temporal")])),_:1}),t(S,{value:"economica"},{default:a(()=>e[24]||(e[24]=[i("Sanción económica")])),_:1})]),_:1},8,["value"])]),s("div",gt,[s("div",null,[t(We)]),s("div",null,[t(Qe)]),t(w,{onClick:e[3]||(e[3]=n=>oe()),type:"primary",class:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2"},{default:a(()=>[t(m(tt)),e[25]||(e[25]=i(" Nuevo Observado "))]),_:1}),t(w,{type:"primary",class:"bg-red-600 hover:bg-red-700 text-white flex items-center gap-2"},{default:a(()=>[t(m(at)),e[26]||(e[26]=i(" PDF "))]),_:1}),t(w,{type:"primary",class:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2"},{default:a(()=>[t(m(ot)),e[27]||(e[27]=i(" Excel "))]),_:1})])])]),s("div",bt,[t(xe,{columns:te,"data-source":Y.value,loading:j.value,pagination:ae.value,size:"middle",scroll:{x:1200,y:"calc(100vh - 280px)"},class:"observados-table"},{bodyCell:a(({column:n,record:r})=>[n.key==="datos_personales"?(u(),b("div",yt,[s("div",xt,d(r.nombres)+" "+d(r.paterno)+" "+d(r.materno),1),s("div",ht," DNI: "+d(r.dni),1)])):k("",!0),n.key==="fechas"?(u(),b("div",Ot,[s("div",wt,[e[28]||(e[28]=s("span",{class:"text-xs text-gray-500"},"Inicio:",-1)),s("span",It,d(J(r.fecha_sancion)),1)]),r.fecha_fin?(u(),b("div",kt,[e[29]||(e[29]=s("span",{class:"text-xs text-gray-500"},"Fin:",-1)),s("span",Ct,d(J(r.fecha_fin)),1)])):(u(),b("div",Et," Sin fecha fin "))])):k("",!0),n.key==="tipo_observacion"?(u(),C(V,{key:2,color:ie(r.tipo_observacion),class:"font-semibold px-2 py-1 text-xs"},{default:a(()=>[i(d(r.tipo_observacion),1)]),_:2},1032,["color"])):k("",!0),n.key==="categoria"?(u(),C(V,{key:3,color:re(r.categoria),class:"font-semibold px-2 py-1 text-xs"},{default:a(()=>[i(d(r.categoria),1)]),_:2},1032,["color"])):k("",!0),n.key==="documento"?(u(),b(M,{key:4},[r.documento?(u(),b("div",Dt,[t(m(Ze),{class:"text-blue-500"}),s("span",St,d(r.documento),1)])):(u(),b("span",Nt,"Sin documento"))],64)):k("",!0),n.key==="estado"?(u(),C(V,{key:5,color:ue(r),class:"font-semibold"},{default:a(()=>[i(d(de(r)),1)]),_:2},1032,["color"])):k("",!0),n.key==="acciones"?(u(),C(ye,{key:6,size:"small"},{default:a(()=>[t(q,{title:"Ver detalles"},{default:a(()=>[t(w,{type:"link",size:"small",onClick:Z=>ce(r),class:"text-blue-600 p-0"},{default:a(()=>[t(m(nt))]),_:2},1032,["onClick"])]),_:2},1024),t(q,{title:"Editar"},{default:a(()=>[t(w,{type:"link",size:"small",onClick:Z=>pe(r),class:"text-green-600 p-0"},{default:a(()=>[t(m(st))]),_:2},1032,["onClick"])]),_:2},1024),t(q,{title:"Eliminar"},{default:a(()=>[t(be,{title:"¿Estás seguro de eliminar este observado?",onConfirm:Z=>me(r.id)},{default:a(()=>[t(w,{type:"link",danger:"",size:"small",class:"p-0"},{default:a(()=>[t(m(lt))]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)):k("",!0)]),_:1},8,["data-source","loading","pagination"])]),s("div",zt,[t(he,{current:_.value,"onUpdate:current":e[4]||(e[4]=n=>_.value=n),"page-size":T.value,total:U.value,"show-size-changer":"",onChange:_e,onShowSizeChange:ve},null,8,["current","page-size","total"])])]),t(Ie,{open:D.value,"onUpdate:open":e[17]||(e[17]=n=>D.value=n),title:l.id?"Editar Observado":"Nuevo Observado",footer:!1,width:"90%",styles:{maxWidth:"900px"},centered:""},{default:a(()=>[s("div",At,[t(W,{style:{display:"flex","justify-content":"center"}},{default:a(()=>[t(g,{span:24},{default:a(()=>[t(we,{ref:"formDatos",name:"form",model:l,rules:ee},{default:a(()=>[t(W,{gutter:16,class:"mt-3"},{default:a(()=>[t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[30]||(e[30]=s("label",null,[i("DNI "),s("span",{style:{color:"red"}},"*")],-1)),t(y,{name:"dni",rules:[{required:!0,message:"Ingrese el DNI"}]},{default:a(()=>[t(F,{value:l.dni,"onUpdate:value":e[5]||(e[5]=n=>l.dni=n),placeholder:"Número de DNI",maxlength:8,size:"large"},{prefix:a(()=>[t(m(dt))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[31]||(e[31]=s("label",null,[i("Nombres "),s("span",{style:{color:"red"}},"*")],-1)),t(y,{name:"nombres",rules:[{required:!0,message:"Ingrese los nombres"}]},{default:a(()=>[t(F,{value:l.nombres,"onUpdate:value":e[6]||(e[6]=n=>l.nombres=n),placeholder:"Nombres completos",size:"large"},{prefix:a(()=>[t(m(H))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[32]||(e[32]=s("label",null,[i("Apellido Paterno "),s("span",{style:{color:"red"}},"*")],-1)),t(y,{name:"paterno",rules:[{required:!0,message:"Ingrese apellido paterno"}]},{default:a(()=>[t(F,{value:l.paterno,"onUpdate:value":e[7]||(e[7]=n=>l.paterno=n),placeholder:"Apellido paterno",size:"large"},{prefix:a(()=>[t(m(H))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[33]||(e[33]=s("label",null,"Apellido Materno",-1)),t(y,{name:"materno"},{default:a(()=>[t(F,{value:l.materno,"onUpdate:value":e[8]||(e[8]=n=>l.materno=n),placeholder:"Apellido materno",size:"large"},{prefix:a(()=>[t(m(H))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[34]||(e[34]=s("label",null,[i("Tipo "),s("span",{style:{color:"red"}},"*")],-1)),t(y,{name:"tipo_id",rules:[{required:!0,message:"Seleccione el tipo"}]},{default:a(()=>[t($,{value:l.tipo_id,"onUpdate:value":e[9]||(e[9]=n=>l.tipo_id=n),placeholder:"Seleccione tipo",style:{width:"100%"},size:"large"},{default:a(()=>[(u(!0),b(M,null,B(R.value,n=>(u(),C(S,{key:n.value,value:n.value},{default:a(()=>[i(d(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[35]||(e[35]=s("label",null,"Concepto",-1)),t(y,{name:"concepto_id"},{default:a(()=>[t($,{value:l.concepto_id,"onUpdate:value":e[10]||(e[10]=n=>l.concepto_id=n),placeholder:"Seleccione concepto",style:{width:"100%"},size:"large"},{default:a(()=>[(u(!0),b(M,null,B(f.value,n=>(u(),C(S,{key:n.id,value:n.id},{default:a(()=>[i(d(n.nombre),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:8},{default:a(()=>[e[36]||(e[36]=s("label",null,"Documento",-1)),t(y,{name:"documento_id"},{default:a(()=>[t($,{value:l.documento_id,"onUpdate:value":e[11]||(e[11]=n=>l.documento_id=n),placeholder:"Seleccione documento",style:{width:"100%"},size:"large"},{default:a(()=>[(u(!0),b(M,null,B(c.value,n=>(u(),C(S,{key:n.value,value:n.value},{default:a(()=>[i(d(n.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:12},{default:a(()=>[e[37]||(e[37]=s("label",null,[i("Fecha Sanción "),s("span",{style:{color:"red"}},"*")],-1)),t(y,{name:"fecha_sancion",rules:[{required:!0,message:"Seleccione fecha de sanción"}]},{default:a(()=>[t(Q,{value:l.fecha_sancion,"onUpdate:value":e[12]||(e[12]=n=>l.fecha_sancion=n),style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Seleccione fecha",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:12,md:12},{default:a(()=>[e[38]||(e[38]=s("label",null,"Fecha Fin Sanción",-1)),t(y,{name:"fecha_fin_sancion"},{default:a(()=>[t(Q,{value:l.fecha_fin_sancion,"onUpdate:value":e[13]||(e[13]=n=>l.fecha_fin_sancion=n),style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Seleccione fecha fin",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(g,{xs:24,sm:24,md:24},{default:a(()=>[e[39]||(e[39]=s("label",null,"Observaciones",-1)),t(y,{name:"observaciones"},{default:a(()=>[t(Oe,{value:l.observaciones,"onUpdate:value":e[14]||(e[14]=n=>l.observaciones=n),placeholder:"Ingrese observaciones",rows:3,size:"large"},null,8,["value"])]),_:1})]),_:1})]),_:1}),s("div",Ft,[s("div",null,[t(w,{type:"primary",class:"mr-2",onClick:e[15]||(e[15]=n=>D.value=!1),style:{"border-radius":"6px",background:"none",color:"#476175",border:"1px solid #476175"},size:"large"},{default:a(()=>e[40]||(e[40]=[i(" Cancelar ")])),_:1}),t(w,{type:"primary",onClick:e[16]||(e[16]=n=>fe()),style:{"border-radius":"6px",background:"#476175",border:"none"},loading:P.value,size:"large"},{default:a(()=>[i(d(l.id?"Actualizar":"Guardar"),1)]),_:1},8,["loading"])])])]),_:1},8,["model"])]),_:1})]),_:1})])]),_:1},8,["open","title"])]),_:1})],64)}}},ea=Xe(Mt,[["__scopeId","data-v-273e11f7"]]);export{ea as default};
