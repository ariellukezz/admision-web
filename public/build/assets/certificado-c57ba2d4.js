import{a3 as Q,r as d,J as W,D as X,o as r,c as f,d as o,a as l,w as s,F as P,s as Y,y as k,B as Z,M as ee,b as u,t as C,f as _,E as U,u as oe,aL as D,l as te,m as se,j as le,k as ae,I as ne,aM as ie,q as re}from"./app-c39b6060.js";import"./es-e57225d3.js";const de={class:"mt-6"},ue={class:"flex justify-between border-b-2",style:{"border-bottom":"solid 2px #009DD1","padding-bottom":"8px"}},pe={style:{"margin-top":"-5px"}},fe={class:"mt-3"},ce={class:"flex justify-between",style:{}},ve={class:""},me={class:"font-bold",style:{"font-size":"1rem"}},_e={key:0},ge={key:1},be={class:"flex",style:{"margin-top":"0px"}},we={class:""},ye={key:0,class:"mt-2"},xe=["src"],he={key:0,class:"mt-2"},ke=["src"],Ce={class:"flex justify-end"},De={key:0,class:"mt-2"},Le=["src"],Fe={class:"flex justify-end"},Ae={__name:"certificado",props:["id_proceso","dni"],setup(j){const L=window.location.origin;Q.locale("es");const g=j,z=()=>{c.value=!0},N=t=>{a.value={id:null,observacion:"",tipo:null,fileList:[]},a.id=t.id,a.observacion=t.observacion,p.value=L+"/"+t.url,a.tipo=t.id_tipo,c.value=!0},c=d(!1),F=d([]),S=d([{value:1,label:"CERTIFICADO BLANCO"},{value:2,label:"CERTIFICADO AMARILLO"}]),b=d(!1),y=d(null),$=t=>{y.value=t,b.value=!0},I=d(),a=W({id:null,observacion:"",tipo:null,fileList:[]}),V=t=>{console.log(`selected ${t}`)},q=async t=>{(await k.get("/eliminar-certificado/"+t)).data.estado==!0?x():console.log("Ocurrió un error")},v=d(!1),p=d(null),O=d(0),A=t=>{if(t.type==="application/pdf"){const e=new FileReader;e.onload=i=>{p.value=i.target.result},e.readAsDataURL(t),a.fileList=[t]}else D.error("¡Solo puedes cargar archivos PDF!");return!1},x=async()=>{const t=await k.post("/get-certificados-postulante",{dni:g.dni,id_proceso:g.id_proceso});t.data.estado==!0?F.value=t.data.datos:console.log("No se encontraron datos")},R=()=>{p.value=null,a.fileList=[]},G=async()=>{await I.value.validateFields();const t=new FormData;a.fileList[0]&&t.append("file",a.fileList[0]),a.id!=null&&t.append("id",a.id),t.append("id_proceso",g.id_proceso),t.append("dni",g.dni),t.append("observacion",a.observacion),t.append("tipo",a.tipo);try{v.value=!0,O.value=0;const e=await k.post("/save-certificado",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer your-auth-token"},onUploadProgress:i=>{O.value=Math.round(i.loaded*100/i.total)}});c.value=!1,v.value=!1,D.success("¡Archivo PDF cargado exitosamente!"),await x()}catch(e){v.value=!1,D.error("Error al cargar el archivo."),console.error("File upload failed:",e)}};return x(),(t,e)=>{const i=Z,m=te,h=se,H=le,w=ae,J=ne,E=X("upload-outlined"),B=ie,K=re,T=ee;return r(),f(P,null,[o("div",de,[o("div",null,[o("div",ue,[e[7]||(e[7]=o("div",null,[o("span",{style:{"font-weight":"bold","font-size":"1rem",color:"#009DD1"}},"CERTIFICADO DE ESTUDIOS")],-1)),o("div",pe,[l(i,{onClick:e[0]||(e[0]=n=>z())},{default:s(()=>e[6]||(e[6]=[u("Agregar")])),_:1})])]),o("div",fe,[(r(!0),f(P,null,Y(F.value,n=>(r(),f("div",{class:"mb-2",key:n},[l(h,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[o("div",ce,[o("div",ve,[o("div",null,[o("span",me,C(),1)]),n.id_tipo==1?(r(),f("div",_e,e[8]||(e[8]=[o("span",{class:"font-bold",style:{"font-size":"1rem"}}," CERTIFICADO BLANCO",-1)]))):_("",!0),n.id_tipo==2?(r(),f("div",ge,e[9]||(e[9]=[o("span",{class:"font-bold",style:{"font-size":"1rem"}}," CERTIFICADO AMARILLO",-1)]))):_("",!0),o("div",null,[e[10]||(e[10]=o("span",{class:""},"TIPO DE COLEGIO: ",-1)),u(" "+C(n.gestion),1)])]),o("div",be,[l(i,{onClick:M=>$(n.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>e[11]||(e[11]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-eye"},[o("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o("circle",{cx:"12",cy:"12",r:"3"})],-1)])),_:2},1032,["onClick"]),l(i,{onClick:M=>N(n),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>e[12]||(e[12]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1a2843","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit-2"},[o("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})],-1)])),_:2},1032,["onClick"]),l(i,{danger:"",onClick:M=>q(n.id),style:{width:"20px",height:"20px","padding-left":"3px"}},{default:s(()=>e[13]||(e[13]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trash"},[o("polyline",{points:"3 6 5 6 21 6"}),o("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024)]))),128))])])]),o("div",we,[l(T,{visible:c.value,"onUpdate:visible":e[3]||(e[3]=n=>c.value=n),width:"800px",class:"w-full md:w-3/4",title:"Registro de certificado",onOk:t.handleOk},{footer:s(()=>[o("div",Ce,[l(i,{type:"primary",disabled:!p.value,loading:v.value,style:{"margin-top":"16px"},onClick:G},{default:s(()=>[u(C(v.value?"Subiendo...":"Guardar datos"),1)]),_:1},8,["disabled","loading"])])]),default:s(()=>[l(K,{ref_key:"formDatos",ref:I,name:"form",model:a,rules:t.formRules},{default:s(()=>[l(h,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[14]||(e[14]=o("label",null,[u("Tipo"),o("span",{style:{color:"red"}},"*")],-1)),l(w,{name:"tipo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[l(H,{ref:"select",value:a.tipo,"onUpdate:value":e[1]||(e[1]=n=>a.tipo=n),style:{width:"100%"},options:S.value,onFocus:t.focus,onChange:V},null,8,["value","options","onFocus"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[16]||(e[16]=o("label",null,[u("Observación"),o("span",{style:{color:"red"}})],-1)),l(w,{name:"observacion"},{default:s(()=>[l(J,{value:a.observacion,"onUpdate:value":e[2]||(e[2]=n=>a.observacion=n),style:{height:"32px"}},{suffix:s(()=>e[15]||(e[15]=[])),_:1},8,["value"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[19]||(e[19]=o("label",null,[u("Archivo PDF (Max. 2mb)"),o("span",{style:{color:"red"}},"*")],-1)),a.id==null?(r(),U(w,{key:0,name:"fileList",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[l(B,{"file-list":a.fileList,"before-upload":A,onRemove:R},{default:s(()=>[l(i,null,{default:s(()=>[l(E),e[17]||(e[17]=u(" Seleccionar archivo PDF "))]),_:1})]),_:1},8,["file-list"]),p.value?(r(),f("div",ye,[o("iframe",{src:p.value,width:"100%",height:"300px"},null,8,xe)])):_("",!0)]),_:1})):(r(),U(w,{key:1,name:"fileList"},{default:s(()=>[l(B,{"file-list":a.fileList,"before-upload":A,onRemove:R},{default:s(()=>[l(i,null,{default:s(()=>[l(E),e[18]||(e[18]=u(" Seleccionar archivo PDF "))]),_:1})]),_:1},8,["file-list"]),p.value?(r(),f("div",he,[o("iframe",{src:p.value,width:"100%",height:"300px"},null,8,ke)])):_("",!0)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk"]),l(T,{visible:b.value,"onUpdate:visible":e[5]||(e[5]=n=>b.value=n),title:"Registro de título",style:{"min-width":"1000px"}},{footer:s(()=>[o("div",Fe,[l(i,{onClick:e[4]||(e[4]=n=>b.value==!1)},{default:s(()=>e[20]||(e[20]=[u(" Aceptar ")])),_:1})])]),default:s(()=>[l(h,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[y.value?(r(),f("div",De,[o("iframe",{src:oe(L)+"/"+y.value,width:"100%",height:"500px"},null,8,Le)])):_("",!0)]),_:1})]),_:1})]),_:1},8,["visible"])])],64)}}};export{Ae as default};
