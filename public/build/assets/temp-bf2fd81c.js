import{r as l,C as v,o as f,E as m,w as h,a4 as r,y as c,B as _,b as w,t as y}from"./app-118d4e8c.js";const k={__name:"temp",setup(g){const e=l(!1),n=l(null),d=l(null),u=v(()=>e.value?"Preparando archivo...":n.value==="ready"?"Descargar ahora":"Descargar documentos"),i=async()=>{try{e.value=!0,r.info("Preparando archivo, esto puede tomar unos minutos...");const t=await c.post(route("download.prepare"),{},{headers:{"X-Requested-With":"XMLHttpRequest"}}),a=setInterval(async()=>{try{const o=(await c.get(route("download.status"))).data;o.status==="ready"?(clearInterval(a),n.value="ready",d.value=o.download_url,e.value=!1,r.success("Archivo listo para descargar"),p(o.download_url)):o.status==="failed"&&(clearInterval(a),e.value=!1,r.error("Error al preparar el archivo"))}catch{clearInterval(a),e.value=!1,r.error("Error al verificar el estado")}},5e3)}catch{e.value=!1,r.error("Error al iniciar la descarga")}},p=t=>{const a=document.createElement("a");a.href=t,a.target="_blank",a.download="",document.body.appendChild(a),a.click(),document.body.removeChild(a)};return(t,a)=>{const s=_;return f(),m(s,{type:"primary",loading:e.value,disabled:e.value,onClick:i},{default:h(()=>[w(y(u.value),1)]),_:1},8,["loading","disabled"])}}};export{k as default};
