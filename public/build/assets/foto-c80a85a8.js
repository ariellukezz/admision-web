import{o as i,c as n,a as d,u as f,w as l,F as g,y as v,Z as y,d as c,x as _,f as p,b as C,B as A,I as P}from"./app-8dc9d78c.js";import{A as w}from"./LayoutDocente-d9bb90f2.js";import"./NavLink-ff68e460.js";import"./logotiny-c4b525af.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./TopMenu-a0162665.js";import"./DropdownLink-09e02d11.js";import"./DownOutlined-848603b6.js";import"./AntdIcon-681856c5.js";const x={class:"flex",style:{padding:"20px"}},b={ref:"captureContainer",style:{position:"relative"}},k={ref:"videoElement",autoplay:""},E={key:1,class:"flex justify-center",style:{"margin-top":"-50px"}},$={key:0,style:{"margin-bottom":"-40px"}},B=["src"],L={class:"flex justify-between mt-3",style:{padding:"0px 20px"}},I={key:0,style:{width:"300px"}},T={data(){return{dni:null,capturedPhoto:null,cropAreaTop:0,cropAreaLeft:120,cropAreaWidth:400,cropAreaHeight:480,cargado:!1}},watch:{dni(e,t){this.dni.length===8&&this.capturePhoto()}},mounted(){this.initializeCamera()},beforeUnmount(){this.stopCamera()},methods:{async initializeCamera(){try{const e={video:!0},t=await navigator.mediaDevices.getUserMedia(e);this.$refs.videoElement.srcObject=t,this.cargado=!0}catch(e){console.error("Error al acceder a la cámara: ",e)}},stopCamera(){const e=this.$refs.videoElement.srcObject;e&&e.getTracks().forEach(t=>t.stop())},capturePhoto(){const e=this.$refs.videoElement,t=document.createElement("canvas"),o=t.getContext("2d"),a=this.$refs.cropArea,r=a.offsetWidth,s=a.offsetHeight,u=a.offsetLeft-e.offsetLeft,h=a.offsetTop-e.offsetTop;t.width=r,t.height=s,o.drawImage(e,u,h,r,s,0,0,r,s);const m=t.toDataURL();this.capturedPhoto=m,this.saveCroppedPhotoBiometrico()},saveCroppedPhotoBiometrico(){this.capturedPhoto&&v.post("guardar-foto-inscripcion",{dni:this.dni,photo:this.capturedPhoto}).then(e=>{console.log("Foto recortada guardada correctamente")}).catch(e=>{console.error("Error al guardar la foto recortada: ",e)})}}},W=Object.assign(T,{__name:"foto",setup(e){return(t,o)=>{const a=A,r=P;return i(),n(g,null,[d(f(y),{title:"Inscripciones-impresión"}),d(w,null,{default:l(()=>[c("div",x,[c("div",b,[c("video",k,null,512),t.cargado===!0?(i(),n("div",{key:0,ref:"cropArea",style:_(`position: absolute; top: ${t.cropAreaTop}px; left: ${t.cropAreaLeft}px; width: ${t.cropAreaWidth}px; height: ${t.cropAreaHeight}px; border: 1px dashed gray;`)},null,4)):p("",!0),t.cargado===!0?(i(),n("div",E,[d(a,{type:"primary",onClick:t.capturePhoto},{default:l(()=>o[1]||(o[1]=[C("Capturar Foto")])),_:1},8,["onClick"])])):p("",!0)],512),t.capturedPhoto?(i(),n("div",$,[c("img",{src:t.capturedPhoto,alt:"Foto Capturada"},null,8,B)])):p("",!0)]),c("div",L,[t.cargado===!0?(i(),n("div",I,[d(r,{value:t.dni,"onUpdate:value":o[0]||(o[0]=s=>t.dni=s),placeholder:"Ingrese DNI"},null,8,["value"])])):p("",!0)])]),_:1})],64)}}});export{W as default};
