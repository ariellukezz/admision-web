import{r as o,e as H,D as Y,o as p,c as v,d as a,a as s,w as r,f as _,y as c,B as G,h as J,M as K,b as m,t as U,F as Q,u as W,I as X,L as Z}from"./app-3d5418a6.js";import{D as ee}from"./DownOutlined-3cfe1b48.js";import"./AntdIcon-29d1c834.js";const te={class:"mt-0 mb-4"},oe={class:"class flex justify-between"},ae={class:"mt-0 mb-4"},ne={class:"flex",style:{gap:"5px"}},se={key:0,class:"mt-0 mb-4"},le={class:"mt-0 mb-4"},re={key:0},de={key:0},ie={style:{display:"flex",gap:"16px"},class:"mt-4"},ue={class:"mt-3"},ce={class:"flex justify-end mt-4"},pe={class:"mr-2"},be={__name:"calificacion",props:["proceso"],setup(h){const w=h;o(1);const g=o(null),f=o(""),y=o([]),D=(t,e)=>{g.value=e};H(f,(t,e)=>{E()});const j=o([]),F=o(0),L=o(1),P=o(10);o("");const x=o(1),S=o(0),k=o(0),R=o([]),B=o([]),M=o([]);o(null),o(null),o(null);const E=async()=>{let t=await c.post("get-ponderaciones-select?page="+L.value,{term:f.value,paginasize:P.value});j.value=t.data.datos.data,F.value=t.data.datos.total},N=async()=>{await c.post("/calificar-examen",{id_simulacro:w.proceso,id_ponderacion:g.value.key,correctas:x.value,incorrectas:S.value,blanco:k.value}),b.value=!1,I()},I=async()=>{let t=await c.post("/get-puntajes-examen",{id_simulacro:w.proceso});y.value=t.data.datos};I();const b=o(!1);E();const A=t=>Number(t).toFixed(2),V=o([{title:"N째",dataIndex:"nro",align:"center"},{title:"DNI",dataIndex:"dni"},{title:"Ap. Paterno",dataIndex:"paterno"},{title:"Ap. Materno",dataIndex:"materno"},{title:"Nombres",dataIndex:"nombres"},{title:"Puntaje",dataIndex:"puntaje",align:"center"}]);(async()=>{c.get("/calificacion/get-select-puestos").then(t=>{R.value=t.data.puestos,B.value=t.data.codigos_puesto,M.value=t.data.unidades}).catch(t=>{t.response?console.error("Error de servidor:",t.response.data):t.request?console.error("Error de red:",t.request):console.error("Error de configuraci처n:",t.message)})})();const O=async t=>{try{const e=await c.post("/get-pdf-resultados/"+w.proceso,{},{responseType:"blob"});if(e.status!==200)throw new Error("Error al obtener el archivo");const i=window.URL.createObjectURL(new Blob([e.data])),u=document.createElement("a");u.href=i;const l=new Date,$=`${`${l.getDate().toString().padStart(2,"0")}-${(l.getMonth()+1).toString().padStart(2,"0")}-${l.getFullYear()}_${l.getHours().toString().padStart(2,"0")}-${l.getMinutes().toString().padStart(2,"0")}-${l.getSeconds().toString().padStart(2,"0")}`}_resultados.pdf`;u.setAttribute("download",$),document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(i)}catch(e){console.error("Error al descargar el archivo:",e)}},z=async()=>{try{const t=await c.get("calificacion/descargar-excel",{params:{descargar:1},responseType:"blob"});if(t.status!==200)throw new Error("Error al obtener el archivo");const e=new Date,u=`${`${e.getDate().toString().padStart(2,"0")}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getFullYear()}_${e.getHours().toString().padStart(2,"0")}-${e.getMinutes().toString().padStart(2,"0")}-${e.getSeconds().toString().padStart(2,"0")}`}_lista_postulantes.xlsx`,l=window.URL.createObjectURL(new Blob([t.data])),d=document.createElement("a");d.href=l,d.setAttribute("download",u),document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(l)}catch(t){console.error("Error al descargar el archivo:",t)}};return(t,e)=>{const i=G,u=J,l=Y("Icono"),d=X,$=Z,T=K;return p(),v("div",null,[a("div",te,[a("div",oe,[a("div",ae,[s(i,{onClick:e[0]||(e[0]=n=>b.value=!0)},{default:r(()=>e[10]||(e[10]=[m("Calificar")])),_:1})]),a("div",ne,[y.value!=[]?(p(),v("div",se,[s(i,{style:{width:"140px",background:"crimson",border:"none",color:"white"},onClick:e[1]||(e[1]=n=>O())},{default:r(()=>e[11]||(e[11]=[m("Descargar")])),_:1})])):_("",!0),a("div",le,[s(i,{style:{width:"140px",background:"green",border:"none",color:"white"},onClick:e[2]||(e[2]=n=>z())},{default:r(()=>e[12]||(e[12]=[m("Descargar Excel")])),_:1})])])])]),s(u,{dataSource:y.value,columns:V.value,size:"small",pagination:!1},{bodyCell:r(({column:n,index:q,record:C})=>[n.dataIndex==="nro"?(p(),v("span",re,U(q+1),1)):_("",!0),n.dataIndex==="puntaje"?(p(),v(Q,{key:1},[C.puntaje!==null&&C.puntaje!==void 0?(p(),v("div",de,[a("span",null,U(A(C.puntaje)),1)])):_("",!0)],64)):_("",!0)]),_:1},8,["dataSource","columns"]),s(T,{title:"Modal de calificaci처n",open:b.value,"onUpdate:open":e[9]||(e[9]=n=>b.value=n),footer:!1},{default:r(()=>[a("div",ie,[a("div",null,[e[13]||(e[13]=a("label",null,"Correctas",-1)),s(d,{ref:"select",value:x.value,"onUpdate:value":e[3]||(e[3]=n=>x.value=n),style:{width:"100%"}},{suffix:r(()=>[s(l)]),_:1},8,["value"])]),a("div",null,[e[14]||(e[14]=a("label",null,"Incorrectas",-1)),s(d,{ref:"select",value:S.value,"onUpdate:value":e[4]||(e[4]=n=>S.value=n),style:{width:"100%"}},{suffix:r(()=>[s(l)]),_:1},8,["value"])]),a("div",null,[e[15]||(e[15]=a("label",null,"En Blanco",-1)),s(d,{ref:"select",value:k.value,"onUpdate:value":e[5]||(e[5]=n=>k.value=n),style:{width:"100%"}},{suffix:r(()=>[s(l)]),_:1},8,["value"])])]),a("div",ue,[e[16]||(e[16]=a("label",null,"Ponderacion",-1)),a("div",null,[s($,{value:g.value,"onUpdate:value":e[7]||(e[7]=n=>g.value=n),options:j.value,onSelect:D,style:{width:"100%"}},{default:r(()=>[s(d,{placeholder:"Ponderaci처n ...",value:f.value,"onUpdate:value":e[6]||(e[6]=n=>f.value=n)},{suffix:r(()=>[s(W(ee))]),_:1},8,["value"])]),_:1},8,["value","options"])])]),a("div",ce,[a("div",pe,[s(i,{style:{"margin-left":"6px","border-radius":"4px"}},{default:r(()=>e[17]||(e[17]=[m("Cancelar")])),_:1})]),a("div",null,[s(i,{type:"primary",onClick:e[8]||(e[8]=n=>N()),style:{background:"#476175",border:"none","border-radius":"4px"}},{default:r(()=>e[18]||(e[18]=[m("Calificar")])),_:1})])])]),_:1},8,["open"])])}}};export{be as default};
