import{f as l,o as s,c as i,a as d,u as g,w as h,F as v,l as y,Z as _,d as n,k as C,g as p,b}from"./app-c0a860c3.js";import{A}from"./LayoutDocente-70083e1f.js";import"./DropdownLink-fa373470.js";import"./logotiny-c4b525af.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./TopMenu-b03e03db.js";const P={class:"flex",style:{padding:"20px"}},w={ref:"captureContainer",style:{position:"relative"}},k={ref:"videoElement",autoplay:""},x={key:1,class:"flex justify-center",style:{"margin-top":"-50px"}},E={key:0,style:{"margin-bottom":"-40px"}},$=["src"],L={class:"flex justify-between mt-3",style:{padding:"0px 20px"}},T={key:0,style:{width:"300px"}},V={data(){return{dni:null,capturedPhoto:null,cropAreaTop:0,cropAreaLeft:120,cropAreaWidth:400,cropAreaHeight:480,cargado:!1}},watch:{dni(e,t){this.dni.length===8&&this.capturePhoto()}},mounted(){this.initializeCamera()},beforeUnmount(){this.stopCamera()},methods:{async initializeCamera(){try{const e={video:!0},t=await navigator.mediaDevices.getUserMedia(e);this.$refs.videoElement.srcObject=t,this.cargado=!0}catch(e){console.error("Error al acceder a la cámara: ",e)}},stopCamera(){const e=this.$refs.videoElement.srcObject;e&&e.getTracks().forEach(t=>t.stop())},capturePhoto(){const e=this.$refs.videoElement,t=document.createElement("canvas"),c=t.getContext("2d"),o=this.$refs.cropArea,a=o.offsetWidth,r=o.offsetHeight,u=o.offsetLeft-e.offsetLeft,m=o.offsetTop-e.offsetTop;t.width=a,t.height=r,c.drawImage(e,u,m,a,r,0,0,a,r);const f=t.toDataURL();this.capturedPhoto=f,this.saveCroppedPhotoBiometrico()},saveCroppedPhotoBiometrico(){this.capturedPhoto&&y.post("guardar-foto-biometrico",{dni:this.dni,photo:this.capturedPhoto}).then(e=>{console.log("Foto recortada guardada correctamente")}).catch(e=>{console.error("Error al guardar la foto recortada: ",e)})}}},z=Object.assign(V,{__name:"fotobiometrico",setup(e){return(t,c)=>{const o=l("a-button"),a=l("a-input");return s(),i(v,null,[d(g(_),{title:"Inscripciones-impresión"}),d(A,null,{default:h(()=>[n("div",P,[n("div",w,[n("video",k,null,512),t.cargado===!0?(s(),i("div",{key:0,ref:"cropArea",style:C(`position: absolute; top: ${t.cropAreaTop}px; left: ${t.cropAreaLeft}px; width: ${t.cropAreaWidth}px; height: ${t.cropAreaHeight}px; border: 1px dashed gray;`)},null,4)):p("",!0),t.cargado===!0?(s(),i("div",x,[d(o,{type:"primary",onClick:t.capturePhoto},{default:h(()=>[b("Capturar Foto")]),_:1},8,["onClick"])])):p("",!0)],512),t.capturedPhoto?(s(),i("div",E,[n("img",{src:t.capturedPhoto,alt:"Foto Capturada"},null,8,$)])):p("",!0)]),n("div",L,[t.cargado===!0?(s(),i("div",T,[d(a,{value:t.dni,"onUpdate:value":c[0]||(c[0]=r=>t.dni=r),placeholder:"Ingrese DNI"},null,8,["value"])])):p("",!0)])]),_:1})],64)}}});export{z as default};
