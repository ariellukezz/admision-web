import{_ as S}from"./_plugin-vue_export-helper-c27b6911.js";import{r as p,J as P,e as R,o as m,E as x,w as n,a4 as _,M as V,a,d as r,c as g,b as $,f as z,t as C,I as L,k as O,W as T,B as W,b0 as D,j as G,X as H,q as J}from"./app-3d5418a6.js";const q={class:"space-y-4"},X={class:"grid grid-cols-2 gap-4"},K={class:"grid grid-cols-2 gap-4"},Q={class:"grid grid-cols-12 gap-4"},Y={class:"col-span-4 flex flex-col items-center"},Z={key:0,class:"py-8"},ee=["src"],le={key:1,class:"text-xs text-gray-500 mt-1"},ae={class:"col-span-8 space-y-4"},oe={__name:"foto-preinscripcion",props:{visible:Boolean,formData:Object,loading:Boolean},emits:["save","cancel"],setup(v,{emit:h}){const j=v,b=h,f=p(),c=p(),d=p(""),i=p(null),l=P({id:null,dni:"",nombres:"",paterno:"",materno:"",celular:"",email:"",password:"",password_confirmation:"",foto:null,rol:null,estado:1,fec_inicio:null,fec_fin:null});R(()=>j.formData,t=>{t&&(Object.assign(l,t),t.foto&&typeof t.foto=="string"&&(d.value=t.foto.startsWith("data:")?t.foto:`${window.location.origin}/${t.foto}`,i.value=null))},{immediate:!0});const U=t=>{const e=t.target.files[0];if(!e)return;if(!e.type.startsWith("image/")){_.error("Solo se permiten im치genes");return}if(e.size/1024/1024>2){_.error("La imagen debe ser menor a 2MB");return}i.value=e;const u=new FileReader;u.onload=s=>d.value=s.target.result,u.readAsDataURL(e)},B=()=>{d.value="",i.value=null,c.value&&(c.value.value="")},E=async()=>{try{const t=await f.value.validateFields(),e={...l,...t};i.value?e.foto=i.value:e.foto=null,console.log("游댌 Enviando foto:",e.foto),b("save",e)}catch{_.error("Corrige los errores del formulario")}},F=()=>{var t;(t=f.value)==null||t.resetFields(),d.value="",i.value=null,c.value&&(c.value.value=""),Object.assign(l,{id:null,dni:"",nombres:"",paterno:"",materno:"",celular:"",email:"",password:"",password_confirmation:"",foto:null,rol:null,estado:1,fec_inicio:null,fec_fin:null}),b("cancel")};return(t,e)=>{const u=L,s=O,y=T,I=W,w=D,k=G,M=H,N=J,A=V;return m(),x(A,{open:v.visible,title:l.id?"Editar usuario":"Nuevo usuario","confirm-loading":v.loading,"ok-text":"Guardar","cancel-text":"Cancelar",onOk:E,onCancel:F,width:"720px",centered:""},{default:n(()=>[a(N,{ref_key:"formRef",ref:f,model:l,layout:"vertical",size:"middle"},{default:n(()=>[a(M,{"default-active-key":"1"},{default:n(()=>[a(y,{key:"1",tab:"Datos Personales"},{default:n(()=>[r("div",q,[a(s,{label:"DNI",name:"dni"},{default:n(()=>[a(u,{value:l.dni,"onUpdate:value":e[0]||(e[0]=o=>l.dni=o),placeholder:"Ej: 12345678",size:"large","allow-clear":"",maxlength:8},null,8,["value"])]),_:1}),a(s,{label:"Nombres",name:"nombres"},{default:n(()=>[a(u,{value:l.nombres,"onUpdate:value":e[1]||(e[1]=o=>l.nombres=o),placeholder:"Ej: Juan Carlos",size:"large","allow-clear":""},null,8,["value"])]),_:1}),r("div",X,[a(s,{label:"Apellido Paterno",name:"paterno"},{default:n(()=>[a(u,{value:l.paterno,"onUpdate:value":e[2]||(e[2]=o=>l.paterno=o),placeholder:"Ej: P칠rez",size:"large","allow-clear":""},null,8,["value"])]),_:1}),a(s,{label:"Apellido Materno",name:"materno"},{default:n(()=>[a(u,{value:l.materno,"onUpdate:value":e[3]||(e[3]=o=>l.materno=o),placeholder:"Ej: G칩mez",size:"large","allow-clear":""},null,8,["value"])]),_:1})]),r("div",K,[a(s,{label:"Celular",name:"celular"},{default:n(()=>[a(u,{value:l.celular,"onUpdate:value":e[4]||(e[4]=o=>l.celular=o),placeholder:"Ej: 999888777",size:"large","allow-clear":""},null,8,["value"])]),_:1}),a(s,{label:"Correo",name:"email"},{default:n(()=>[a(u,{value:l.email,"onUpdate:value":e[5]||(e[5]=o=>l.email=o),placeholder:"ejemplo@correo.com",size:"large","allow-clear":""},null,8,["value"])]),_:1})])])]),_:1}),a(y,{key:"2",tab:"Datos de Usuario"},{default:n(()=>[r("div",Q,[r("div",Y,[r("div",{class:"border-2 border-dashed border-gray-300 rounded-lg p-4 text-center cursor-pointer hover:border-blue-400 transition-colors w-full",onClick:e[6]||(e[6]=o=>t.$refs.fileInput.click())},[d.value?(m(),g("img",{key:1,src:d.value,class:"rounded-lg w-full max-h-48 object-cover"},null,8,ee)):(m(),g("div",Z,e[11]||(e[11]=[r("svg",{class:"w-12 h-12 mx-auto text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[r("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 16l4.586-4.586a2 2 0 012.828 0L16 16m-2-2l1.586-1.586a2 2 0 012.828 0L20 14m-6-6h.01M6 20h12a2 2 0 002-2V6a2 2 0 00-2-2H6a2 2 0 00-2 2v12a2 2 0 002 2z"})],-1),r("span",{class:"text-gray-500 text-sm mt-2 block"},"Haz clic para subir foto",-1)])))]),r("input",{ref_key:"fileInput",ref:c,type:"file",accept:"image/*",onChange:U,class:"hidden"},null,544),d.value?(m(),x(I,{key:0,type:"link",size:"small",onClick:B,danger:"",class:"mt-2"},{default:n(()=>e[12]||(e[12]=[$(" Eliminar foto ")])),_:1})):z("",!0),i.value?(m(),g("div",le," Archivo: "+C(i.value.name)+" ("+C((i.value.size/1024/1024).toFixed(2))+" MB) ",1)):z("",!0)]),r("div",ae,[a(s,{label:"Contrase침a",name:"password"},{default:n(()=>[a(w,{value:l.password,"onUpdate:value":e[7]||(e[7]=o=>l.password=o),placeholder:"Ingresa contrase침a",size:"large"},null,8,["value"])]),_:1}),a(s,{label:"Confirmar",name:"password_confirmation"},{default:n(()=>[a(w,{value:l.password_confirmation,"onUpdate:value":e[8]||(e[8]=o=>l.password_confirmation=o),placeholder:"Confirma contrase침a",size:"large"},null,8,["value"])]),_:1}),a(s,{label:"Rol",name:"rol"},{default:n(()=>[a(k,{value:l.rol,"onUpdate:value":e[9]||(e[9]=o=>l.rol=o),placeholder:"Selecciona rol",size:"large",options:[{value:1,label:"游녬 Administrador"},{value:2,label:"游늵 Calificador"},{value:3,label:"游닉 Publicador"}]},null,8,["value"])]),_:1}),a(s,{label:"Estado",name:"estado"},{default:n(()=>[a(k,{value:l.estado,"onUpdate:value":e[10]||(e[10]=o=>l.estado=o),placeholder:"Selecciona estado",size:"large",options:[{value:1,label:"游릭 Activo"},{value:0,label:"游댮 Inactivo"}]},null,8,["value"])]),_:1})])])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title","confirm-loading"])}}},se=S(oe,[["__scopeId","data-v-0b71dc82"]]);export{se as default};
