import{a as t,A as ae,r as i,e as oe,x as te,f as v,o as h,c as C,u as _,w as l,d as g,F as V,Z as se,b as k,S as le,t as w,g as O,s as re,D as ne,v as ie,n as ue}from"./app-70db2185.js";import{A as de}from"./AuthenticatedLayout-de696c29.js";import{F as ce}from"./FormOutlined-9466d830.js";import"./DropdownLink-27c0c2c2.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./logotiny-c4b525af.js";import"./TeamOutlined-45abf8b0.js";var pe={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M832 464h-68V240c0-70.7-57.3-128-128-128H388c-70.7 0-128 57.3-128 128v224h-68c-17.7 0-32 14.3-32 32v384c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V496c0-17.7-14.3-32-32-32zM332 240c0-30.9 25.1-56 56-56h248c30.9 0 56 25.1 56 56v224H332V240zm460 600H232V536h560v304zM484 701v53c0 4.4 3.6 8 8 8h40c4.4 0 8-3.6 8-8v-53a48.01 48.01 0 10-56 0z"}}]},name:"lock",theme:"outlined"};const me=pe;function j(u){for(var r=1;r<arguments.length;r++){var n=arguments[r]!=null?Object(arguments[r]):{},f=Object.keys(n);typeof Object.getOwnPropertySymbols=="function"&&(f=f.concat(Object.getOwnPropertySymbols(n).filter(function(d){return Object.getOwnPropertyDescriptor(n,d).enumerable}))),f.forEach(function(d){ve(u,d,n[d])})}return u}function ve(u,r,n){return r in u?Object.defineProperty(u,r,{value:n,enumerable:!0,configurable:!0,writable:!0}):u[r]=n,u}var F=function(r,n){var f=j({},r,n.attrs);return t(ae,j({},f,{icon:me}),null)};F.displayName="LockOutlined";F.inheritAttrs=!1;const fe=F,ge={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-5"},be={class:"flex justify-between mb-2"},_e={class:"mr-3"},ye={class:"flex justify-between",style:{position:"relative"}},he={class:"mr-2",style:{position:"absolute",left:"10px",top:"6px"}},ke={key:0,style:{"text-transform":"capitalize"},size:"small"},Ne={__name:"index",props:["usuarios"],setup(u){const r=i(""),n=i([]);i("");const f=i(""),d=i([]),I=i([]);let U;oe(r,(a,o)=>{clearTimeout(U),U=setTimeout(()=>{P()},500)});const b=i(!1),N=()=>{b.value=!0},L=a=>{console.log(a),b.value=!1},S={labelCol:{span:10},wrapperCol:{span:14}},z=a=>{e.id=a.id,e.name=a.name,e.paterno=a.paterno,e.materno=a.materno,e.email=a.email,e.rol=a.id_rol,e.id_proceso=a.id_proceso,e.proceso=a.proceso,f.value=a.id_rol,b.value=!0},x=i(),e=te({id:null,name:"",paterno:"",materno:"",email:"",pass:"",checkPass:"",rol:i(null),id_proceso:null,proceso:9}),A={pass:[{required:!0,validator:async(a,o)=>o===""?Promise.reject("Ingrese la contraseña"):(e.checkPass!==""&&x.value.validateFields("checkPass"),Promise.resolve()),trigger:"change"}],checkPass:[{required:!0,validator:async(a,o)=>o===""?Promise.reject("Ingrese la contraseña nuevamente"):o!==e.pass?Promise.reject("Las contraseñas no coenciden"):Promise.resolve(),trigger:"change"}],name:[{required:!0,validator:async(a,o)=>o===""?Promise.reject("Ingrese su nombre"):Promise.resolve(),trigger:"change"}],email:[{validator:async(a,o)=>o===""?Promise.reject("Ingrese su correo electrónico"):Promise.resolve(),trigger:"change"}]},R=[{title:"Nombre",dataIndex:"name",width:"30%"},{title:"Correo",dataIndex:"email"},{title:"Rol",dataIndex:"role_name"},{title:"Proceso",dataIndex:"proceso"},{title:"operation",dataIndex:"operation"}],$={pageSize:20},q=a=>{console.log(a,e)},B=a=>{console.log(a)},M=()=>{x.value.resetFields()},D=(...a)=>{console.log(a)},H={required:"Ingrese ${label}",types:{email:"${label} no valido"}},P=async()=>{let a=await axios.post("get-usuarios",{term:r.value});d.value=a.data.usuarios},T=async()=>{let a=await axios.get("get-roles-u");n.value=a.data.datos},E=async()=>{let a=await axios.get("get-select-procesos");I.value=a.data.datos};T(),P(),E();const G=()=>{let a={id:e.id,name:e.name,paterno:e.paterno,materno:e.materno,email:e.email,rol:2,id_proceso:e.id_proceso};e.pass&&e.pass.trim()!==""&&(a.password=e.pass),axios.post("save-user",a).then(o=>{console.log(o.data.user),b.value=!1,e.id=null,e.name="",e.paterno="",e.materno="",e.email="",e.pass="",e.checkPass="",e.rol=i(null),e.id_proceso=null,e.proceso=9,P(),Z("success","Nuevo Usuario Agregado",o.data.user.name)})},Z=(a,o,c)=>{ue[a]({message:o,description:c})};return(a,o)=>{const c=v("a-button"),p=v("a-input"),J=v("a-tag"),Q=v("a-table"),m=v("a-form-item"),W=v("a-select"),X=v("a-form"),Y=v("a-modal");return h(),C(V,null,[t(_(se),{title:"Usuarios"}),t(de,null,{default:l(()=>[g("div",ge,[g("div",be,[g("div",_e,[t(c,{class:"mb-3",style:{"border-radius":"5px",border:"none",background:"#476175"},type:"primary",onClick:N},{default:l(()=>[k("Usuario nuevo")]),_:1})]),g("div",ye,[t(p,{type:"text",placeholder:"Buscar",value:r.value,"onUpdate:value":o[0]||(o[0]=s=>r.value=s),style:{height:"36px","max-width":"300px","border-radius":"6px","padding-left":"30px"}},null,8,["value"]),g("div",he,[t(_(le))])])]),t(Q,{bordered:"","data-source":d.value,columns:R,size:"small",pagination:$},{bodyCell:l(({column:s,index:K,record:y})=>[s.dataIndex==="name"?(h(),C("span",ke,w(y.name.toLowerCase())+" "+w(y.paterno.toLowerCase()),1)):O("",!0),s.dataIndex==="role_name"?(h(),re(J,{key:1,color:"cyan",size:"small"},{default:l(()=>[k(w(d.value[K].role_name),1)]),_:2},1024)):O("",!0),s.dataIndex==="operation"?(h(),C(V,{key:2},[t(c,{class:"mr-1",type:"primary",onClick:ee=>z(y),style:{"border-radius":"4px",background:"none",border:"1px solid gray",color:"gray"},size:"small"},{icon:l(()=>[t(_(fe))]),_:2},1032,["onClick"]),t(c,{class:"mr-1",type:"primary",onClick:ee=>z(y),style:{"border-radius":"4px",background:"none",color:"blue"},size:"small"},{icon:l(()=>[t(_(ce))]),_:2},1032,["onClick"]),t(c,{type:"danger",style:{"border-radius":"4px",background:"none",color:"red"},size:"small"},{icon:l(()=>[t(_(ne))]),_:1})],64)):O("",!0)]),_:1},8,["data-source"])])]),_:1}),g("div",null,[t(Y,{visible:b.value,"onUpdate:visible":o[9]||(o[9]=s=>b.value=s),title:"Nuevo Usuario",style:{"margin-top":"-50px"},onOk:L},{footer:l(()=>[t(c,{style:{"border-radius":"5px"},onClick:M},{default:l(()=>[k("Cancelar")]),_:1}),t(c,{type:"primary",onClick:o[8]||(o[8]=s=>G()),style:{"border-radius":"5px",border:"none",background:"#476175"}},{default:l(()=>[k("Guardar")]),_:1})]),default:l(()=>[g("div",null,[t(X,ie({ref_key:"formRef",ref:x,name:"custom-validation",model:e,rules:A},S,{onFinish:q,onValidate:D,"validate-messages":H,onFinishFailed:B}),{default:l(()=>[t(m,{"has-feedback":"",label:"Nombre",name:"name"},{default:l(()=>[t(p,{value:e.name,"onUpdate:value":o[1]||(o[1]=s=>e.name=s),type:"text",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Ap. Paterno",name:"paterno"},{default:l(()=>[t(p,{value:e.paterno,"onUpdate:value":o[2]||(o[2]=s=>e.paterno=s),type:"text",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Ap.  Materno",name:"materno"},{default:l(()=>[t(p,{value:e.materno,"onUpdate:value":o[3]||(o[3]=s=>e.materno=s),type:"text",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Correo",name:"email",rules:[{type:"email",required:!0}]},{default:l(()=>[t(p,{value:e.email,"onUpdate:value":o[4]||(o[4]=s=>e.email=s),type:"text",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Contraseña",name:"pass"},{default:l(()=>[t(p,{value:e.pass,"onUpdate:value":o[5]||(o[5]=s=>e.pass=s),type:"password",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Confirmar Contraseña",name:"checkPass"},{default:l(()=>[t(p,{value:e.checkPass,"onUpdate:value":o[6]||(o[6]=s=>e.checkPass=s),type:"password",autocomplete:"off"},null,8,["value"])]),_:1}),t(m,{"has-feedback":"",label:"Rol"},{default:l(()=>[t(p,{value:"Revisor",disabled:""})]),_:1}),t(m,{name:"proceso",label:"Proceso",rules:[{required:!0,message:"Seleccine el rol",trigger:"change"}]},{default:l(()=>[t(W,{ref:"select",value:e.id_proceso,"onUpdate:value":o[7]||(o[7]=s=>e.id_proceso=s),style:{width:"100%"},options:I.value,onFocus:a.focus,onChange:a.handleChange},null,8,["value","options","onFocus","onChange"])]),_:1})]),_:1},16,["model"])])]),_:1},8,["visible"])])],64)}}};export{Ne as default};
