import{a,b1 as De,b2 as Ie,b3 as ye,b4 as he,b5 as Ee,r as v,H as A,a2 as Ae,aH as Ne,o as _,c as O,d as o,w as i,y as Ve,b6 as Pe,m as Se,b as f,t as u,u as p,x as L,f as P,E as X,F as Fe,s as Ce,b7 as Le,P as we,l as Re,B as ze,L as $e,g as je,aQ as Me,a8 as xe,a7 as ke,_ as Te,ao as He,ap as Ze,b8 as Be,b9 as Ue}from"./app-cb2b04a1.js";import{_ as qe}from"./_plugin-vue_export-helper-c27b6911.js";import{A as g}from"./AntdIcon-03e9de4c.js";import{F as Xe}from"./FileTextOutlined-59ea523d.js";import{S as G}from"./SafetyCertificateOutlined-b9de7e86.js";import{E as Q}from"./EditOutlined-349992f9.js";import{D as J}from"./DownloadOutlined-77e11029.js";var Ge={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM472 744a40 40 0 1080 0 40 40 0 10-80 0zm16-104h48c4.4 0 8-3.6 8-8V448c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v184c0 4.4 3.6 8 8 8z"}}]},name:"file-exclamation",theme:"outlined"};const Qe=Ge;var Je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm144 452H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm445.7 51.5l-93.3-93.3C814.7 780.7 828 743.9 828 704c0-97.2-78.8-176-176-176s-176 78.8-176 176 78.8 176 176 176c35.8 0 69-10.7 96.8-29l94.7 94.7c1.6 1.6 3.6 2.3 5.6 2.3s4.1-.8 5.6-2.3l31-31a7.9 7.9 0 000-11.2zM652 816c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"file-search",theme:"outlined"};const We=Je;function W(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){Ye(n,l,e[l])})}return n}function Ye(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var w=function(t,e){var s=W({},t,e.attrs);return a(g,W({},s,{icon:De}),null)};w.displayName="CalendarOutlined";w.inheritAttrs=!1;const Ke=w;function Y(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){et(n,l,e[l])})}return n}function et(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var R=function(t,e){var s=Y({},t,e.attrs);return a(g,Y({},s,{icon:Ie}),null)};R.displayName="ClockCircleOutlined";R.inheritAttrs=!1;const tt=R;function K(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){nt(n,l,e[l])})}return n}function nt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var z=function(t,e){var s=K({},t,e.attrs);return a(g,K({},s,{icon:Qe}),null)};z.displayName="FileExclamationOutlined";z.inheritAttrs=!1;const at=z;function ee(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){rt(n,l,e[l])})}return n}function rt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var $=function(t,e){var s=ee({},t,e.attrs);return a(g,ee({},s,{icon:We}),null)};$.displayName="FileSearchOutlined";$.inheritAttrs=!1;const ot=$;function te(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){st(n,l,e[l])})}return n}function st(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var j=function(t,e){var s=te({},t,e.attrs);return a(g,te({},s,{icon:ye}),null)};j.displayName="ReloadOutlined";j.inheritAttrs=!1;const it=j;function ne(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){lt(n,l,e[l])})}return n}function lt(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var M=function(t,e){var s=ne({},t,e.attrs);return a(g,ne({},s,{icon:he}),null)};M.displayName="ZoomInOutlined";M.inheritAttrs=!1;const ct=M;function ae(n){for(var t=1;t<arguments.length;t++){var e=arguments[t]!=null?Object(arguments[t]):{},s=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(s=s.concat(Object.getOwnPropertySymbols(e).filter(function(l){return Object.getOwnPropertyDescriptor(e,l).enumerable}))),s.forEach(function(l){ut(n,l,e[l])})}return n}function ut(n,t,e){return t in n?Object.defineProperty(n,t,{value:e,enumerable:!0,configurable:!0,writable:!0}):n[t]=e,n}var x=function(t,e){var s=ae({},t,e.attrs);return a(g,ae({},s,{icon:Ee}),null)};x.displayName="ZoomOutOutlined";x.inheritAttrs=!1;const dt=x;const ft={class:"pdf-verification-container"},pt={class:"verification-header"},_t={class:"card-content"},mt={class:"card-icon",style:{background:"#e6f4ff"}},vt={class:"card-stats"},Ot={class:"card-content"},gt={class:"card-stats"},bt={class:"card-content"},Dt={class:"card-icon",style:{background:"#f6ffed"}},It={class:"card-stats"},yt={class:"card-content"},ht={class:"card-icon",style:{background:"#fff7e6"}},Et={class:"card-stats"},At={class:"zoom-level"},Nt={class:"pdf-viewer-wrapper"},Vt=["src"],Pt={key:1,class:"pdf-error-state"},St={key:2,class:"pdf-empty-state"},Ft={class:"verification-status"},Ct={class:"status-header"},Lt={class:"signatures-list"},wt={class:"list-header"},Rt={key:0,class:"no-signatures"},zt={class:"signature-details"},$t={class:"signature-status"},jt={class:"signature-time"},Mt={class:"certificate-info"},xt={class:"serial-number"},kt={class:"validity-dates"},Tt={key:0,class:"signature-warnings"},Ht={class:"verification-actions"},Zt={__name:"verificar",props:{codigo:{type:String,required:!0,default:"EX25380044"}},setup(n){const t=n,e=v({codigo_inscripcion:"",estado:"",total_firmas:0,fecha_verificacion:"",firmas:[]}),s=v(null),l=v(""),b=v(1),D=v(!1),I=v(!1),N=v(""),k=A(()=>{var r;const c=(r=e.value.estado)==null?void 0:r.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"Documento Válido":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"Documento Inválido":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"Verificación Indeterminada":"No Verificado"}),V=A(()=>{var r;const c=(r=e.value.estado)==null?void 0:r.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"#52c41a":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"#ff4d4f":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"#fa8c16":"#1890ff"}),re=A(()=>`linear-gradient(135deg, ${V.value} 0%, ${V.value}80 100%)`),oe=A(()=>{var r;const c=(r=e.value.estado)==null?void 0:r.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"success":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"error":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"warning":"info"}),se=A(()=>{var r;const c=(r=e.value.estado)==null?void 0:r.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"Todas las firmas digitales son válidas y los certificados están vigentes.":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"Se detectaron firmas inválidas o certificados caducados.":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"Las firmas son técnicamente válidas pero requieren verificación adicional.":"El documento aún no ha sido verificado."}),ie=c=>{const r=c==null?void 0:c.toUpperCase();return["VÁLIDA","VALIDO","VALIDA"].includes(r)?"green":["INVÁLIDA","INVALIDO","INVALIDA"].includes(r)?"red":r!=null&&r.includes("INDETERMINADA")||r!=null&&r.includes("INDETERMINADO")?"orange":"blue"},le=async()=>{try{const c=await Ve.get(`/verificar/${t.codigo}`);c.data.success?e.value=c.data.data||c.data:e.value={codigo_inscripcion:t.codigo,estado:"ERROR",total_firmas:0,fecha_verificacion:new Date().toLocaleDateString("es-PE"),firmas:[]}}catch{e.value={codigo_inscripcion:t.codigo,estado:"ERROR_DE_CONEXION",total_firmas:0,fecha_verificacion:new Date().toLocaleDateString("es-PE"),firmas:[]}}},S=async()=>{D.value=!0,I.value=!1,N.value="";try{l.value=`http://admision.test/inscripcion/${t.codigo}/pdf`,s.value&&(s.value.src=l.value)}catch(c){I.value=!0,N.value=c.message||"Error desconocido",l.value=""}},ce=()=>{D.value=!1,I.value=!1},ue=()=>{D.value=!1,I.value=!0,N.value="No se pudo cargar el PDF"},de=()=>{b.value<2&&(b.value+=.1)},fe=()=>{b.value>.3&&(b.value-=.1)},T=()=>window.open(`http://admision.test/inscripcion/${t.codigo}/pdf`,"_blank");return Ae(async()=>{await Promise.all([le(),S()])}),Ne(()=>{s.value&&(s.value.src="")}),(c,r)=>{const F=Le,pe=Pe,y=we,h=Re,H=Se,E=ze,Z=$e,_e=je,me=Me,ve=xe,B=ke,C=Te,m=He,U=Ze,Oe=Be,ge=Ue;return _(),O("div",ft,[o("div",pt,[a(pe,null,{default:i(()=>[a(F,null,{default:i(()=>r[0]||(r[0]=[f("Inicio")])),_:1}),a(F,null,{default:i(()=>r[1]||(r[1]=[f("Verificación")])),_:1}),a(F,null,{default:i(()=>[f(u(e.value.codigo_inscripcion),1)]),_:1})]),_:1}),r[2]||(r[2]=o("div",{class:"header-title"},[o("h1",null,"Verificación de Documento Firmado"),o("p",{class:"subtitle"},"Análisis digital de firmas electrónicas")],-1))]),a(H,{gutter:16,class:"summary-cards"},{default:i(()=>[a(h,{span:6},{default:i(()=>[a(y,{class:"summary-card",bordered:!1},{default:i(()=>[o("div",_t,[o("div",mt,[a(p(Xe),{style:{color:"#1890ff","font-size":"24px"}})]),o("div",vt,[o("h3",null,u(e.value.codigo_inscripcion),1),r[3]||(r[3]=o("p",null,"Código de Inscripción",-1))])])]),_:1})]),_:1}),a(h,{span:6},{default:i(()=>[a(y,{class:"summary-card",bordered:!1},{default:i(()=>[o("div",Ot,[o("div",{class:"card-icon",style:L({background:re.value})},[a(p(G),{style:{color:"#fff","font-size":"24px"}})],4),o("div",gt,[o("h3",{style:L({color:V.value})},u(k.value),5),r[4]||(r[4]=o("p",null,"Estado de Verificación",-1))])])]),_:1})]),_:1}),a(h,{span:6},{default:i(()=>[a(y,{class:"summary-card",bordered:!1},{default:i(()=>[o("div",bt,[o("div",Dt,[a(p(Q),{style:{color:"#52c41a","font-size":"24px"}})]),o("div",It,[o("h3",null,u(e.value.total_firmas||0),1),r[5]||(r[5]=o("p",null,"Firmas Detectadas",-1))])])]),_:1})]),_:1}),a(h,{span:6},{default:i(()=>[a(y,{class:"summary-card",bordered:!1},{default:i(()=>[o("div",yt,[o("div",ht,[a(p(Ke),{style:{color:"#fa8c16","font-size":"24px"}})]),o("div",Et,[o("h3",null,u(e.value.fecha_verificacion||"--/--/----"),1),r[6]||(r[6]=o("p",null,"Fecha de Verificación",-1))])])]),_:1})]),_:1})]),_:1}),a(H,{gutter:24,class:"main-content"},{default:i(()=>[a(h,{span:14},{default:i(()=>[a(y,{class:"pdf-viewer-card",title:`Documento: ${e.value.codigo_inscripcion}.pdf`,bordered:!1},{extra:i(()=>[a(me,null,{default:i(()=>[a(Z,{title:"Disminuir zoom"},{default:i(()=>[a(E,{shape:"circle",onClick:fe,size:"small"},{default:i(()=>[a(p(dt))]),_:1})]),_:1}),o("span",At,u(Math.round(b.value*100))+"%",1),a(Z,{title:"Aumentar zoom"},{default:i(()=>[a(E,{shape:"circle",onClick:de,size:"small"},{default:i(()=>[a(p(ct))]),_:1})]),_:1}),a(_e,{type:"vertical"}),a(E,{type:"primary",onClick:T,class:"download-btn"},{default:i(()=>[a(p(J)),r[7]||(r[7]=f(" Descargar PDF "))]),_:1})]),_:1})]),default:i(()=>[o("div",Nt,[a(ve,{spinning:D.value,size:"large",tip:"Cargando documento..."},{default:i(()=>[l.value?(_(),O("iframe",{key:0,ref_key:"pdfFrame",ref:s,src:l.value,class:"pdf-iframe",style:L({transform:`scale(${b.value})`,transformOrigin:"top left"}),onLoad:ce,onError:ue},null,44,Vt)):P("",!0),I.value&&!D.value?(_(),O("div",Pt,[a(p(at),{style:{"font-size":"48px",color:"#ff4d4f"}}),r[9]||(r[9]=o("h3",null,"Error al cargar el PDF",-1)),o("p",null,u(N.value),1),a(E,{type:"primary",onClick:S},{default:i(()=>r[8]||(r[8]=[f(" Reintentar carga ")])),_:1})])):P("",!0),!l.value&&!D.value&&!I.value?(_(),O("div",St,[a(p(ot),{style:{"font-size":"48px",color:"#d9d9d9"}}),r[10]||(r[10]=o("h3",null,"Documento no disponible",-1)),r[11]||(r[11]=o("p",null,"No se pudo cargar el documento PDF",-1))])):P("",!0)]),_:1},8,["spinning"])])]),_:1},8,["title"])]),_:1}),a(h,{span:10},{default:i(()=>[a(y,{class:"signatures-card",title:"Análisis de Firmas Digitales",bordered:!1},{default:i(()=>{var q;return[o("div",Ft,[o("div",Ct,[a(p(G)),r[12]||(r[12]=o("h3",null,"Estado de Verificación",-1))]),a(B,{message:k.value,type:oe.value,description:se.value,"show-icon":"",class:"verification-alert"},null,8,["message","type","description"])]),o("div",Lt,[o("div",wt,[o("h3",null,"Firmas Detectadas ("+u(((q=e.value.firmas)==null?void 0:q.length)||0)+")",1),a(C,{color:V.value,class:"status-tag"},{default:i(()=>[f(u(e.value.total_firmas||0)+" encontradas ",1)]),_:1},8,["color"])]),!e.value.firmas||e.value.firmas.length===0?(_(),O("div",Rt,[a(p(Q),{style:{"font-size":"48px",color:"#d9d9d9"}}),r[13]||(r[13]=o("p",null,"No se detectaron firmas digitales",-1))])):(_(),X(ge,{key:1,accordion:"",bordered:!1,class:"signatures-collapse"},{default:i(()=>[(_(!0),O(Fe,null,Ce(e.value.firmas,(d,be)=>(_(),X(Oe,{key:d.indice,header:`Firma #${be+1}: ${d.firmante||"Desconocido"}`,class:"signature-panel"},{default:i(()=>[o("div",zt,[o("div",$t,[a(C,{color:ie(d.estado_servicio),class:"status-badge"},{default:i(()=>[f(u(d.estado_servicio),1)]),_:2},1032,["color"]),o("span",jt,[a(p(tt)),f(" "+u(d.fecha_firma),1)])]),a(U,{column:1,size:"small",class:"signer-info"},{default:i(()=>[a(m,{label:"Algoritmo"},{default:i(()=>[a(C,{color:"blue"},{default:i(()=>[f(u(d.algoritmo),1)]),_:2},1024)]),_:2},1024),a(m,{label:"Email"},{default:i(()=>[f(u(d.email||"No especificado"),1)]),_:2},1024),a(m,{label:"Campo de firma"},{default:i(()=>[o("code",null,u(d.campo_firma),1)]),_:2},1024)]),_:2},1024),o("div",Mt,[r[14]||(r[14]=o("h4",null,"Certificado Digital",-1)),a(U,{column:1,size:"small",bordered:""},{default:i(()=>[a(m,{label:"Emisor"},{default:i(()=>[f(u(d.certificado.emisor),1)]),_:2},1024),a(m,{label:"Sujeto"},{default:i(()=>[f(u(d.certificado.sujeto),1)]),_:2},1024),a(m,{label:"Número de Serie"},{default:i(()=>[o("code",xt,u(d.certificado.numero_serie),1)]),_:2},1024),a(m,{label:"Validez"},{default:i(()=>[o("div",kt,[o("span",null,"Desde: "+u(d.certificado.valido_desde),1),o("span",null,"Hasta: "+u(d.certificado.valido_hasta),1)])]),_:2},1024)]),_:2},1024)]),d.advertencias&&d.advertencias.length>0?(_(),O("div",Tt,[a(B,{type:"warning",message:`Advertencia${d.advertencias.length>1?"s":""}`,description:d.advertencias.join(" | "),"show-icon":""},null,8,["message","description"])])):P("",!0)])]),_:2},1032,["header"]))),128))]),_:1}))]),o("div",Ht,[a(E,{type:"primary",block:"",size:"large",onClick:T,class:"action-btn"},{default:i(()=>[a(p(J)),r[15]||(r[15]=f(" Descargar Certificado de Verificación "))]),_:1}),a(E,{block:"",size:"large",onClick:S,class:"action-btn"},{default:i(()=>[a(p(it)),r[16]||(r[16]=f(" Reanalizar Documento "))]),_:1})])]}),_:1})]),_:1})]),_:1})])}}},Wt=qe(Zt,[["__scopeId","data-v-95037173"]]);export{Wt as default};
