import{r as i,e as R,i as H,f as d,o as r,c as _,a as t,u as b,w as l,d as y,F as J,j as g,Z as Q,b as c,S as W,k as N,g as v,D as ee,m as ae,n as oe}from"./app-9738b48d.js";import{A as te}from"./AuthenticatedLayout-fffbd918.js";import{F as le}from"./FormOutlined-07b65c6c.js";import"./DropdownLink-f3daacc8.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./logotiny-c4b525af.js";import"./TeamOutlined-eb01c724.js";const se={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},ne={class:"mr-3"},de={class:"flex justify-between",style:{position:"relative"}},ie={class:"mr-2",style:{position:"absolute",left:"8px",top:"3px"}},ue={key:0,class:"flex",style:{"justify-content":"center"}},re={key:1,class:"flex",style:{"justify-content":"center"}},ce={key:0},ve={key:1},pe={key:2,class:"flex",style:{"justify-content":"space-between"}},Fe={__name:"procesos",setup(me){const w=i(""),C=i([]),F=i([]),u=i([]),p=i(!1),E=i([]),e=i({id:null,nombre:"",sede:null,tipo:null,modalidad:null,anio:new Date().getFullYear(),estado:!0,f_inicio:"",f_fin:""}),V=()=>{p.value=!0};R(w,(o,a)=>{k()}),R(p,(o,a)=>{p.value==!1&&e.value.id!=null&&(e.value.id=null,e.value.nombre=null,e.value.sede=C.value[0].value,e.value.tipo=F.value[0].value,e.value.modalidad=E.value[0].value,e.value.anio=new Date().getFullYear(),e.value.estado=!0)});const S={labelCol:{span:4},wrapperCol:{span:14}},O={nombre:[{required:!0,validator:async(o,a)=>a===""?Promise.reject("Ingrese su el nombre del proceso"):Promise.resolve(),trigger:"change"}],sede:[{required:!0,validator:async(o,a)=>a===""?Promise.reject("Ingrese la sede del proceso"):Promise.resolve(),trigger:"change"}]};i([]),i([]);const T=o=>{p.value=!0,e.value.id=o.id,e.value.nombre=o.nombre,e.value.sede=o.id_sede,e.value.tipo=o.id_tipo,e.value.modalidad=o.id_modalidad,e.value.anio=o.anio,o.estado==1?e.value.estado=!0:e.value.estado=!1},k=async(o="",a=1)=>{let n=await g.post("/admin/procesos/get-procesos?page="+a,{term:w.value});u.value=n.data.datos.data},j=async(o="",a=1)=>{let n=await g.post("procesos/get-sedes?page="+a);C.value=n.data.datos.data,e.value.sede=n.data.datos.data[0].value},U=async(o="",a=1)=>{let n=await g.get("procesos/get-tipos?page="+a);F.value=n.data.datos,e.value.tipo=n.data.datos[0].value},D=async(o="",a=1)=>{let n=await g.get("procesos/get-modalidades?page="+a);E.value=n.data.datos,e.value.modalidad=n.data.datos[0].value},B=()=>{let o={id:e.value.id,nombre:e.value.nombre,sede:e.value.sede,tipo:e.value.tipo,anio:e.value.anio,modalidad:e.value.modalidad,estado:e.value.estado,f_inicio:e.value.f_inicio,f_fin:e.value.f_fin};g.post("save-proceso",o).then(a=>{A("success",a.data.titulo,a.data.mensaje),k(),p.value=!1})},G=o=>{g.get("eliminar-proceso/"+o.id).then(a=>{k(),A("warning","PROCESO ELIMINADO",a.data.mensaje)})},M=[{title:"Nombre",dataIndex:"nombre"},{title:"Sede",dataIndex:"sede",align:"center"},{title:"Tipo",dataIndex:"tipo",align:"center",width:"120px"},{title:"Modalidad",dataIndex:"modalidad",align:"center",width:"120px"},{title:"Año",dataIndex:"anio",width:"40px"},{title:"Estado",dataIndex:"estado",align:"center",width:"60px"},{title:"Acciones",dataIndex:"acciones",width:"50px"}],x=i([]),z=o=>{console.log("selectedRowKeys changed: ",o),x.value=o};H(()=>({selectedRowKeys:b(x),onChange:z,hideDefaultSelections:!0}));const A=(o,a,n)=>{oe[o]({message:a,description:n})};return k(),j(),U(),D(),(o,a)=>{const n=d("a-button"),P=d("a-input"),L=d("row"),h=d("a-tag"),$=d("a-table"),f=d("a-form-item"),I=d("a-select"),q=d("a-input-number"),K=d("a-switch"),X=d("a-form"),Y=d("a-modal");return r(),_(J,null,[t(b(Q),{title:"Procesos"}),t(te,null,{default:l(()=>[y("div",se,[t(L,{class:"flex justify-between mb-4"},{default:l(()=>[y("div",ne,[t(n,{type:"primary",onClick:V},{default:l(()=>[c("Nuevo")]),_:1})]),y("div",de,[t(P,{type:"text",placeholder:"Buscar",value:w.value,"onUpdate:value":a[0]||(a[0]=s=>w.value=s),style:{"max-width":"300px","padding-left":"30px"}},null,8,["value"]),y("div",ie,[t(b(W))])])]),_:1}),t($,{columns:M,"data-source":u.value,pagination:{pageSize:10},size:"small"},{bodyCell:l(({column:s,index:m})=>[s.dataIndex==="modalidad"?(r(),_("div",ue,[u.value[m].modalidad==="CEPREUNA"?(r(),N(h,{key:0,color:"cyan"},{default:l(()=>[c("CEPREUNA")]),_:1})):v("",!0),u.value[m].modalidad==="GENERAL"?(r(),N(h,{key:1,color:"orange"},{default:l(()=>[c("GENERAL")]),_:1})):v("",!0),u.value[m].modalidad==="EXTRAORDINARIO"?(r(),N(h,{key:2,color:"pink"},{default:l(()=>[c(" EXTRAORDINARIO")]),_:1})):v("",!0)])):v("",!0),s.dataIndex==="estado"?(r(),_("div",re,[u.value[m].estado==1?(r(),_("div",ce,[t(h,{color:"green"},{default:l(()=>[c("VIGENTE")]),_:1})])):v("",!0),u.value[m].estado==0?(r(),_("div",ve,[t(h,{color:"red"},{default:l(()=>[c("NO VIGENTE")]),_:1})])):v("",!0)])):v("",!0),s.dataIndex==="acciones"?(r(),_("div",pe,[t(n,{type:"primary",onClick:Z=>T(u.value[m]),size:"small"},{icon:l(()=>[t(b(le))]),_:2},1032,["onClick"]),t(n,{type:"danger",onClick:Z=>G(u.value[m]),shape:"",size:"small"},{icon:l(()=>[t(b(ee))]),_:2},1032,["onClick"])])):v("",!0)]),_:1},8,["data-source"])])]),_:1}),y("div",null,[t(Y,{visible:p.value,"onUpdate:visible":a[8]||(a[8]=s=>p.value=s),title:"Nuevo Proceso",style:{"margin-top":"-40px"}},{footer:l(()=>[t(n,{style:{"margin-left":"10px"},onClick:o.resetForm},{default:l(()=>[c("Cancelar")]),_:1},8,["onClick"]),t(n,{type:"primary",onClick:a[7]||(a[7]=s=>B())},{default:l(()=>[c("Guardar")]),_:1})]),default:l(()=>[t(X,ae({ref:"formRef",name:"custom-validation",model:o.formState,rules:O},S,{onFinish:o.handleFinish,onValidate:o.handleValidate,onFinishFailed:o.handleFinishFailed}),{default:l(()=>[t(f,{"has-feedback":"",label:"Nombre",name:"nombre"},{default:l(()=>[t(P,{type:"text",style:{width:"100%"},value:e.value.nombre,"onUpdate:value":a[1]||(a[1]=s=>e.value.nombre=s),autocomplete:"off"},null,8,["value"])]),_:1}),t(f,{"has-feedback":"",label:"Sede",name:"sede"},{default:l(()=>[t(I,{ref:"Tipo",style:{width:"100%"},onFocus:o.focus,onChange:o.handleChange,options:C.value,value:e.value.sede,"onUpdate:value":a[2]||(a[2]=s=>e.value.sede=s)},null,8,["onFocus","onChange","options","value"])]),_:1}),t(f,{"has-feedback":"",label:"Tipo",name:"tipo"},{default:l(()=>[t(I,{ref:"Tipo",style:{width:"100%"},options:F.value,onFocus:o.focus,onChange:o.handleChange,value:e.value.tipo,"onUpdate:value":a[3]||(a[3]=s=>e.value.tipo=s)},null,8,["options","onFocus","onChange","value"])]),_:1}),t(f,{"has-feedback":"",label:"Modalidad",name:"modalidad"},{default:l(()=>[t(I,{ref:"Tipo",style:{width:"100%"},options:E.value,onFocus:o.focus,onChange:o.handleChange,value:e.value.modalidad,"onUpdate:value":a[4]||(a[4]=s=>e.value.modalidad=s)},null,8,["options","onFocus","onChange","value"])]),_:1}),t(f,{"has-feedback":"",label:"Año",name:"anio"},{default:l(()=>[t(q,{style:{width:"100%"},value:e.value.anio,"onUpdate:value":a[5]||(a[5]=s=>e.value.anio=s)},null,8,["value"])]),_:1}),t(f,{"has-feedback":"",label:"Estado",name:"estado"},{default:l(()=>[t(K,{checked:e.value.estado,"onUpdate:checked":a[6]||(a[6]=s=>e.value.estado=s)},null,8,["checked"])]),_:1})]),_:1},16,["model","onFinish","onValidate","onFinishFailed"])]),_:1},8,["visible"])])],64)}}};export{Fe as default};
