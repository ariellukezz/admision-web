import{r as p,a1 as O,y as w,C as b,o as l,c as d,a as n,u as R,w as o,F as m,Z as B,d as h,b as i,t as u,s as L,E as $,B as j,a7 as H,a8 as U,a9 as A,h as F}from"./app-d9fed0c8.js";import{_ as M}from"./AuthenticatedLayout-6d7c0882.js";import"./logotiny-c4b525af.js";import"./Header-f9f06d13.js";import"./AntdIcon-72899925.js";import"./DownOutlined-37d7bb17.js";/* empty css                                                            */const V={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4 pb-0",style:{height:"calc(100vh - 103px)"}},z={class:"flex justify-end mb-3 mr-3"},G={style:{"font-size":"0.7rem"}},K={key:3,style:{"text-align":"center"}},ee={__name:"programaDiario",setup(P){const g=p([]),_=p([]),f=p([{total_inscripciones:0}]),v=p(!1),x=p(null);O(async()=>{try{v.value=!0;const e=await w.post("reporte-programa-diario");g.value=e.data.datos||[],_.value=e.data.fechas||[],f.value=e.data.totales||[{total_inscripciones:0}]}catch(e){x.value=e,console.error("Error al cargar datos:",e)}finally{v.value=!1}});const k=b(()=>{const e={};return _.value.forEach(t=>{const a=t.substring(0,7);e[a]||(e[a]={monthName:new Date(t).toLocaleString("es-ES",{month:"long"}).toUpperCase(),dates:[]}),e[a].dates.push(t)}),e}),S=b(()=>{const e=[{title:"COD",dataIndex:"codigo",key:"codigo",width:20,align:"center",fixed:"left",customHeaderCell:()=>({style:{background:"#c9c9c9"}})},{title:"PROGRAMA DE ESTUDIOS",dataIndex:"programa",key:"programa",width:300,fixed:"left",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}];return Object.values(k.value).forEach(t=>{e.push({title:t.monthName,key:t.monthName,align:"center",children:t.dates.map(a=>({title:a.split("-")[2],dataIndex:`ins_${a}`,key:`ins_${a}`,width:30,customHeaderCell:()=>({style:{background:"#e3e3e3",textAlign:"center",height:"40px",width:"40px",padding:"0 0px"}})})),customHeaderCell:()=>({style:{background:"#e3e3e3"}})})}),e.push({title:"TOTAL",dataIndex:"inscripciones",key:"inscripciones",width:40,align:"center",fixed:"right",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}),e}),C=b(()=>!g.value||g.value.length===0?[{key:"no-data",codigo:"",programa:x.value?"Error al cargar datos":"No se encontraron datos",...Object.fromEntries((_.value||[]).map(e=>[`ins_${e}`,""])),inscripciones:""}]:g.value.map((e,t)=>({key:t,...e}))),D=b(()=>{var e;return((e=f.value[0])==null?void 0:e.total_inscripciones)||0}),E=e=>{var t;return((t=f.value[0])==null?void 0:t[`ins_${e}`])||0},I=async()=>{try{const e=await w.post("reporte-programa-diario",{descargar:1},{responseType:"blob"}),t=new Date,a=[t.getFullYear(),String(t.getMonth()+1).padStart(2,"0"),String(t.getDate()).padStart(2,"0"),String(t.getHours()).padStart(2,"0"),String(t.getMinutes()).padStart(2,"0"),String(t.getSeconds()).padStart(2,"0")].join("-"),c=window.URL.createObjectURL(new Blob([e.data])),s=document.createElement("a");s.href=c,s.setAttribute("download",`${a}_resumen_inscripciones.pdf`),document.body.appendChild(s),s.click(),s.remove(),window.URL.revokeObjectURL(c)}catch(e){console.error("Error al descargar:",e),notification.error({message:"Error",description:"No se pudo descargar el archivo"})}};return(e,t)=>{const a=j,c=H,s=U,T=A,N=F;return l(),d(m,null,[n(R(B),{title:"Resumen programa diario"}),n(M,null,{default:o(()=>[h("div",V,[h("div",z,[n(a,{type:"primary",style:{"border-radius":"5px",background:"#476175",border:"none"},onClick:t[0]||(t[0]=r=>I())},{default:o(()=>t[1]||(t[1]=[i(" Descargar ")])),_:1})]),h("div",G,[n(N,{columns:S.value,"data-source":C.value,bordered:"",size:"small",pagination:!1,scroll:{x:200,y:"calc(100vh - 280px)"}},{bodyCell:o(({column:r,record:y})=>[r.dataIndex==="programa"?(l(),d(m,{key:0},[i(u(y.programa),1)],64)):r.dataIndex==="codigo"?(l(),d(m,{key:1},[i(u(y.codigo),1)],64)):r.dataIndex==="inscripciones"?(l(),d(m,{key:2},[i(u(y.inscripciones),1)],64)):(l(),d("div",K,u(y[r.dataIndex]),1))]),summary:o(()=>[n(T,{fixed:"bottom"},{default:o(()=>[n(s,null,{default:o(()=>[n(c,{"col-span":2,style:{"text-align":"right","font-weight":"bold"}},{default:o(()=>t[2]||(t[2]=[i(" Totales: ")])),_:1}),(l(!0),d(m,null,L(_.value,r=>(l(),$(c,{key:r,style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(u(E(r)),1)]),_:2},1024))),128)),n(c,{style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(u(D.value),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data-source"])])])]),_:1})],64)}}};export{ee as default};
