import{a as t,b4 as Ue,r as i,J as te,C as Ve,e as ae,a1 as Te,o as m,c as b,u,w as a,F as oe,y as U,Z as Fe,d as c,s as Ye,E as L,t as O,v as ne,b as f,f as y,x as Ae,a2 as q,b5 as Be,b6 as Le,b7 as qe,B as je,b8 as Re,K as He,H as Ke,aH as Xe,h as Ge,W as Je,X as We,O as Ze,A as Qe,z as et,I as tt,k as at,L as ot,V as nt,T as st,U as lt,q as rt,M as it}from"./app-fcd2d49f.js";import{L as ut}from"./LayoutCalificador-0af69cea.js";import ct from"./leer-ide-8d961c94.js";import dt from"./leer-resp-defcfa74.js";import mt from"./leer-patron-069485b7.js";import pt from"./participantes-98eb95fd.js";import _t from"./calificacion-9d2bd62d.js";import ft from"./excepciones-2c8f7a24.js";import{_ as vt}from"./_plugin-vue_export-helper-c27b6911.js";import{A as gt}from"./AntdIcon-09072272.js";import{H as bt,F as j}from"./HomeOutlined-b57b5adc.js";import{S as yt}from"./SearchOutlined-119e2f97.js";import{P as se}from"./PlusOutlined-37d64569.js";import{E as xt}from"./EyeOutlined-da620d52.js";import{F as kt}from"./FormOutlined-0b6ed85e.js";import{D as Ct}from"./DeleteOutlined-f9692675.js";import{U as ht}from"./UploadOutlined-09f1a3b1.js";import{C as wt}from"./CopyOutlined-ebe66df0.js";import{E as St}from"./EnvironmentOutlined-34bc0517.js";import"./DropdownLink-3973a240.js";import"./logotiny-c4b525af.js";/* empty css                                                                          */import"./TopMenu-53bd49de.js";import"./DownOutlined-a79f1154.js";import"./DownloadOutlined-aba9f1b4.js";import"./SaveOutlined-a035524c.js";import"./ficha-3d6a064a.js";import"./logoDAD-c76d0a0b.js";import"./xlsx-4f9172c7.js";function le(v){for(var l=1;l<arguments.length;l++){var d=arguments[l]!=null?Object(arguments[l]):{},g=Object.keys(d);typeof Object.getOwnPropertySymbols=="function"&&(g=g.concat(Object.getOwnPropertySymbols(d).filter(function(x){return Object.getOwnPropertyDescriptor(d,x).enumerable}))),g.forEach(function(x){Ot(v,x,d[x])})}return v}function Ot(v,l,d){return l in v?Object.defineProperty(v,l,{value:d,enumerable:!0,configurable:!0,writable:!0}):v[l]=d,v}var R=function(l,d){var g=le({},l,d.attrs);return t(gt,le({},g,{icon:Ue}),null)};R.displayName="ArrowLeftOutlined";R.inheritAttrs=!1;const Et=R;const zt={class:"container"},It={class:"content-wrapper"},$t=["onClick"],Dt={key:0},Nt={class:"page-header"},Pt={class:"header-right"},Mt={key:0,class:"row-number"},Ut=["onDblclick"],Vt={class:"nombre-text"},Tt={key:2,class:"date-text"},Ft={key:4,class:"ubigeo-text"},Yt={class:"empty-state"},At={key:1},Bt={class:"process-header"},Lt={__name:"calificacion",setup(v){const l=i([{id:0,nombre:"Simulacros"}]),d=i([]),g=i(!1),x=i(!1),k=i(!1),E=i("1"),C=i(null),H=i(null),z=i("");let I;const $=i(""),V=i([]),T=i(""),D=i(!1),K=i(0),X=i(0),p=te({current:1,pageSize:10,total:0,showSizeChanger:!0,pageSizeOptions:["10","20","50","100"],showTotal:(o,e)=>`${e[0]}-${e[1]} de ${o} simulacros`}),N=i(),s=te({nombre:"",fecha:null,ubigeo:null,estado:1}),re={nombre:[{required:!0,message:"Por favor ingrese el nombre del proceso",trigger:"blur"}],ubigeo:[{required:!0,message:"Por favor seleccione una ubicación",trigger:"change"}],fecha:[{required:!0,message:"Por favor seleccione una fecha",trigger:"change"}]},ie=Ve(()=>s.id?"Editar Proceso":"Nuevo Proceso"),ue=o=>o?q(o).format("DD/MM/YYYY"):"N/A",w=async(o={})=>{g.value=!0;try{const r=(await U.post("/get-sim",{term:z.value,page:p.current,per_page:p.pageSize,...o})).data.datos;d.value=r.data,p.total=r.total,p.current=r.current_page,p.pageSize=r.per_page}catch(e){console.error("Error al cargar simulacros:",e),message.error("Error al cargar los simulacros")}finally{g.value=!1}},ce=async()=>{if(!T.value.trim()){V.value=[];return}try{const o=await U.post("/get-ubigeo",{term:T.value});V.value=o.data.datos.data.map(e=>({value:e.nombre,key:e.id,label:e.nombre}))}catch(o){console.error("Error al cargar ubigeos:",o)}},de=(o,e)=>{s.ubigeo=e.key},me=async o=>{l.value=[{id:0,nombre:"Simulacros"},{id:o.id,nombre:o.nombre}],C.value=o.id,H.value=o,E.value="1"},G=o=>{const e=l.value.findIndex(r=>r.id===o.id);e!==-1&&(l.value=l.value.slice(0,e+1)),o.id===0&&(C.value=null,H.value=null)},pe=async()=>{var o,e;try{const r=await N.value.validate();x.value=!0;const F=s.id?"/simulacro/update-simulacro":"/simulacro/save-simulacro",P={...s,fecha:s.fecha?q(s.fecha).format("YYYY-MM-DD"):null};s.id&&(P.id=s.id),await U.post(F,P),message.success(s.id?"Proceso actualizado exitosamente":"Proceso creado exitosamente"),k.value=!1,W(),await w()}catch(r){console.error("Error al guardar:",r),(e=(o=r.response)==null?void 0:o.data)!=null&&e.message&&message.error(r.response.data.message)}finally{x.value=!1}},_e=o=>{s.id=o.id,s.nombre=o.nombre,s.fecha=o.fecha?q(o.fecha):null,s.ubigeo=o.ubigeo_id,s.estado=o.estado,$.value=o.ubigeo_nombre||"",k.value=!0},fe=async o=>{try{await U.post("/simulacro/delete-simulacro",{id:o.id}),message.success("Simulacro eliminado exitosamente"),await w()}catch(e){console.error("Error al eliminar:",e),message.error("Error al eliminar el simulacro")}},ve=o=>{console.log("Ver ficha:",o)},ge=(o,e,r)=>{p.current=o.current,p.pageSize=o.pageSize,w({sortField:r.field,sortOrder:r.order,filters:e})},J=()=>{k.value=!1,W()},W=()=>{s.id=null,s.nombre="",s.fecha=null,s.ubigeo=null,s.estado=1,$.value="",N.value&&N.value.resetFields()},be=()=>{D.value=!1},ye=o=>{D.value=!0,K.value=o.clientY,X.value=o.clientX,o.preventDefault()},xe=o=>{D.value=!1,o.key==="1"&&(k.value=!0)},ke=o=>{E.value=o};ae(z,o=>{clearTimeout(I),I=setTimeout(()=>{p.current=1,w()},500)}),ae(T,o=>{clearTimeout(I),I=setTimeout(()=>{ce()},500)});const Ce=[{title:"N°",dataIndex:"nro",width:60,align:"center"},{title:"Nombre",dataIndex:"nombre",sorter:!0},{title:"Fecha",dataIndex:"fecha",width:120,align:"center",sorter:!0},{title:"Ubigeo",dataIndex:"ubigeo",width:150},{title:"Estado",dataIndex:"estado",width:120,align:"center",filters:[{text:"Vigente",value:1},{text:"No Vigente",value:0}]},{title:"Acciones",dataIndex:"acciones",width:150,align:"center"}];return Te(()=>{w()}),(o,e)=>{const r=Be,F=Le,P=qe,h=je,he=Re,Y=He,we=Ke,Z=Xe,Se=Ge,S=Je,Oe=We,Ee=Ze,A=Qe,ze=et,Ie=tt,M=at,$e=ot,De=nt,Q=st,Ne=lt,Pe=rt,Me=it;return m(),b(oe,null,[t(u(Fe),{title:"Calificación"}),t(ut,null,{default:a(()=>[c("div",zt,[c("div",It,[t(F,{class:"mb-4"},{default:a(()=>[t(r,null,{default:a(()=>[t(u(bt)),e[11]||(e[11]=c("span",{class:"breadcrumb-text"},"Simulacros",-1))]),_:1}),(m(!0),b(oe,null,Ye(l.value.slice(1),(n,_)=>(m(),L(r,{key:n.id},{default:a(()=>[c("a",{onClick:ee=>G(n),class:"breadcrumb-link"},O(n.nombre),9,$t)]),_:2},1024))),128))]),_:1}),c("div",{onClick:be,onContextmenu:ne(ye,["prevent"])},[l.value.length===1?(m(),b("div",Dt,[c("div",Nt,[e[13]||(e[13]=c("div",{class:"header-left"},[c("h1",{class:"page-title"},"Simulacros")],-1)),c("div",Pt,[t(P,{value:z.value,"onUpdate:value":e[0]||(e[0]=n=>z.value=n),placeholder:"Buscar simulacro...",style:{width:"300px"},onSearch:w},{prefix:a(()=>[t(u(yt))]),_:1},8,["value"]),t(h,{type:"primary",class:"ml-2",onClick:e[1]||(e[1]=n=>k.value=!0)},{icon:a(()=>[t(u(se))]),default:a(()=>[e[12]||(e[12]=f(" Nuevo Proceso "))]),_:1})])]),t(Se,{columns:Ce,"data-source":d.value,pagination:p,loading:g.value,onChange:ge,size:"middle"},{bodyCell:a(({column:n,record:_,index:ee})=>[n.dataIndex==="nro"?(m(),b("span",Mt,O((p.current-1)*p.pageSize+ee+1),1)):y("",!0),n.dataIndex==="nombre"?(m(),b("div",{key:1,class:"nombre-cell",onDblclick:B=>me(_)},[t(u(j),{class:"folder-icon"}),c("span",Vt,O(_.nombre),1)],40,Ut)):y("",!0),n.dataIndex==="fecha"?(m(),b("span",Tt,O(ue(_.fecha)),1)):y("",!0),n.dataIndex==="estado"?(m(),L(he,{key:3,status:_.estado===1?"processing":"error",text:_.estado===1?"Vigente":"No Vigente"},null,8,["status","text"])):y("",!0),n.dataIndex==="ubigeo"?(m(),b("span",Ft,O(_.ubigeo_nombre||"N/A"),1)):y("",!0),n.dataIndex==="acciones"?(m(),L(Z,{key:5,size:"small"},{default:a(()=>[t(Y,{title:"Ver ficha"},{default:a(()=>[t(h,{type:"text",size:"small",onClick:B=>ve(_)},{icon:a(()=>[t(u(xt),{class:"action-icon"})]),_:2},1032,["onClick"])]),_:2},1024),t(Y,{title:"Editar"},{default:a(()=>[t(h,{type:"text",size:"small",onClick:B=>_e(_)},{icon:a(()=>[t(u(kt),{class:"action-icon edit-icon"})]),_:2},1032,["onClick"])]),_:2},1024),t(Y,{title:"Eliminar"},{default:a(()=>[t(we,{title:"¿Está seguro de eliminar este simulacro?","ok-text":"Sí","cancel-text":"No",onConfirm:B=>fe(_)},{default:a(()=>[t(h,{type:"text",size:"small",danger:""},{icon:a(()=>[t(u(Ct),{class:"action-icon"})]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)):y("",!0)]),emptyText:a(()=>[c("div",Yt,[t(u(j),{style:{"font-size":"48px",color:"#d9d9d9"}}),e[15]||(e[15]=c("p",null,"No hay simulacros disponibles",-1)),t(h,{type:"primary",onClick:e[2]||(e[2]=n=>k.value=!0)},{default:a(()=>e[14]||(e[14]=[f(" Crear nuevo proceso ")])),_:1})])]),_:1},8,["data-source","pagination","loading"])])):y("",!0),l.value.length===2?(m(),b("div",At,[c("div",Bt,[t(h,{type:"text",onClick:e[3]||(e[3]=n=>G(l.value[0])),class:"back-button"},{icon:a(()=>[t(u(Et))]),default:a(()=>[e[16]||(e[16]=f(" Volver "))]),_:1})]),t(Ee,{class:"tabs-card"},{default:a(()=>[t(Oe,{activeKey:E.value,"onUpdate:activeKey":e[4]||(e[4]=n=>E.value=n),type:"card",onChange:ke},{default:a(()=>[t(S,{key:"1",tab:"Participantes"},{default:a(()=>[t(pt,{proceso:C.value},null,8,["proceso"])]),_:1}),t(S,{key:"2",tab:"IDEs"},{default:a(()=>[t(ct,{proceso:C.value},null,8,["proceso"])]),_:1}),t(S,{key:"3",tab:"Respuestas"},{default:a(()=>[t(dt,{proceso:C.value},null,8,["proceso"])]),_:1}),t(S,{key:"4",tab:"Respuestas Correctas"},{default:a(()=>[t(mt,{proceso:C.value},null,8,["proceso"])]),_:1}),t(S,{key:"5",tab:"Calificación"},{default:a(()=>[t(_t,{proceso:C.value},null,8,["proceso"])]),_:1}),t(S,{key:"6",tab:"Exepciones"},{default:a(()=>[t(ft,{id_proceso:C.value},null,8,["id_proceso"])]),_:1})]),_:1},8,["activeKey"])]),_:1})])):y("",!0)],32)])]),D.value?(m(),b("div",{key:0,class:"context-menu",style:Ae({top:`${K.value}px`,left:`${X.value}px`}),onClick:e[5]||(e[5]=ne(()=>{},["stop"]))},[t(ze,{onClick:xe},{default:a(()=>[t(A,{key:"1"},{icon:a(()=>[t(u(se))]),default:a(()=>[e[17]||(e[17]=f(" Nuevo Proceso "))]),_:1}),t(A,{key:"2"},{icon:a(()=>[t(u(ht))]),default:a(()=>[e[18]||(e[18]=f(" Subir archivo "))]),_:1}),t(A,{key:"3"},{icon:a(()=>[t(u(wt))]),default:a(()=>[e[19]||(e[19]=f(" Duplicar selección "))]),_:1})]),_:1})],4)):y("",!0),t(Me,{open:k.value,"onUpdate:open":e[10]||(e[10]=n=>k.value=n),title:ie.value,width:"500px",centered:"",closable:!0,onCancel:J,maskClosable:!1},{footer:a(()=>[t(Z,null,{default:a(()=>[t(h,{onClick:J},{default:a(()=>e[22]||(e[22]=[f(" Cancelar ")])),_:1}),t(h,{type:"primary",onClick:pe,loading:x.value},{default:a(()=>e[23]||(e[23]=[f(" Guardar ")])),_:1},8,["loading"])]),_:1})]),default:a(()=>[t(Pe,{ref_key:"formDatos",ref:N,model:s,rules:re,layout:"vertical"},{default:a(()=>[t(M,{label:"Nombre del proceso",name:"nombre",required:""},{default:a(()=>[t(Ie,{value:s.nombre,"onUpdate:value":e[6]||(e[6]=n=>s.nombre=n),placeholder:"Ingrese el nombre del proceso",size:"large"},{prefix:a(()=>[t(u(j))]),_:1},8,["value"])]),_:1}),t(M,{label:"Ubicación",name:"ubigeo",required:""},{default:a(()=>[t($e,{value:$.value,"onUpdate:value":e[7]||(e[7]=n=>$.value=n),options:V.value,onSelect:de,placeholder:"Buscar ubicación...",size:"large"},{prefix:a(()=>[t(u(St))]),_:1},8,["value","options"])]),_:1}),t(M,{label:"Fecha",name:"fecha",required:""},{default:a(()=>[t(De,{value:s.fecha,"onUpdate:value":e[8]||(e[8]=n=>s.fecha=n),placeholder:"Seleccionar fecha",style:{width:"100%"},size:"large",format:"DD/MM/YYYY"},null,8,["value"])]),_:1}),t(M,{label:"Estado",name:"estado"},{default:a(()=>[t(Ne,{value:s.estado,"onUpdate:value":e[9]||(e[9]=n=>s.estado=n)},{default:a(()=>[t(Q,{value:1},{default:a(()=>e[20]||(e[20]=[f("Vigente")])),_:1}),t(Q,{value:0},{default:a(()=>e[21]||(e[21]=[f("No vigente")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},8,["model"])]),_:1},8,["open","title"])]),_:1})],64)}}},ba=vt(Lt,[["__scopeId","data-v-8fe97745"]]);export{ba as default};
