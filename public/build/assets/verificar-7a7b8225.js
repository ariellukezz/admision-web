import{a as o,b2 as pe,b3 as me,b4 as _e,b5 as ve,r as _,H as E,a2 as Oe,aH as ge,o as m,c as v,d as a,w as l,y as be,b6 as De,m as Ie,b as f,t as u,u as p,x as h,f as V,E as Z,F as ye,s as Ne,b7 as Ee,P as Ae,l as he,B as Ve,L as Pe,g as Le,aQ as Se,a8 as Fe,a7 as Re,b8 as xe,b9 as we}from"./app-d94ab509.js";import{_ as ze}from"./_plugin-vue_export-helper-c27b6911.js";import{A as N}from"./AntdIcon-c56eb973.js";import{F as Ce}from"./FileTextOutlined-fed66a23.js";import{S as B}from"./SafetyCertificateOutlined-17e2c446.js";import{E as H}from"./EditOutlined-7757bf87.js";import{D as U}from"./DownloadOutlined-f83b0136.js";var Me={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M854.6 288.6L639.4 73.4c-6-6-14.1-9.4-22.6-9.4H192c-17.7 0-32 14.3-32 32v832c0 17.7 14.3 32 32 32h640c17.7 0 32-14.3 32-32V311.3c0-8.5-3.4-16.7-9.4-22.7zM790.2 326H602V137.8L790.2 326zm1.8 562H232V136h302v216a42 42 0 0042 42h216v494zM472 744a40 40 0 1080 0 40 40 0 10-80 0zm16-104h48c4.4 0 8-3.6 8-8V448c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v184c0 4.4 3.6 8 8 8z"}}]},name:"file-exclamation",theme:"outlined"};const $e=Me;var je={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M688 312v-48c0-4.4-3.6-8-8-8H296c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h384c4.4 0 8-3.6 8-8zm-392 88c-4.4 0-8 3.6-8 8v48c0 4.4 3.6 8 8 8h184c4.4 0 8-3.6 8-8v-48c0-4.4-3.6-8-8-8H296zm144 452H208V148h560v344c0 4.4 3.6 8 8 8h56c4.4 0 8-3.6 8-8V108c0-17.7-14.3-32-32-32H168c-17.7 0-32 14.3-32 32v784c0 17.7 14.3 32 32 32h272c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm445.7 51.5l-93.3-93.3C814.7 780.7 828 743.9 828 704c0-97.2-78.8-176-176-176s-176 78.8-176 176 78.8 176 176 176c35.8 0 69-10.7 96.8-29l94.7 94.7c1.6 1.6 3.6 2.3 5.6 2.3s4.1-.8 5.6-2.3l31-31a7.9 7.9 0 000-11.2zM652 816c-61.9 0-112-50.1-112-112s50.1-112 112-112 112 50.1 112 112-50.1 112-112 112z"}}]},name:"file-search",theme:"outlined"};const Te=je;function q(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){ke(r,s,e[s])})}return r}function ke(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var F=function(n,e){var i=q({},n,e.attrs);return o(N,q({},i,{icon:pe}),null)};F.displayName="CalendarOutlined";F.inheritAttrs=!1;const Ze=F;function X(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){Be(r,s,e[s])})}return r}function Be(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var R=function(n,e){var i=X({},n,e.attrs);return o(N,X({},i,{icon:$e}),null)};R.displayName="FileExclamationOutlined";R.inheritAttrs=!1;const He=R;function G(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){Ue(r,s,e[s])})}return r}function Ue(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var x=function(n,e){var i=G({},n,e.attrs);return o(N,G({},i,{icon:Te}),null)};x.displayName="FileSearchOutlined";x.inheritAttrs=!1;const qe=x;function Q(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){Xe(r,s,e[s])})}return r}function Xe(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var w=function(n,e){var i=Q({},n,e.attrs);return o(N,Q({},i,{icon:me}),null)};w.displayName="ReloadOutlined";w.inheritAttrs=!1;const Ge=w;function J(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){Qe(r,s,e[s])})}return r}function Qe(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var z=function(n,e){var i=J({},n,e.attrs);return o(N,J({},i,{icon:_e}),null)};z.displayName="ZoomInOutlined";z.inheritAttrs=!1;const Je=z;function W(r){for(var n=1;n<arguments.length;n++){var e=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(e);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(e).filter(function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),i.forEach(function(s){We(r,s,e[s])})}return r}function We(r,n,e){return n in r?Object.defineProperty(r,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):r[n]=e,r}var C=function(n,e){var i=W({},n,e.attrs);return o(N,W({},i,{icon:ve}),null)};C.displayName="ZoomOutOutlined";C.inheritAttrs=!1;const Ye=C;const Ke={class:"pdf-verification-container"},et={class:"verification-header"},tt={class:"card-content"},nt={class:"card-icon",style:{background:"#e6f4ff"}},at={class:"card-stats"},rt={class:"card-content"},ot={class:"card-stats"},it={class:"card-content"},st={class:"card-icon",style:{background:"#f6ffed"}},lt={class:"card-stats"},ct={class:"card-content"},ut={class:"card-icon",style:{background:"#fff7e6"}},dt={class:"card-stats"},ft={class:"zoom-level"},pt={class:"pdf-viewer-wrapper"},mt=["src"],_t={key:1,class:"pdf-error-state"},vt={key:2,class:"pdf-empty-state"},Ot={class:"signatures-list"},gt={key:0,class:"no-signatures"},bt={class:"signature-card"},Dt={class:"signature-date"},It={class:"signature-body"},yt={class:"signature-info"},Nt={class:"certificate-info"},Et={key:0,class:"signature-warnings"},At={class:"verification-actions"},ht={__name:"verificar",props:{codigo:{type:String,required:!0,default:"EX25380044"}},setup(r){const n=r,e=_({codigo_inscripcion:"",estado:"",total_firmas:0,fecha_verificacion:"",firmas:[]}),i=_(null),s=_(""),O=_(1),g=_(!1),b=_(!1),A=_(""),Y=E(()=>{var t;const c=(t=e.value.estado)==null?void 0:t.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"Documento Válido":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"Documento Inválido":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"Verificación Indeterminada":"No Verificado"}),P=E(()=>{var t;const c=(t=e.value.estado)==null?void 0:t.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"#52c41a":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"#ff4d4f":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"#fa8c16":"#1890ff"}),K=E(()=>`linear-gradient(135deg, ${P.value} 0%, ${P.value}80 100%)`);E(()=>{var t;const c=(t=e.value.estado)==null?void 0:t.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"success":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"error":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"warning":"info"}),E(()=>{var t;const c=(t=e.value.estado)==null?void 0:t.toUpperCase();return["VÁLIDO","VALIDO","FIRMADO_VÁLIDO"].includes(c)?"Todas las firmas digitales son válidas y los certificados están vigentes.":["INVÁLIDO","INVALIDO","FIRMADO_INVÁLIDO"].includes(c)?"Se detectaron firmas inválidas o certificados caducados.":["INDETERMINADO","FIRMADO_INDETERMINADO"].includes(c)?"Las firmas son técnicamente válidas pero requieren verificación adicional.":"El documento aún no ha sido verificado."});const ee=c=>{const t=c==null?void 0:c.toUpperCase();return["VÁLIDA","VALIDO","VALIDA"].includes(t)?"#52c41a":["INVÁLIDA","INVALIDO","INVALIDA"].includes(t)?"#ff4d4f":t!=null&&t.includes("INDETERMINADA")||t!=null&&t.includes("INDETERMINADO")?"#fa8c16":"#1890ff"},te=async()=>{try{const c=await be.get(`/verificar/${n.codigo}`);c.data.success?e.value=c.data.data||c.data:e.value={codigo_inscripcion:n.codigo,estado:"ERROR",total_firmas:0,fecha_verificacion:new Date().toLocaleDateString("es-PE"),firmas:[]}}catch{e.value={codigo_inscripcion:n.codigo,estado:"ERROR_DE_CONEXION",total_firmas:0,fecha_verificacion:new Date().toLocaleDateString("es-PE"),firmas:[]}}},L=async()=>{g.value=!0,b.value=!1,A.value="";try{s.value=`/inscripcion/${n.codigo}/pdf`,i.value&&(i.value.src=s.value)}catch(c){b.value=!0,A.value=c.message||"Error desconocido",s.value=""}},ne=()=>{g.value=!1,b.value=!1},ae=()=>{g.value=!1,b.value=!0,A.value="No se pudo cargar el PDF"},re=()=>{O.value<2&&(O.value+=.1)},oe=()=>{O.value>.3&&(O.value-=.1)},M=()=>window.open(`/inscripcion/${n.codigo}/pdf`,"_blank");return Oe(async()=>{await Promise.all([te(),L()])}),ge(()=>{i.value&&(i.value.src="")}),(c,t)=>{const S=Ee,ie=De,D=Ae,I=he,$=Ie,y=Ve,j=Pe,se=Le,le=Se,ce=Fe,ue=Re,de=xe,fe=we;return m(),v("div",Ke,[a("div",et,[o(ie,null,{default:l(()=>[o(S,null,{default:l(()=>t[0]||(t[0]=[f("Inicio")])),_:1}),o(S,null,{default:l(()=>t[1]||(t[1]=[f("Verificación")])),_:1}),o(S,null,{default:l(()=>[f(u(e.value.codigo_inscripcion),1)]),_:1})]),_:1}),t[2]||(t[2]=a("div",{class:"header-title"},[a("h1",null,"Verificación de Documento Firmado"),a("p",{class:"subtitle"},"Análisis digital de firmas electrónicas")],-1))]),o($,{gutter:16,class:"summary-cards"},{default:l(()=>[o(I,{xs:24,sm:12,md:6},{default:l(()=>[o(D,{class:"summary-card",bordered:!1},{default:l(()=>[a("div",tt,[a("div",nt,[o(p(Ce),{style:{color:"#1890ff","font-size":"24px"}})]),a("div",at,[a("h3",null,u(e.value.codigo_inscripcion),1),t[3]||(t[3]=a("p",null,"Código de Inscripción",-1))])])]),_:1})]),_:1}),o(I,{xs:24,sm:12,md:6},{default:l(()=>[o(D,{class:"summary-card",bordered:!1},{default:l(()=>[a("div",rt,[a("div",{class:"card-icon",style:h({background:K.value})},[o(p(B),{style:{color:"#fff","font-size":"24px"}})],4),a("div",ot,[a("h3",{style:h({color:P.value})},u(Y.value),5),t[4]||(t[4]=a("p",null,"Estado de Verificación",-1))])])]),_:1})]),_:1}),o(I,{xs:24,sm:12,md:6},{default:l(()=>[o(D,{class:"summary-card",bordered:!1},{default:l(()=>[a("div",it,[a("div",st,[o(p(H),{style:{color:"#52c41a","font-size":"24px"}})]),a("div",lt,[a("h3",null,u(e.value.total_firmas||0),1),t[5]||(t[5]=a("p",null,"Firmas Detectadas",-1))])])]),_:1})]),_:1}),o(I,{xs:24,sm:12,md:6},{default:l(()=>[o(D,{class:"summary-card",bordered:!1},{default:l(()=>[a("div",ct,[a("div",ut,[o(p(Ze),{style:{color:"#fa8c16","font-size":"24px"}})]),a("div",dt,[a("h3",null,u(e.value.fecha_verificacion||"--/--/----"),1),t[6]||(t[6]=a("p",null,"Fecha de Verificación",-1))])])]),_:1})]),_:1})]),_:1}),o($,{gutter:24,class:"main-content"},{default:l(()=>[o(I,{xs:24,md:14},{default:l(()=>[o(D,{class:"pdf-viewer-card",title:`Documento: ${e.value.codigo_inscripcion}.pdf`,bordered:!1},{extra:l(()=>[o(le,null,{default:l(()=>[o(j,{title:"Disminuir zoom"},{default:l(()=>[o(y,{shape:"circle",onClick:oe,size:"small"},{default:l(()=>[o(p(Ye))]),_:1})]),_:1}),a("span",ft,u(Math.round(O.value*100))+"%",1),o(j,{title:"Aumentar zoom"},{default:l(()=>[o(y,{shape:"circle",onClick:re,size:"small"},{default:l(()=>[o(p(Je))]),_:1})]),_:1}),o(se,{type:"vertical"}),o(y,{type:"primary",onClick:M,class:"download-btn"},{default:l(()=>[o(p(U)),t[7]||(t[7]=f(" Descargar PDF "))]),_:1})]),_:1})]),default:l(()=>[a("div",pt,[o(ce,{spinning:g.value,size:"large",tip:"Cargando documento..."},{default:l(()=>[s.value?(m(),v("iframe",{key:0,ref_key:"pdfFrame",ref:i,src:s.value,class:"pdf-iframe",style:h({transform:`scale(${O.value})`,transformOrigin:"top left"}),onLoad:ne,onError:ae},null,44,mt)):V("",!0),b.value&&!g.value?(m(),v("div",_t,[o(p(He),{style:{"font-size":"48px",color:"#ff4d4f"}}),t[9]||(t[9]=a("h3",null,"Error al cargar el PDF",-1)),a("p",null,u(A.value),1),o(y,{type:"primary",onClick:L},{default:l(()=>t[8]||(t[8]=[f("Reintentar carga")])),_:1})])):V("",!0),!s.value&&!g.value&&!b.value?(m(),v("div",vt,[o(p(qe),{style:{"font-size":"48px",color:"#d9d9d9"}}),t[10]||(t[10]=a("h3",null,"Documento no disponible",-1)),t[11]||(t[11]=a("p",null,"No se pudo cargar el documento PDF",-1))])):V("",!0)]),_:1},8,["spinning"])])]),_:1},8,["title"])]),_:1}),o(I,{xs:24,md:10},{default:l(()=>[o(D,{class:"signatures-card",title:"Análisis de Firmas Digitales",bordered:!1},{default:l(()=>[a("div",Ot,[!e.value.firmas||e.value.firmas.length===0?(m(),v("div",gt,[o(p(H),{style:{"font-size":"48px",color:"#d9d9d9"}}),t[12]||(t[12]=a("p",null,"No se detectaron firmas digitales",-1))])):(m(),Z(fe,{key:1,accordion:""},{default:l(()=>[(m(!0),v(ye,null,Ne(e.value.firmas,(d,T)=>(m(),Z(de,{key:T,header:`Firma #${T+1}: ${d.firmante||"Desconocido"}`,class:"signature-panel"},{default:l(()=>{var k;return[a("div",bt,[a("div",{class:"signature-header",style:h({borderLeftColor:ee(d.estado_servicio)})},[o(p(B),{style:{"font-size":"24px","margin-right":"8px"}}),a("div",null,[a("h4",null,u(d.estado_servicio),1),a("span",Dt,u(d.fecha_firma),1)])],4),a("div",It,[a("div",yt,[a("p",null,[t[13]||(t[13]=a("strong",null,"Nombre:",-1)),f(" "+u(d.firmante),1)]),a("p",null,[t[14]||(t[14]=a("strong",null,"Email:",-1)),f(" "+u(d.email||"No especificado"),1)]),a("p",null,[t[15]||(t[15]=a("strong",null,"Algoritmo:",-1)),f(" "+u(d.algoritmo),1)]),a("p",null,[t[16]||(t[16]=a("strong",null,"Campo de firma:",-1)),t[17]||(t[17]=f()),a("code",null,u(d.campo_firma||"-"),1)])]),a("div",Nt,[t[23]||(t[23]=a("h5",null,"Certificado Digital",-1)),a("p",null,[t[18]||(t[18]=a("strong",null,"Emisor:",-1)),f(" "+u(d.certificado.emisor),1)]),a("p",null,[t[19]||(t[19]=a("strong",null,"Sujeto:",-1)),f(" "+u(d.certificado.sujeto),1)]),a("p",null,[t[20]||(t[20]=a("strong",null,"Número de Serie:",-1)),t[21]||(t[21]=f()),a("code",null,u(d.certificado.numero_serie),1)]),a("p",null,[t[22]||(t[22]=a("strong",null,"Validez:",-1)),f(" "+u(d.certificado.valido_desde)+" → "+u(d.certificado.valido_hasta),1)])]),(k=d.advertencias)!=null&&k.length?(m(),v("div",Et,[o(ue,{type:"warning",message:`Advertencia${d.advertencias.length>1?"s":""}`,description:d.advertencias.join(" | "),"show-icon":""},null,8,["message","description"])])):V("",!0)])])]}),_:2},1032,["header"]))),128))]),_:1}))]),a("div",At,[o(y,{type:"primary",block:"",size:"large",onClick:M,class:"action-btn"},{default:l(()=>[o(p(U)),t[24]||(t[24]=f(" Descargar Certificado de Verificación "))]),_:1}),o(y,{block:"",size:"large",onClick:L,class:"action-btn"},{default:l(()=>[o(p(Ge)),t[25]||(t[25]=f(" Reanalizar Documento "))]),_:1})])]),_:1})]),_:1})]),_:1})])}}},wt=ze(ht,[["__scopeId","data-v-11997aaf"]]);export{wt as default};
