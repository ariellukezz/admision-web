import{a,aX as ne,r as v,e as $,C as se,D as le,o as w,c as F,u as _,w as s,d as o,F as B,y as k,M as re,Z as ie,b,t as O,E as D,f as P,G as de,n as ue,B as pe,j as ce,I as me,_ as ve,h as ge,i as fe,k as _e,S as be,p as ye,q as we}from"./app-6aa1274b.js";import{_ as he}from"./LayoutDirector-89022c8e.js";import{A as xe}from"./AntdIcon-2c94e431.js";import{D as E}from"./DownloadOutlined-08d9fb64.js";import{S as Se}from"./SearchOutlined-f43f037f.js";import{S as ke}from"./SaveOutlined-566d1912.js";import{F as Oe}from"./FormOutlined-2b34ad2c.js";import{D as Ce}from"./DeleteOutlined-23f5ca99.js";import"./logotiny-c4b525af.js";import"./Header-ae97f766.js";import"./DropdownLink-d6703d39.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./DownOutlined-3e2f91e8.js";function T(y){for(var p=1;p<arguments.length;p++){var m=arguments[p]!=null?Object(arguments[p]):{},d=Object.keys(m);typeof Object.getOwnPropertySymbols=="function"&&(d=d.concat(Object.getOwnPropertySymbols(m).filter(function(c){return Object.getOwnPropertyDescriptor(m,c).enumerable}))),d.forEach(function(c){Ie(y,c,m[c])})}return y}function Ie(y,p,m){return p in y?Object.defineProperty(y,p,{value:m,enumerable:!0,configurable:!0,writable:!0}):y[p]=m,y}var R=function(p,m){var d=T({},p,m.attrs);return a(xe,T({},d,{icon:ne}),null)};R.displayName="PlusOutlined";R.inheritAttrs=!1;const Fe=R,Pe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4 pb-0 mb-4"},$e={class:"flex justify-between"},ze={class:"ml-0 mt-1"},Ue={style:{"font-size":"1.4rem"}},je={class:"flex"},De={class:"mr-1"},Ee={class:"flex"},Re={class:"mr-2",style:{"margin-top":"-3px"}},Ve={class:"mr-1"},Ae={class:"flex"},Ne={class:"mr-2",style:{"margin-top":"-3px"}},Le={class:"flex"},Me={class:"mr-2",style:{"margin-top":"-3px"}},Be={class:"flex mt-4 mb-6 justify-between"},Te={class:"mr-1"},Ge={class:"flex"},Ye={class:"mr-2",style:{"margin-top":"-3px"},disabled:""},He={class:"flex"},Xe={class:"mr-1"},qe={class:"flex justify-between",style:{position:"relative"}},Ze={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg py-4"},Je={style:{"font-size":".81rem","font-weight":"bold"}},Ke={key:1,style:{"font-size":"0.9rem"}},Qe={key:2,style:{"font-size":"0.8rem"}},We={key:3,style:{"font-size":"0.8rem","text-transform":"uppercase"}},et={key:5,class:"flex justify-center",style:{}},tt={class:"mr-1"},at={class:"mr-1"},ot={class:""},nt={class:""},yt={__name:"index",setup(y){const p=v([]),m=v([]),d=v(null),c=v(""),V=v([]),C=v(!1),h=v(1),U=v(null),I=v(20),l=v({id:null,codigo:"",id_posulante:"",id_programa:"",id_modalidad:"",estado:!0,observacion:""}),g=v({id:"",nombre:"",dni:""});$(c,(t,e)=>{x()}),$(I,(t,e)=>{x()}),$(d,(t,e)=>{t==0&&(d.value=null),h.value=1,x()}),$(C,(t,e)=>{C.value==!1&&l.value.id!=null&&(l.value.id=null,l.value.id_posulante="",l.value.id_programa="",l.value.id_modalidad="",l.value.estado=!0,l.value.observacion="",g.value.nombre=null,g.value.dni=null,g.value.id=null)}),$(h,(t,e)=>{x()});const A=t=>{C.value=!0,l.value.id=t.id,l.value.codigo=t.codigo,l.value.id_programa=t.id_programa,l.value.id_modalidad=t.id_modalidad,l.value.observacion=t.observacion,g.value.id=t.id_postulante,g.value.dni=t.dni,g.value.nombre=t.dni+" - "+t.nombres+" "+t.paterno+" "+t.materno},G=async()=>{let t=await k.post("/segundas/select-programas-segundas?page="+h.value,{term:c.value,paginashoja:I.value,programa:d.value});m.value=t.data.datos},Y=async()=>{let t=await k.post("/segundas/select-programas-segundas-autorizados?page="+h.value,{term:c.value,paginashoja:I.value,programa:d.value});p.value=t.data.datos};G(),Y();const x=async()=>{let t=await k.post("/segundas/get-preinscripciones-segundas?page="+h.value,{term:c.value,paginashoja:I.value,programa:d.value});V.value=t.data.datos.data,U.value=t.data.datos.total},H=()=>{let t={id:l.value.id,id_postulante:g.value.id,id_programa:l.value.id_programa,id_modalidad:l.value.id_modalidad,observacion:l.value.observacion,dni:g.value.dni};k.post("/segundas/actualizar-preinscripciones-segundas",t).then(e=>{x(),L("success",e.data.titulo,e.data.mensaje),C.value=!1})},X=t=>{console.log("eliminar"),k.post("eliminar-preinscripcion/",{id:t.id}).then(e=>{x(),L("warning",e.data.titulo,e.data.mensaje)})},q=[{title:"DNI",dataIndex:"dni",align:"center"},{title:"Postulante",dataIndex:"postulante"},{title:"Programa",dataIndex:"programa"},{title:"Modalidad",dataIndex:"modalidad",align:"center"},{title:"Estado",dataIndex:"estado",align:"center"},{title:"Observación",dataIndex:"observacion"},{title:"Acciones",dataIndex:"acciones",width:"140px",align:"center"}],N=v([]),Z=t=>{console.log("selectedRowKeys changed: ",t),N.value=t};se(()=>({selectedRowKeys:_(N),onChange:Z,hideDefaultSelections:!0}));const L=(t,e,r)=>{ue[t]({message:e,description:r})};x();const J=async t=>{try{const e=await k.post("/segundas/get-detalle-preinscripcion-segundas",{term:c.value,programa:d.value},{responseType:"blob"});if(e.status!==200)throw new Error("Error al obtener el archivo");const r=window.URL.createObjectURL(new Blob([e.data])),u=document.createElement("a");u.href=r;const i=new Date,S=`${`${i.getDate().toString().padStart(2,"0")}-${(i.getMonth()+1).toString().padStart(2,"0")}-${i.getFullYear()}_${i.getHours().toString().padStart(2,"0")}-${i.getMinutes().toString().padStart(2,"0")}-${i.getSeconds().toString().padStart(2,"0")}`}_preinscritos.pdf`;u.setAttribute("download",S),document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(r)}catch(e){console.error("Error al descargar el archivo:",e)}},K=async t=>{try{const e=await k.post("/segundas/get-resumen-preinscripcion-segundas",{term:c.value,programa:d.value},{responseType:"blob"});if(e.status!==200)throw new Error("Error al obtener el archivo");const r=window.URL.createObjectURL(new Blob([e.data])),u=document.createElement("a");u.href=r;const i=new Date,S=`${`${i.getDate().toString().padStart(2,"0")}-${(i.getMonth()+1).toString().padStart(2,"0")}-${i.getFullYear()}_${i.getHours().toString().padStart(2,"0")}-${i.getMinutes().toString().padStart(2,"0")}-${i.getSeconds().toString().padStart(2,"0")}`}_resumen.pdf`;u.setAttribute("download",S),document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(r)}catch(e){console.error("Error al descargar el archivo:",e)}};return(t,e)=>{const r=pe,u=ce,i=me,j=le("row"),S=ve,Q=ge,W=fe,z=_e,ee=be,te=ye,ae=we,oe=re;return w(),F(B,null,[a(_(ie),{title:"Preinscripciones"}),a(he,null,{default:s(()=>[o("div",Pe,[a(j,{class:"mb-4"},{default:s(()=>[o("div",$e,[o("div",ze,[e[12]||(e[12]=o("span",{style:{"font-size":"1.5rem"}},"Preinscripción",-1)),e[13]||(e[13]=b()),o("span",Ue," - "+O(U.value)+" registros",1)]),o("div",je,[o("div",De,[a(r,{onClick:e[0]||(e[0]=n=>K()),class:"bg-blue-900",style:{color:"white",border:"none"}},{default:s(()=>[o("div",Ee,[o("div",Re,[a(_(E))]),e[14]||(e[14]=b(" RESUMEN "))])]),_:1})]),o("div",Ve,[a(r,{class:"bg-green-600",style:{color:"white",border:"none"}},{default:s(()=>[o("div",Ae,[o("div",Ne,[a(_(E))]),e[15]||(e[15]=b(" EXCEL "))])]),_:1})]),o("div",null,[a(r,{onClick:e[1]||(e[1]=n=>J()),class:"bg-red-600",style:{color:"white",border:"none"}},{default:s(()=>[o("div",Le,[o("div",Me,[a(_(E))]),e[16]||(e[16]=b(" PDF "))])]),_:1})])])]),o("div",Be,[o("div",null,[o("div",Te,[o("div",null,[a(r,{class:"bg-gray-400",style:{color:"white",border:"none"}},{default:s(()=>[o("div",Ge,[o("div",Ye,[a(_(Fe))]),e[17]||(e[17]=b(" Nuevo Registro "))])]),_:1})])])]),o("div",He,[o("div",Xe,[a(u,{ref:"select",value:d.value,"onUpdate:value":e[2]||(e[2]=n=>d.value=n),placeholder:"Seleccionar programa de estudios",options:p.value,allowClear:""},null,8,["value","options"])]),o("div",qe,[a(i,{type:"text",placeholder:"Escribe para buscar..!!",value:c.value,"onUpdate:value":e[3]||(e[3]=n=>c.value=n),style:{"max-width":"200px","padding-left":"10px"}},{prefix:s(()=>[a(_(Se))]),_:1},8,["value"])])])])]),_:1})]),o("div",Ze,[a(Q,{columns:q,"data-source":V.value,pagination:!1,size:"small"},{bodyCell:s(({column:n,index:st,record:f})=>[n.dataIndex==="dni"?(w(),D(S,{key:0,color:"#476175",style:{"padding-top":"3px"}},{default:s(()=>[o("span",Je,O(f.dni),1)]),_:2},1024)):P("",!0),n.dataIndex==="postulante"?(w(),F("span",Ke,O(f.paterno)+" "+O(f.materno)+", "+O(f.nombres),1)):P("",!0),n.dataIndex==="modalidad"?(w(),F("span",Qe,O(f.modalidad),1)):P("",!0),n.dataIndex==="programa"?(w(),F("span",We,O(f.programa),1)):P("",!0),n.dataIndex==="estado"?(w(),F(B,{key:4},[f.estado===0?(w(),D(S,{key:0,style:{"font-size":".5rem"},color:"#476175"},{default:s(()=>e[18]||(e[18]=[b("INSCRITO")])),_:1})):(w(),D(S,{key:1,color:"#b01030",style:{"font-size":".7rem"}},{default:s(()=>e[19]||(e[19]=[b("SIN INSCRIPCIÓN")])),_:1}))],64)):P("",!0),n.dataIndex==="acciones"?(w(),F("div",et,[o("div",tt,[a(r,{type:"true",onClick:M=>A(f),size:"small",style:{background:"#f3f3f3",height:"30px",border:"solid 1px #d9d9d9",color:"gray",display:"flex","align-items":"center"}},{default:s(()=>[a(_(ke))]),_:2},1032,["onClick"])]),o("div",at,[a(r,{type:"true",onClick:M=>A(f),size:"small",style:{background:"#f3f3f3",height:"30px",border:"solid 1px #d9d9d9",color:"blue",display:"flex","align-items":"center"}},{default:s(()=>[a(_(Oe))]),_:2},1032,["onClick"])]),o("div",ot,[a(r,{type:"true",onClick:M=>X(f),size:"small",style:{background:"#f3f3f3",height:"30px",color:"crimson",border:"solid 1px #d9d9d9",display:"flex","align-items":"center"}},{default:s(()=>[a(_(Ce))]),_:2},1032,["onClick"])])])):P("",!0)]),_:1},8,["data-source"]),a(W,{current:h.value,"onUpdate:current":e[4]||(e[4]=n=>h.value=n),total:U.value,pageSize:I.value,"onUpdate:pageSize":e[5]||(e[5]=n=>I.value=n),"show-less-items":""},null,8,["current","total","pageSize"])])]),_:1}),o("div",null,[a(oe,{open:C.value,"onUpdate:open":e[11]||(e[11]=n=>C.value=n),title:"Modificar Pre inscripción",style:{"margin-top":"-40px"}},{footer:s(()=>[a(r,{style:{"margin-left":"10px"},onClick:t.resetForm},{default:s(()=>e[25]||(e[25]=[b("Cancelar")])),_:1},8,["onClick"]),a(r,{type:"primary",onClick:e[10]||(e[10]=n=>H())},{default:s(()=>e[26]||(e[26]=[b("Guardar")])),_:1})]),default:s(()=>[a(ae,de({ref:"formRef",name:"custom-validation",model:t.formState},t.layout,{onFinish:t.handleFinish,onValidate:t.handleValidate,onFinishFailed:t.handleFinishFailed}),{default:s(()=>[a(z,{"has-feedback":"",name:"nombre"},{default:s(()=>[e[20]||(e[20]=o("label",null,"Postulante",-1)),a(i,{type:"text",value:g.value.nombre,"onUpdate:value":e[6]||(e[6]=n=>g.value.nombre=n)},null,8,["value"])]),_:1}),a(z,{"has-feedback":"",name:"postulante"},{default:s(()=>[e[21]||(e[21]=o("label",null,"Programa",-1)),o("div",nt,[a(u,{ref:"select",value:l.value.id_programa,"onUpdate:value":e[7]||(e[7]=n=>l.value.id_programa=n),placeholder:"Seleccionar programa",class:"selector-modalidad",style:{width:"100%"},options:m.value},null,8,["value","options"])])]),_:1}),a(z,{"has-feedback":"",name:"tipo"},{default:s(()=>[e[23]||(e[23]=o("label",null,"Modalidad",-1)),a(u,{ref:"select",value:l.value.id_modalidad,"onUpdate:value":e[8]||(e[8]=n=>l.value.id_modalidad=n),placeholder:"Seleccionar programa",class:"selector-modalidad",style:{width:"100%"}},{default:s(()=>[a(ee,{value:1},{default:s(()=>e[22]||(e[22]=[b("GRADUADOS Y TITULADOS")])),_:1})]),_:1},8,["value"])]),_:1}),a(z,{"has-feedback":"",name:"nombre"},{default:s(()=>[e[24]||(e[24]=o("label",null,"Observaciones",-1)),a(te,{type:"text",value:l.value.observacion,"onUpdate:value":e[9]||(e[9]=n=>l.value.observacion=n),autocomplete:"off"},null,8,["value"])]),_:1})]),_:1},16,["model","onFinish","onValidate","onFinishFailed"])]),_:1},8,["open"])])],64)}}};export{yt as default};
