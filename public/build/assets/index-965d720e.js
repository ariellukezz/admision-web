import{a1 as b,a2 as k}from"./app-d69900d9.js";import{x as L}from"./xlsx-90492bf8.js";var d={exports:{}};const P=b(L);(function(h,r){Object.defineProperty(r,"__esModule",{value:!0}),r.libraryName=r.xlsx=r.getWorksheetColumnWidths=r.getJsonSheetRow=r.getContentProperty=r.utils=void 0;const u=P;Object.defineProperty(r,"utils",{enumerable:!0,get:function(){return u.utils}});const v=(e,o)=>{const l=(s,i)=>{const n=s[i[0]];return i.length===1?n??"":n===void 0||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Date?"":l(n,i.slice(1))},t=o.split(".");return l(e,t)};r.getContentProperty=v;const C=(e,o)=>{const l={};return o.forEach(t=>{typeof t.value=="function"?l[t.label]=t.value(e):l[t.label]=(0,r.getContentProperty)(e,t.value)}),l};r.getJsonSheetRow=C;const p=(e,o,l)=>{var t;for(let s=0;s<o.length;s+=1){const i=l[s];if(!i)continue;const n=u.utils.decode_col(o[s]),a=u.utils.decode_range((t=e["!ref"])!==null&&t!==void 0?t:"");for(let c=a.s.r+1;c<=a.e.r;++c){const f=u.utils.encode_cell({r:c,c:n});e[f]&&(e[f].z=i)}}},m=e=>{var o;const l=u.utils.decode_range((o=e["!ref"])!==null&&o!==void 0?o:""),t=[];for(let s=l.s.c;s<=l.e.c;s++){const i=u.utils.encode_col(s);t.push(i)}return t},_=e=>typeof e=="string"?e.length:typeof e=="number"?e.toString().length:typeof e=="boolean"?e?4:5:e instanceof Date?e.toString().length:0,W=(e,o=1)=>m(e).map(t=>({width:Object.keys(e).filter(n=>n.replace(/[0-9]/g,"")===t).reduce((n,a)=>{const c=e[a],f=_(c.v);if(!c.z)return Math.max(n,f);const g=c.z.length,R=Math.max(f,g);return Math.max(n,R)},0)+o}));r.getWorksheetColumnWidths=W;const w=(e,o)=>{let l;e.content.length>0?l=e.content.map(n=>(0,r.getJsonSheetRow)(n,e.columns)):l=e.columns.map(n=>({[n.label]:""}));const t=u.utils.json_to_sheet(l),s=m(t),i=e.columns.map(n=>{var a;return(a=n.format)!==null&&a!==void 0?a:null});return p(t,s,i),t["!cols"]=(0,r.getWorksheetColumnWidths)(t,o.extraLength),t},y=(e,o={})=>{var l,t,s,i,n;const a=!!o.RTL;(l=e.Workbook)!==null&&l!==void 0||(e.Workbook={}),(t=(n=e.Workbook).Views)!==null&&t!==void 0||(n.Views=[{}]),e.Workbook.Views.forEach(g=>{g.RTL=a});const c=`${(s=o.fileName)!==null&&s!==void 0?s:"Spreadsheet"}.xlsx`,f=(i=o.writeOptions)!==null&&i!==void 0?i:{};return o.writeMode==="write"?(0,u.write)(e,f):o.writeMode==="writeFile"?(0,u.writeFile)(e,c,f):f.type==="buffer"?(0,u.write)(e,f):(0,u.writeFile)(e,c,f)},x=(e,o={},l=()=>{})=>{if(e.length===0)return;const t=u.utils.book_new();return e.forEach((s,i)=>{var n;const a=w(s,o),c=(n=s.sheet)!==null&&n!==void 0?n:`Sheet ${i+1}`;u.utils.book_append_sheet(t,a,c)}),l(t),y(t,o)};r.xlsx=x,r.default=r.xlsx,r.libraryName="json-as-xlsx",h.exports=r.xlsx,h.exports.getContentProperty=r.getContentProperty,h.exports.getJsonSheetRow=r.getJsonSheetRow,h.exports.getWorksheetColumnWidths=r.getWorksheetColumnWidths,h.exports.utils=u.utils})(d,d.exports);var F=d.exports;const O=k(F);export{O as x};
