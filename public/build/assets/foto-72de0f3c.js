import{a as i,T as A,c as u,u as d,w as l,F as b,q as $,o as p,X as P,d as a,j as C,f as v,U as L,b as f,V as I,W as j,g}from"./app-784dffd1.js";import{A as D}from"./LayoutDocente-8584712b.js";import"./DropdownLink-b03dc279.js";import"./logotiny-c4b525af.js";import"./_plugin-vue_export-helper-c27b6911.js";var T={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M862 465.3h-81c-4.6 0-9 2-12.1 5.5L550 723.1V160c0-4.4-3.6-8-8-8h-60c-4.4 0-8 3.6-8 8v563.1L255.1 470.8c-3-3.5-7.4-5.5-12.1-5.5h-81c-6.8 0-10.5 8.1-6 13.2L487.9 861a31.96 31.96 0 0048.3 0L868 478.5c4.5-5.2.8-13.2-6-13.2z"}}]},name:"arrow-down",theme:"outlined"};const E=T;function m(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){H(o,s,t[s])})}return o}function H(o,e,t){return e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}var h=function(e,t){var r=m({},e,t.attrs);return i(A,m({},r,{icon:E}),null)};h.displayName="ArrowDownOutlined";h.inheritAttrs=!1;const k=h;var U={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M868 545.5L536.1 163a31.96 31.96 0 00-48.3 0L156 545.5a7.97 7.97 0 006 13.2h81c4.6 0 9-2 12.1-5.5L474 300.9V864c0 4.4 3.6 8 8 8h60c4.4 0 8-3.6 8-8V300.9l218.9 252.3c3 3.5 7.4 5.5 12.1 5.5h81c6.8 0 10.5-8 6-13.2z"}}]},name:"arrow-up",theme:"outlined"};const W=U;function M(o){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?Object(arguments[e]):{},r=Object.keys(t);typeof Object.getOwnPropertySymbols=="function"&&(r=r.concat(Object.getOwnPropertySymbols(t).filter(function(s){return Object.getOwnPropertyDescriptor(t,s).enumerable}))),r.forEach(function(s){B(o,s,t[s])})}return o}function B(o,e,t){return e in o?Object.defineProperty(o,e,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[e]=t,o}var c=function(e,t){var r=M({},e,t.attrs);return i(A,M({},r,{icon:W}),null)};c.displayName="ArrowUpOutlined";c.inheritAttrs=!1;const V=c,S={class:"flex",style:{padding:"20px"}},z={ref:"captureContainer",style:{position:"relative"}},N={ref:"videoElement",autoplay:""},F={key:1,class:"flex",style:{scale:"0.8","margin-top":"-100px","margin-right":"-60px","justify-content":"right"}},R={style:{"margin-right":"20px"}},q={style:{"margin-top":"32px"}},X={style:{"text-align":"center"}},G={style:{display:"flex",width:"140px","justify-content":"space-between"}},J={key:2,class:"flex justify-center",style:{"margin-top":"-50px"}},Q={key:0,style:{"margin-bottom":"-40px"}},Y=["src"],Z={key:0,class:"flex justify-between mt-3",style:{padding:"0px 20px"}},K={style:{width:"300px"}},x={data(){return{dni:null,capturedPhoto:null,cropAreaTop:0,cropAreaLeft:105,cropAreaWidth:430,cropAreaHeight:480,cargando:!1,vid:null,vidHeight:200,isMoving:!1,interval:null}},watch:{dni(o,e){this.dni.length===8&&this.capturePhoto()}},mounted(){this.initializeCamera()},beforeUnmount(){this.stopCamera()},methods:{startMoving(o){this.isMoving=!0,o=="I"?this.interval=setInterval(this.movIzq,10):o=="D"?this.interval=setInterval(this.movDer,10):o=="T"?this.interval=setInterval(this.movTop,10):o=="B"?this.interval=setInterval(this.movBot,10):o=="A"?this.interval=setInterval(this.aumentar,10):o=="R"&&(this.interval=setInterval(this.reducir,10))},stopMoving(){this.isMoving=!1,clearInterval(this.interval),this.interval=null},movIzq(){this.cropAreaLeft=this.cropAreaLeft-=2},movDer(){this.cropAreaLeft=this.cropAreaLeft+=2},movTop(){this.cropAreaTop=this.cropAreaTop-=2},movBot(){this.cropAreaTop=this.cropAreaTop+=2},aumentar(){this.cropAreaHeight<this.vidHeight?(this.cropAreaWidth+=2.15,this.cropAreaHeight+=2.4):(this.cropAreaHeight=this.vidHeight,this.cropAreaWidth=this.cropAreaWidth)},reducir(){this.cropAreaHeight<=240?(this.cropAreaWidth=this.cropAreaWidth,this.cropAreaHeight=this.cropAreaWidth):(this.cropAreaWidth-=4.3,this.cropAreaHeight-=4.8)},async initializeCamera(){try{const o={video:!0},e=await navigator.mediaDevices.getUserMedia(o);this.$refs.videoElement.srcObject=e,this.cargando=!0,this.$refs.videoElement.addEventListener("loadedmetadata",()=>{this.vidHeight=this.$refs.videoElement.videoHeight})}catch(o){console.error("Error al acceder a la cámara: ",o)}},stopCamera(){const o=this.$refs.videoElement.srcObject;o&&o.getTracks().forEach(e=>e.stop())},capturePhoto(){const o=this.$refs.videoElement,e=document.createElement("canvas"),t=e.getContext("2d"),r=this.$refs.cropArea,s=r.offsetWidth,n=r.offsetHeight,w=r.offsetLeft-o.offsetLeft,y=r.offsetTop-o.offsetTop;e.width=s,e.height=n,t.drawImage(o,w,y,s,n,0,0,s,n);const O=e.toDataURL();this.capturedPhoto=O,this.saveCroppedPhoto()},saveCroppedPhoto(){this.capturedPhoto&&$.post("guardar-foto-inscripcion",{dni:this.dni,photo:this.capturedPhoto}).then(o=>{console.log("Foto recortada guardada correctamente")}).catch(o=>{console.error("Error al guardar la foto recortada: ",o)})}}},ne=Object.assign(x,{__name:"foto",setup(o){return(e,t)=>{const r=g("a-button"),s=g("a-input");return p(),u(b,null,[i(d(P),{title:"Inscripciones-impresión"}),i(D,null,{default:l(()=>[a("div",S,[a("div",z,[a("video",N,null,512),e.cargando===!0?(p(),u("div",{key:0,ref:"cropArea",style:C(`position: absolute; top: ${e.cropAreaTop}px; left: ${e.cropAreaLeft}px; width: ${e.cropAreaWidth}px; height: ${e.cropAreaHeight}px; border: 1px solid red;`)},null,4)):v("",!0),e.cargando===!0?(p(),u("div",F,[a("div",R,[a("div",null,[i(r,{onMousedown:t[0]||(t[0]=n=>e.startMoving("A")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[1]||(t[1]=n=>e.aumentar())},{default:l(()=>[i(d(L))]),_:1},8,["onMouseleave","onMouseup"])]),a("div",q,[i(r,{onMousedown:t[2]||(t[2]=n=>e.startMoving("R")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[3]||(t[3]=n=>e.reducir())},{default:l(()=>[f(" --- ")]),_:1},8,["onMouseleave","onMouseup"])])]),a("div",X,[a("div",null,[i(r,{onMousedown:t[4]||(t[4]=n=>e.startMoving("T")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[5]||(t[5]=n=>e.movTop())},{default:l(()=>[i(d(V))]),_:1},8,["onMouseleave","onMouseup"])]),a("div",G,[i(r,{onMousedown:t[6]||(t[6]=n=>e.startMoving("I")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[7]||(t[7]=n=>e.movIzq())},{default:l(()=>[i(d(I))]),_:1},8,["onMouseleave","onMouseup"]),i(r,{onMousedown:t[8]||(t[8]=n=>e.startMoving("D")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[9]||(t[9]=n=>e.movDer())},{default:l(()=>[i(d(j))]),_:1},8,["onMouseleave","onMouseup"])]),a("div",null,[i(r,{onMousedown:t[10]||(t[10]=n=>e.startMoving("B")),onMouseleave:e.stopMoving,onMouseup:e.stopMoving,onClick:t[11]||(t[11]=n=>e.movBot())},{default:l(()=>[i(d(k))]),_:1},8,["onMouseleave","onMouseup"])])])])):v("",!0),e.cargando===!0?(p(),u("div",J,[i(r,{onClick:e.capturePhoto},{default:l(()=>[f("Capturar Foto")]),_:1},8,["onClick"])])):v("",!0)],512),e.capturedPhoto?(p(),u("div",Q,[a("img",{src:e.capturedPhoto,alt:"Foto Capturada"},null,8,Y)])):v("",!0)]),e.cargando===!0?(p(),u("div",Z,[a("div",K,[i(s,{value:e.dni,"onUpdate:value":t[12]||(t[12]=n=>e.dni=n),placeholder:"Ingrese DNI"},null,8,["value"])])])):v("",!0)]),_:1})],64)}}});export{ne as default};
