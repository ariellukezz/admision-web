import{r,e as V,i as Y,f as i,o as c,c as m,a as o,u as f,w as n,d as g,F as U,j as v,Z as ee,b as _,S as ae,k as te,g as C,D as oe,m as le,n as ne}from"./app-4f622de5.js";import{A as ie}from"./AuthenticatedLayout-afae6ab3.js";import{F as se}from"./FormOutlined-95993c13.js";import"./DropdownLink-9b5cd915.js";import"./_plugin-vue_export-helper-c27b6911.js";import"./logotiny-c4b525af.js";import"./TeamOutlined-cb061ef1.js";const re={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4"},de={class:"mr-3"},ue={class:"flex justify-between",style:{position:"relative"}},ce={class:"mr-2",style:{position:"absolute",left:"8px",top:"3px"}},ve={key:0,class:"flex",style:{"justify-content":"center"}},pe={key:0},me={key:1},Ve={__name:"filial",setup(fe){const b=r(""),P=r("PUNO"),u=r([]),d=r(!1),F=r([]),x=r([]),y=r(""),t=r({id:null,codigo:"",nombre:"",departamento:1,provincia:null,estado:!0}),O=()=>{d.value=!0};V(b,(a,e)=>{h()}),V(y,(a,e)=>{N()}),V(d,(a,e)=>{d.value==!1&&t.value.id!=null&&(t.value.id=null,t.value.codigo=null,t.value.nombre=null,t.value.estado=!0)});const B=(a,e)=>{t.value.departamento=e.key,I()},K={labelCol:{span:6},wrapperCol:{span:12}},q={nombre:[{required:!0,validator:async(a,e)=>e===""?Promise.reject("Ingrese su el nombre del filial"):Promise.resolve(),trigger:"change"}],codigo:[{required:!0,validator:async(a,e)=>e===""?Promise.reject("Ingrese la sede del filial"):Promise.resolve(),trigger:"change"}],departamento:[{required:!0,validator:async(a,e)=>e===""?Promise.reject("Seleccione un departamento"):Promise.resolve(),trigger:"change"}],provincia:[{required:!0,validator:async(a,e)=>e===""?Promise.reject("Seleccione una provincia"):Promise.resolve(),trigger:"change"}]};r([]);const z=a=>{d.value=!0,t.value.id=a.id,t.value.codigo=a.codigo,t.value.nombre=a.nombre,t.value.departamento=a.id_dep,A(),P.value=a.departamento,t.value.provincia=a.id_prov,a.estado==1?t.value.estado=!0:t.value.estado=!1},h=async(a="",e=1)=>{let s=await v.post("filiales/get-filiales?page="+e,{term:b.value});u.value=s.data.datos.data},N=async(a="",e=1)=>{let s=await v.post("get-departamentos?page="+e,{term:y.value});F.value=s.data.datos.data,t.value.departamento=F.value[0].key},I=async(a=1)=>{let e=await v.get("get-provincia-x-departamento/"+t.value.departamento);x.value=e.data.datos,t.value.provincia=e.data.datos[0].value},A=async(a=1)=>{let e=await v.get("get-provincia-x-departamento/"+t.value.departamento);x.value=e.data.datos},E=()=>{let a={id:t.value.id,codigo:t.value.codigo,nombre:t.value.nombre,id_dep:t.value.departamento,id_prov:t.value.provincia,estado:t.value.estado};v.post("save-filial",a).then(e=>{j("success",e.data.titulo,e.data.mensaje),h(),d.value=!1,t.value.id=null,t.value.codigo="",t.value.nombre="",t.value.departamento=1,t.estado=!0})},R=a=>{v.get("eliminar-filial/"+a.id).then(e=>{h(),j("warning","PROCESO ELIMINADO",e.data.mensaje)})},$=[{title:"Codigo",dataIndex:"codigo",sorter:!0},{title:"Nombre",dataIndex:"nombre",sorter:!0},{title:"Departamento",dataIndex:"departamento",sorter:!0},{title:"Provincia",dataIndex:"provincia"},{title:"Vigente",dataIndex:"estado",align:"center",width:"100px"},{title:"Acciones",dataIndex:"acciones"}],S=r([]),L=a=>{console.log("selectedRowKeys changed: ",a),S.value=a};Y(()=>({selectedRowKeys:f(S),onChange:L,hideDefaultSelections:!0}));const j=(a,e,s)=>{ne[a]({message:e,description:s})};return h(),N(),I(),(a,e)=>{const s=i("a-button"),w=i("a-input"),M=i("row"),D=i("a-tag"),T=i("a-divider"),X=i("a-table"),p=i("a-form-item"),G=i("a-auto-complete"),Z=i("a-select"),H=i("a-switch"),J=i("a-form"),Q=i("a-modal");return c(),m(U,null,[o(f(ee),{title:"Procesos"}),o(ie,null,{default:n(()=>[g("div",re,[o(M,{class:"flex justify-between mb-4"},{default:n(()=>[g("div",de,[o(s,{type:"primary",onClick:O},{default:n(()=>[_("Nuevo")]),_:1})]),g("div",ue,[o(w,{type:"text",placeholder:"Buscar",value:b.value,"onUpdate:value":e[0]||(e[0]=l=>b.value=l),style:{"max-width":"300px","padding-left":"30px"}},null,8,["value"]),g("div",ce,[o(f(ae))])])]),_:1}),(c(),te(X,{columns:$,"data-source":u.value,pagination:{pageSize:10},key:a.id,size:"small"},{bodyCell:n(({column:l,index:k})=>[l.dataIndex==="estado"?(c(),m("div",ve,[u.value[k].estado==1?(c(),m("div",pe,[o(D,{color:"green"},{default:n(()=>[_("Vigente")]),_:1})])):C("",!0),u.value[k].estado==0?(c(),m("div",me,[o(D,{color:"red"},{default:n(()=>[_("No Vigente")]),_:1})])):C("",!0)])):C("",!0),l.dataIndex==="acciones"?(c(),m(U,{key:1},[o(s,{type:"primary",onClick:W=>z(u.value[k]),size:"small"},{icon:n(()=>[o(f(se))]),_:2},1032,["onClick"]),o(T,{type:"vertical"}),o(s,{type:"danger",onClick:W=>R(u.value[k]),shape:"",size:"small"},{icon:n(()=>[o(f(oe))]),_:2},1032,["onClick"])],64)):C("",!0)]),_:1},8,["data-source"]))])]),_:1}),g("div",null,[o(Q,{visible:d.value,"onUpdate:visible":e[8]||(e[8]=l=>d.value=l),title:"Nueva Filial",style:{"margin-top":"-40px"}},{footer:n(()=>[o(s,{style:{"margin-left":"10px"},onClick:a.resetForm},{default:n(()=>[_("Cancelar")]),_:1},8,["onClick"]),o(s,{type:"primary",onClick:e[7]||(e[7]=l=>E())},{default:n(()=>[_("Guardar")]),_:1})]),default:n(()=>[o(J,le({ref:"formRef",name:"custom-validation",model:a.formState,rules:q},K,{onFinish:a.handleFinish,onValidate:a.handleValidate,onFinishFailed:a.handleFinishFailed}),{default:n(()=>[o(p,{"has-feedback":"",label:"Codigo",name:"codigo"},{default:n(()=>[o(w,{type:"text",value:t.value.codigo,"onUpdate:value":e[1]||(e[1]=l=>t.value.codigo=l),autocomplete:"off"},null,8,["value"])]),_:1}),o(p,{"has-feedback":"",label:"Nombre",name:"nombre"},{default:n(()=>[o(w,{type:"text",value:t.value.nombre,"onUpdate:value":e[2]||(e[2]=l=>t.value.nombre=l),autocomplete:"off"},null,8,["value"])]),_:1}),o(p,{"has-feedback":"",label:"Departamento",name:"departamento"},{default:n(()=>[o(G,{value:P.value,"onUpdate:value":e[4]||(e[4]=l=>P.value=l),options:F.value,style:{width:"300px"},onSelect:B},{default:n(()=>[o(w,{placeholder:"Buscar",value:y.value,"onUpdate:value":e[3]||(e[3]=l=>y.value=l),onKeypress:a.handleKeyPress},null,8,["value","onKeypress"])]),_:1},8,["value","options"])]),_:1}),o(p,{"has-feedback":"",label:"Provincia",name:"provincia"},{default:n(()=>[o(Z,{options:x.value,ref:"Tipo",style:{width:"100%"},onFocus:a.focus,onChange:a.handleChange,value:t.value.provincia,"onUpdate:value":e[5]||(e[5]=l=>t.value.provincia=l)},null,8,["options","onFocus","onChange","value"])]),_:1}),o(p,{"has-feedback":"",label:"Vigente",name:"estado"},{default:n(()=>[o(H,{checked:t.value.estado,"onUpdate:checked":e[6]||(e[6]=l=>t.value.estado=l)},null,8,["checked"])]),_:1})]),_:1},16,["model","onFinish","onValidate","onFinishFailed"])]),_:1},8,["visible"])])],64)}}};export{Ve as default};
