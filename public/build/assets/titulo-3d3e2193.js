import{a2 as K,r,J as Q,D as W,o as d,c,d as o,a as l,w as s,F as A,s as X,y as k,B as Y,M as Z,b as p,f as w,t as ee,E as I,u as oe,aL as L,l as te,m as se,j as le,k as ae,I as ne,aM as ie,q as re}from"./app-4116fa2f.js";import"./es-bd11f696.js";const de={class:"mt-0"},ue={class:"flex justify-between border-b-2",style:{"border-bottom":"solid 1px #d9d9d9","padding-bottom":"8px"}},pe={style:{"margin-top":"-5px"}},ce={class:"mt-3"},fe={class:"flex justify-between",style:{}},ve={class:""},me={key:0},_e={class:"flex",style:{"margin-top":"0px"}},ge={class:""},be={key:0,class:"mt-2"},we=["src"],he={key:0,class:"mt-2"},xe=["src"],ye={class:"flex justify-end"},ke={key:0,class:"mt-2"},Le=["src"],Fe={class:"flex justify-end"},Oe={__name:"titulo",props:["id_proceso","dni"],setup(M){const F=window.location.origin;K.locale("es");const _=M,E=()=>{f.value=!0},N=t=>{a.value={id:null,observacion:"",tipo:null,fileList:[]},a.id=t.id,a.observacion=t.observacion,u.value=F+"/"+t.url,a.tipo=t.id_tipo,f.value=!0},f=r(!1),C=r([]),S=r([{value:7,label:"TITULO PROFESIONAL"}]),g=r(!1),h=r(null),$=t=>{h.value=t,g.value=!0},D=r(),a=Q({id:null,observacion:"",tipo:7,fileList:[]}),V=t=>{console.log(`selected ${t}`)},z=async t=>{(await k.get("/eliminar-documentos-segundas/"+t)).data.estado==!0?x():console.log("Ocurrió un error")},v=r(!1),u=r(null),O=r(0),P=t=>{if(t.type!=="application/pdf")return L.error("¡Solo puedes cargar archivos PDF!"),!1;const e=new FileReader;return e.onload=i=>{u.value=i.target.result},e.readAsDataURL(t),a.fileList=[t],!1},x=async()=>{const t=await k.post("/get-documentos-segundas-postulante-titulos",{dni:_.dni,id_proceso:_.id_proceso});t.data.estado==!0?C.value=t.data.datos:console.log("No se encontraron datos")},U=()=>{u.value=null,a.fileList=[]},q=async()=>{await D.value.validateFields();const t=new FormData;a.fileList[0]&&t.append("file",a.fileList[0]),a.id!=null&&t.append("id",a.id),t.append("id_proceso",_.id_proceso),t.append("dni",_.dni),t.append("observacion",a.observacion),t.append("tipo",a.tipo);try{v.value=!0,O.value=0;const e=await k.post("/save-documentos-segundas",t,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer your-auth-token"},onUploadProgress:i=>{O.value=Math.round(i.loaded*100/i.total)}});f.value=!1,v.value=!1,L.success("¡Archivo PDF cargado exitosamente!"),await x()}catch(e){v.value=!1,L.error("Error al cargar el archivo."),console.error("File upload failed:",e)}};return x(),(t,e)=>{const i=Y,m=te,y=se,G=le,b=ae,H=ne,R=W("upload-outlined"),T=ie,J=re,B=Z;return d(),c(A,null,[o("div",de,[o("div",ue,[e[7]||(e[7]=o("div",null,[o("span",{style:{"font-weight":"bold","font-size":"1rem",color:"teal"}},"TITULO PROFESIONAL")],-1)),o("div",pe,[l(i,{onClick:e[0]||(e[0]=n=>E())},{default:s(()=>e[6]||(e[6]=[p("Agregar")])),_:1})])]),o("div",ce,[(d(!0),c(A,null,X(C.value,n=>(d(),c("div",{class:"mb-2",key:n},[l(y,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[o("div",fe,[o("div",ve,[n.id_tipo==7?(d(),c("div",me,e[8]||(e[8]=[o("span",{class:"font-bold",style:{"font-size":"1rem"}}," TITULO PROFESIONAL",-1)]))):w("",!0)]),o("div",_e,[l(i,{onClick:j=>$(n.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>e[9]||(e[9]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-eye"},[o("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),o("circle",{cx:"12",cy:"12",r:"3"})],-1)])),_:2},1032,["onClick"]),l(i,{onClick:j=>N(n),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>e[10]||(e[10]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1a2843","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit-2"},[o("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})],-1)])),_:2},1032,["onClick"]),l(i,{danger:"",onClick:j=>z(n.id),style:{width:"20px",height:"20px","padding-left":"3px"}},{default:s(()=>e[11]||(e[11]=[o("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trash"},[o("polyline",{points:"3 6 5 6 21 6"}),o("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1)])),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024)]))),128))])]),o("div",ge,[l(B,{visible:f.value,"onUpdate:visible":e[3]||(e[3]=n=>f.value=n),width:"800px",class:"w-full md:w-3/4",title:"Registro de título",onOk:t.handleOk},{footer:s(()=>[o("div",ye,[l(i,{type:"primary",disabled:!u.value,loading:v.value,style:{"margin-top":"16px"},onClick:q},{default:s(()=>[p(ee(v.value?"Subiendo...":"Guardar datos"),1)]),_:1},8,["disabled","loading"])])]),default:s(()=>[l(J,{ref_key:"formDatos",ref:D,name:"form",model:a,rules:t.formRules},{default:s(()=>[l(y,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[12]||(e[12]=o("label",null,[p("Tipo"),o("span",{style:{color:"red"}},"*")],-1)),l(b,{name:"tipo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[l(G,{ref:"select",value:a.tipo,"onUpdate:value":e[1]||(e[1]=n=>a.tipo=n),style:{width:"100%"},options:S.value,onFocus:t.focus,onChange:V},null,8,["value","options","onFocus"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[14]||(e[14]=o("label",null,[p("Observación"),o("span",{style:{color:"red"}})],-1)),l(b,{name:"observacion"},{default:s(()=>[l(H,{value:a.observacion,"onUpdate:value":e[2]||(e[2]=n=>a.observacion=n),style:{height:"32px"}},{suffix:s(()=>e[13]||(e[13]=[])),_:1},8,["value"])]),_:1})]),_:1}),l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[e[17]||(e[17]=o("label",null,[p("Archivo PDF (Max. 2mb)"),o("span",{style:{color:"red"}},"*")],-1)),a.id==null?(d(),I(b,{key:0,name:"fileList",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[l(T,{"file-list":a.fileList,accept:"application/pdf","before-upload":P,onRemove:U},{default:s(()=>[l(i,null,{default:s(()=>[l(R),e[15]||(e[15]=p(" Seleccionar archivo PDF "))]),_:1})]),_:1},8,["file-list"]),u.value?(d(),c("div",be,[o("iframe",{src:u.value,width:"100%",height:"300px"},null,8,we)])):w("",!0)]),_:1})):(d(),I(b,{key:1,name:"fileList"},{default:s(()=>[l(T,{"file-list":a.fileList,"before-upload":P,onRemove:U},{default:s(()=>[l(i,null,{default:s(()=>[l(R),e[16]||(e[16]=p(" Seleccionar archivo PDF "))]),_:1})]),_:1},8,["file-list"]),u.value?(d(),c("div",he,[o("iframe",{src:u.value,width:"100%",height:"300px"},null,8,xe)])):w("",!0)]),_:1}))]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk"]),l(B,{visible:g.value,"onUpdate:visible":e[5]||(e[5]=n=>g.value=n),title:"Registro de título",style:{"min-width":"1000px"}},{footer:s(()=>[o("div",Fe,[l(i,{onClick:e[4]||(e[4]=n=>g.value==!1)},{default:s(()=>e[18]||(e[18]=[p(" Aceptar ")])),_:1})])]),default:s(()=>[l(y,{gutter:16},{default:s(()=>[l(m,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[h.value?(d(),c("div",ke,[o("iframe",{src:oe(F)+"/"+h.value,width:"100%",height:"500px"},null,8,Le)])):w("",!0)]),_:1})]),_:1})]),_:1},8,["visible"])])],64)}}};export{Oe as default};
