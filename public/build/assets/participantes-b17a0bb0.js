import{r as i,e as q,o as l,c as p,a as d,u as B,d as r,v as R,w as n,F as Z,y as C,I as G,h as H,M as J,Z as K,b as w,t as j,f as h,E,a4 as O,B as L,_ as Q}from"./app-3d5418a6.js";/* empty css                                                                          */import{_ as W}from"./_plugin-vue_export-helper-c27b6911.js";import{r as X,u as Y}from"./xlsx-4f9172c7.js";import{S as $}from"./SearchOutlined-4a550355.js";import"./AntdIcon-29d1c834.js";const ee={class:"p-4",style:{width:"100%",background:"white","border-radius":"8px"}},te={class:"flex justify-between"},ae={key:0},oe={style:{"text-align":"right"}},se={style:{"margin-right":"-20px"}},re={key:0},ne={key:1,style:{scale:"0.8rem"}},ie={key:2},le={__name:"participantes",props:["proceso"],setup(U){const m=i(!1),k=U,x=i([]),_=i(0),V=i(""),f=i(""),A=async()=>{var t,e;_.value=0;try{const s=await C.post("subir-participantes-simulacro",{data:x.value,proceso:k.proceso},{onUploadProgress:o=>{o.lengthComputable&&(_.value=Math.round(o.loaded/o.total*100))}});_.value=100,O.success(s.data.message||"Participantes subidos correctamente"),m.value=!1,await g()}catch(s){_.value=70,V.value="exception",console.error("Error:",s);const o=((e=(t=s.response)==null?void 0:t.data)==null?void 0:e.error)||"Error al subir los participantes";O.error(o)}},M=t=>{const e=t.target.files[0],s=new FileReader;s.onload=o=>{const b=new Uint8Array(o.target.result),v=X(b,{type:"array"}),y=v.SheetNames[0],a=v.Sheets[y],c=Y.sheet_to_json(a,{header:1}),u=c[0],D=c.slice(1).map(F=>{const P={};return u.forEach((z,T)=>{P[z]=F[T]}),P});m.value=!0,x.value=D},s.readAsArrayBuffer(e)},I=i([]),g=async()=>{C.post("/get-participantes-externo",{term:f.value,proceso:k.proceso}).then(t=>{I.value=t.data.datos.data}).catch(t=>{t.response?console.error("Error de servidor:",t.response.data):t.request?console.error("Error de red:",t.request):console.error("Error de configuración:",t.message)})};let S;q(f,(t,e)=>{clearTimeout(S),S=setTimeout(()=>{g()},300)}),g();const N=i([{title:"N°",dataIndex:"nro",align:"center",width:50},{title:"DNI",dataIndex:"dni",width:90},{title:"Ap. Paterno",dataIndex:"paterno"},{title:"Ap. Materno",dataIndex:"materno"},{title:"Nombres",dataIndex:"nombres"},{title:"Cod puesto",dataIndex:"cod_puesto",width:90,align:"center"},{title:"Puesto",dataIndex:"puesto"},{title:"Unidad de organizacion",dataIndex:"unidad"}]);return(t,e)=>{const s=G,o=H,b=L,v=J,y=Q;return l(),p(Z,null,[d(B(K),{title:"Participantes"}),r("div",ee,[r("form",{onSubmit:e[1]||(e[1]=R((...a)=>t.submit&&t.submit(...a),["prevent"]))},[r("div",te,[e[3]||(e[3]=r("label",{for:"fileInput",class:"inline-block bg-[var(--primary-color)] border border-[var(--primary-color)] text-white font-medium px-4 py-1 rounded-md cursor-pointer transition-all duration-300 shadow-sm hover:bg-[#cdcdcd] hover:text-gray-700 hover:shadow-lg active:scale-95"}," Seleccionar archivo ",-1)),r("input",{id:"fileInput",type:"file",onChange:M,style:{display:"none"}},null,32),d(s,{type:"text",placeholder:"Buscar",value:f.value,"onUpdate:value":e[0]||(e[0]=a=>f.value=a),style:{"max-width":"230px"}},{prefix:n(()=>[d(B($))]),_:1},8,["value"])])],32),d(v,{open:m.value,"onUpdate:open":e[2]||(e[2]=a=>m.value=a),title:"Participantes del proceso",onOk:t.handleOk,width:"94%"},{footer:n(()=>[r("div",oe,[d(b,{style:{height:"38px","border-radius":"5px",border:"none",color:"white",background:"var(--primary-color)"},onClick:A},{default:n(()=>e[4]||(e[4]=[w(" Subir")])),_:1})])]),default:n(()=>[d(o,{dataSource:x.value,centerd:"",scroll:{y:"calc(100vh - 300px)"},columns:N.value,size:"small",pagination:!1},{bodyCell:n(({column:a,index:c,record:u})=>[a.dataIndex==="nro"?(l(),p("span",ae,j(c+1),1)):h("",!0)]),_:1},8,["dataSource","columns"])]),_:1},8,["open","onOk"]),e[7]||(e[7]=r("div",{class:"flex justify-end mt-2 mb-4",style:{"margin-right":"-20px"}},null,-1)),r("div",se,[d(o,{dataSource:I.value,columns:N.value,scroll:{y:"calc(100vh - 310px)"},size:"small",pagination:!1},{bodyCell:n(({column:a,index:c,record:u})=>[a.dataIndex==="nro"?(l(),p("span",re,j(c+1),1)):h("",!0),a.dataIndex==="id_ide"?(l(),p("div",ne,[u.id_ide==0?(l(),E(y,{key:0,color:"red",class:"small-text",style:{"border-radius":"14px"}},{default:n(()=>e[5]||(e[5]=[w(" sin ide ")])),_:1})):h("",!0),u.area==null?(l(),E(y,{key:1,color:"purple"},{default:n(()=>e[6]||(e[6]=[w(" sin area ")])),_:1})):(l(),p("span",ie))])):h("",!0)]),_:1},8,["dataSource","columns"])])])],64)}}},fe=W(le,[["__scopeId","data-v-6d529f1e"]]);export{fe as default};
