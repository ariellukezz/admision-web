import{r as p,C as ke,H as we,e as J,a2 as Ce,o as u,c as _,a as t,u as c,w as o,F as A,y as x,a5 as O,Z as Ie,d as n,b as i,t as d,f as h,E as k,s as q,a3 as w,aS as Oe,V as Ee,I as De,S as Se,j as Ne,B as Ae,_ as ze,L as Fe,K as Te,aQ as Ye,h as Me,i as Ue,k as $e,l as je,W as qe,p as Pe,m as Ve,q as Le,M as Be}from"./app-6dd2fb5e.js";import{_ as He}from"./AuthenticatedLayout-b9ac0019.js";import Re from"./tipo_observacion-b8051c21.js";import Ge from"./documentos_observacion-87ef6098.js";import{_ as Qe}from"./_plugin-vue_export-helper-c27b6911.js";import{I as We}from"./IdcardOutlined-7faae8d9.js";import{S as Je}from"./SearchOutlined-63ff9026.js";import{P as Ke}from"./PlusOutlined-159812f9.js";import{a as Ze,F as Xe}from"./FilePdfOutlined-608987e8.js";import{F as et}from"./FileTextOutlined-4e74f5f8.js";import{E as tt}from"./EyeOutlined-3ee94822.js";import{E as ot}from"./EditOutlined-9229ec09.js";import{D as at}from"./DeleteOutlined-116f711d.js";import{U as P}from"./UserOutlined-ab3658c5.js";import"./logotiny-c4b525af.js";import"./Header-ae457ec7.js";import"./AntdIcon-8fcb511c.js";import"./perfil-8483bf70.js";/* empty css                                                               */import"./SafetyCertificateOutlined-69c10da4.js";import"./DownOutlined-0336cddf.js";/* empty css                                                            */import"./DownloadOutlined-24b38dcd.js";import"./UploadOutlined-ebc8128a.js";const st={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4",style:{height:"calc(100vh - 98px)"}},nt={class:""},lt={class:"flex justify-between items-center gap-2"},it={class:"flex justify-between",style:{position:"relative"}},rt={class:"flex justify-between my-4"},ut={class:"flex justify-between gap-2 w-full"},dt={class:"flex gap-2"},pt={style:{}},ct={key:0,class:"flex flex-col"},mt={class:"font-semibold text-gray-800"},_t={class:"text-sm text-gray-500"},ft={key:1,class:"flex flex-col space-y-1"},vt={class:"flex items-center gap-1"},gt={class:"font-medium"},bt={key:0,class:"flex items-center gap-1"},yt={class:"font-medium"},xt={key:1,class:"text-xs text-gray-400"},ht={key:0,class:"flex items-center gap-2"},kt={class:"text-blue-600 hover:text-blue-800 cursor-pointer text-sm underline"},wt={key:1,class:"text-gray-400 text-sm"},Ct={class:"flex justify-end mt-4"},It={class:"flex justify-center"},Ot={class:"flex justify-end mt-4"},Et={__name:"index",setup(Dt){const V=p([]),L=p([]),E=p(""),y=p(1),z=p(10),T=p(0),B=p([]),D=p("vigente"),S=p(null),Y=p([]),M=p(!1),U=p(!1),l=ke({id:null,dni:"",nombres:"",paterno:"",materno:"",tipo_id:null,concepto_id:null,documento_id:null,fecha_sancion:"",fecha_fin_sancion:"",observaciones:""}),C=p(!1),K={dni:[{required:!0,message:"El DNI es obligatorio"}],nombres:[{required:!0,message:"Los nombres son obligatorios"}],paterno:[{required:!0,message:"El apellido paterno es obligatorio"}],tipo_id:[{required:!0,message:"El tipo es obligatorio"}],fecha_sancion:[{required:!0,message:"La fecha de sanción es obligatoria"}]},Z=[{title:"ID",dataIndex:"id",key:"id",width:70,align:"center"},{title:"DATOS PERSONALES",key:"datos_personales",width:250,ellipsis:!0},{title:"FECHAS",key:"fechas",width:150,align:"center"},{title:"TIPO",key:"tipo_observacion",width:200,ellipsis:!0},{title:"CATEGORÍA",key:"categoria",width:180,ellipsis:!0},{title:"DOCUMENTO",key:"documento",width:150,ellipsis:!0},{title:"ESTADO",key:"estado",width:120,align:"center"},{title:"ACCIONES",key:"acciones",width:100,align:"center",fixed:"right"}],X=we(()=>({current:y.value,pageSize:z.value,total:T.value,showSizeChanger:!0,showQuickJumper:!0,showTotal:(a,e)=>`${e[0]}-${e[1]} de ${a} observados`}));J([E,D,S],()=>{y.value=1,g()}),J(y,()=>{g()});const ee=()=>{H(),C.value=!0},H=()=>{Object.assign(l,{id:null,dni:"",nombres:"",paterno:"",materno:"",tipo_id:null,concepto_id:null,documento_id:null,fecha_sancion:"",fecha_fin_sancion:"",observaciones:""})},g=async()=>{M.value=!0;try{let a=`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/all?page=${y.value}&limit=${z.value}`;E.value&&(a+=`&search=${E.value}`),D.value!=="todos"&&(a+=`&vigencia=${D.value}`),S.value&&(a+=`&tipo=${S.value}`);const e=await x.get(a);Y.value=e.data.data||[],T.value=e.data.count||Y.value.length}catch(a){console.error("Error al cargar observados:",a),O.error("Error al cargar los observados")}finally{M.value=!1}},te=async()=>{try{const a=await x.get("https://servicios-admision.unap.edu.pe/api/v1/observados/tipos-select");B.value=a.data.data}catch(a){console.error("Error al cargar tipos:",a)}},oe=async()=>{try{const a=await x.get("https://servicios-admision.unap.edu.pe/api/v1/observados/conceptos-select");L.value=a.data.data}catch(a){console.error("Error al cargar conceptos:",a)}},ae=async()=>{try{const a=await x.get("https://servicios-admision.unap.edu.pe/api/v1/observados/documentos-select");V.value=a.data.data}catch(a){console.error("Error al cargar documentos:",a)}},R=a=>a?w(a).format("DD/MM/YYYY"):"-",se=a=>{const e={"SUPLANTACIÓN DE IDENTIDAD":"red",FALSIFICACIÓN:"volcano",OMISIÓN:"orange",default:"blue"};return e[a]||e.default},ne=a=>{const e={"INHABILITACION INDEFINIDA":"red","INHABILITACION TEMPORAL":"orange","SANCIÓN ECONÓMICA":"purple",default:"green"};return e[a]||e.default},le=a=>{const e=w(),v=a.fecha_fin?w(a.fecha_fin):null;return v?v.isAfter(e)?"green":"red":"blue"},ie=a=>{const e=w(),v=a.fecha_fin?w(a.fecha_fin):null;return!v||v.isAfter(e)?"Vigente":"Expirado"},re=a=>{console.log("Ver detalles:",a)},ue=a=>{Object.assign(l,{id:a.id,dni:a.dni,nombres:a.nombres,paterno:a.paterno,materno:a.materno,tipo_id:a.tipo_id,concepto_id:a.concepto_id,documento_id:a.documento_id,fecha_sancion:a.fecha_sancion,fecha_fin_sancion:a.fecha_fin,observaciones:a.observaciones}),C.value=!0},de=async a=>{try{await x.delete(`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/${a}`),O.success("Observado eliminado correctamente"),g()}catch(e){console.error("Error al eliminar:",e),O.error("Error al eliminar el observado")}},pe=async()=>{try{U.value=!0;const a={...l,fecha_sancion:l.fecha_sancion?w(l.fecha_sancion).format("YYYY-MM-DD"):null,fecha_fin_sancion:l.fecha_fin_sancion?w(l.fecha_fin_sancion).format("YYYY-MM-DD"):null};l.id?(await x.put(`https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones/${l.id}`,a,{headers:{"Content-Type":"application/json"}}),O.success("Observado actualizado correctamente")):(await x.post("https://servicios-admision.unap.edu.pe/api/v1/observados/observaciones",a,{headers:{"Content-Type":"application/json"}}),O.success("Observado creado correctamente")),g(),C.value=!1,H()}catch(a){console.error("Error:",a),O.error("Error al guardar el observado")}finally{U.value=!1}},ce=(a,e)=>{y.value=a,e.value=e},me=(a,e)=>{z.value=e};return Ce(()=>{g(),te(),oe(),ae()}),(a,e)=>{const v=Oe,_e=Ee,N=De,I=Se,F=Ne,b=Ae,$=ze,j=Fe,fe=Te,ve=Ye,ge=Me,be=Ue,f=$e,m=je,G=qe,ye=Pe,Q=Ve,xe=Le,he=Be;return u(),_(A,null,[t(c(Ie),{title:"Observados"}),t(He,null,{default:o(()=>[n("div",st,[n("div",nt,[e[21]||(e[21]=n("div",{class:"mb-4"},[n("span",{class:"text-xl font-bold text-gray-800"},"Gestión de Observados")],-1)),n("div",lt,[n("div",null,[t(_e,{value:D.value,"onUpdate:value":e[0]||(e[0]=s=>D.value=s),onChange:g},{default:o(()=>[t(v,{value:"vigente"},{default:o(()=>e[18]||(e[18]=[i("Vigente")])),_:1}),t(v,{value:"no-vigente"},{default:o(()=>e[19]||(e[19]=[i("No vigente")])),_:1}),t(v,{value:"todos"},{default:o(()=>e[20]||(e[20]=[i("Todos")])),_:1})]),_:1},8,["value"])]),n("div",it,[t(N,{type:"text",placeholder:"Buscar por DNI o nombres...",value:E.value,"onUpdate:value":e[1]||(e[1]=s=>E.value=s),style:{"max-width":"460px"},onChange:g},{prefix:o(()=>[t(c(Je))]),_:1},8,["value"])])])]),n("div",rt,[n("div",ut,[n("div",null,[t(F,{value:S.value,"onUpdate:value":e[2]||(e[2]=s=>S.value=s),style:{"min-width":"232px"},placeholder:"Filtrar por tipo",onChange:g,"allow-clear":""},{default:o(()=>[t(I,{value:"indefinida"},{default:o(()=>e[22]||(e[22]=[i("Inhabilitación indefinida")])),_:1}),t(I,{value:"temporal"},{default:o(()=>e[23]||(e[23]=[i("Inhabilitación temporal")])),_:1}),t(I,{value:"economica"},{default:o(()=>e[24]||(e[24]=[i("Sanción económica")])),_:1})]),_:1},8,["value"])]),n("div",dt,[n("div",null,[t(Ge)]),n("div",null,[t(Re)]),t(b,{onClick:e[3]||(e[3]=s=>ee()),type:"primary",class:"bg-blue-600 hover:bg-blue-700 text-white flex items-center gap-2"},{default:o(()=>[t(c(Ke)),e[25]||(e[25]=i(" Nuevo Observado "))]),_:1}),t(b,{type:"primary",class:"bg-red-600 hover:bg-red-700 text-white flex items-center gap-2"},{default:o(()=>[t(c(Ze)),e[26]||(e[26]=i(" PDF "))]),_:1}),t(b,{type:"primary",class:"bg-green-600 hover:bg-green-700 text-white flex items-center gap-2"},{default:o(()=>[t(c(Xe)),e[27]||(e[27]=i(" Excel "))]),_:1})])])]),n("div",pt,[t(ge,{columns:Z,"data-source":Y.value,loading:M.value,pagination:X.value,size:"middle",scroll:{x:1200,y:"calc(100vh - 280px)"},class:"observados-table"},{bodyCell:o(({column:s,record:r})=>[s.key==="datos_personales"?(u(),_("div",ct,[n("div",mt,d(r.nombres)+" "+d(r.paterno)+" "+d(r.materno),1),n("div",_t," DNI: "+d(r.dni),1)])):h("",!0),s.key==="fechas"?(u(),_("div",ft,[n("div",vt,[e[28]||(e[28]=n("span",{class:"text-xs text-gray-500"},"Inicio:",-1)),n("span",gt,d(R(r.fecha_sancion)),1)]),r.fecha_fin?(u(),_("div",bt,[e[29]||(e[29]=n("span",{class:"text-xs text-gray-500"},"Fin:",-1)),n("span",yt,d(R(r.fecha_fin)),1)])):(u(),_("div",xt," Sin fecha fin "))])):h("",!0),s.key==="tipo_observacion"?(u(),k($,{key:2,color:se(r.tipo_observacion),class:"font-semibold px-2 py-1 text-xs"},{default:o(()=>[i(d(r.tipo_observacion),1)]),_:2},1032,["color"])):h("",!0),s.key==="categoria"?(u(),k($,{key:3,color:ne(r.categoria),class:"font-semibold px-2 py-1 text-xs"},{default:o(()=>[i(d(r.categoria),1)]),_:2},1032,["color"])):h("",!0),s.key==="documento"?(u(),_(A,{key:4},[r.documento?(u(),_("div",ht,[t(c(et),{class:"text-blue-500"}),n("span",kt,d(r.documento),1)])):(u(),_("span",wt,"Sin documento"))],64)):h("",!0),s.key==="estado"?(u(),k($,{key:5,color:le(r),class:"font-semibold"},{default:o(()=>[i(d(ie(r)),1)]),_:2},1032,["color"])):h("",!0),s.key==="acciones"?(u(),k(ve,{key:6,size:"small"},{default:o(()=>[t(j,{title:"Ver detalles"},{default:o(()=>[t(b,{type:"link",size:"small",onClick:W=>re(r),class:"text-blue-600 p-0"},{default:o(()=>[t(c(tt))]),_:2},1032,["onClick"])]),_:2},1024),t(j,{title:"Editar"},{default:o(()=>[t(b,{type:"link",size:"small",onClick:W=>ue(r),class:"text-green-600 p-0"},{default:o(()=>[t(c(ot))]),_:2},1032,["onClick"])]),_:2},1024),t(j,{title:"Eliminar"},{default:o(()=>[t(fe,{title:"¿Estás seguro de eliminar este observado?",onConfirm:W=>de(r.id)},{default:o(()=>[t(b,{type:"link",danger:"",size:"small",class:"p-0"},{default:o(()=>[t(c(at))]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)]),_:2},1024)):h("",!0)]),_:1},8,["data-source","loading","pagination"])]),n("div",Ct,[t(be,{current:y.value,"onUpdate:current":e[4]||(e[4]=s=>y.value=s),"page-size":z.value,total:T.value,"show-size-changer":"",onChange:ce,onShowSizeChange:me},null,8,["current","page-size","total"])])]),t(he,{open:C.value,"onUpdate:open":e[17]||(e[17]=s=>C.value=s),title:l.id?"Editar Observado":"Nuevo Observado",footer:!1,width:"90%",styles:{maxWidth:"900px"},centered:""},{default:o(()=>[n("div",It,[t(Q,{style:{display:"flex","justify-content":"center"}},{default:o(()=>[t(m,{span:24},{default:o(()=>[t(xe,{ref:"formDatos",name:"form",model:l,rules:K},{default:o(()=>[t(Q,{gutter:16,class:"mt-3"},{default:o(()=>[t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[30]||(e[30]=n("label",null,[i("DNI "),n("span",{style:{color:"red"}},"*")],-1)),t(f,{name:"dni",rules:[{required:!0,message:"Ingrese el DNI"}]},{default:o(()=>[t(N,{value:l.dni,"onUpdate:value":e[5]||(e[5]=s=>l.dni=s),placeholder:"Número de DNI",maxlength:8,size:"large"},{prefix:o(()=>[t(c(We))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[31]||(e[31]=n("label",null,[i("Nombres "),n("span",{style:{color:"red"}},"*")],-1)),t(f,{name:"nombres",rules:[{required:!0,message:"Ingrese los nombres"}]},{default:o(()=>[t(N,{value:l.nombres,"onUpdate:value":e[6]||(e[6]=s=>l.nombres=s),placeholder:"Nombres completos",size:"large"},{prefix:o(()=>[t(c(P))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[32]||(e[32]=n("label",null,[i("Apellido Paterno "),n("span",{style:{color:"red"}},"*")],-1)),t(f,{name:"paterno",rules:[{required:!0,message:"Ingrese apellido paterno"}]},{default:o(()=>[t(N,{value:l.paterno,"onUpdate:value":e[7]||(e[7]=s=>l.paterno=s),placeholder:"Apellido paterno",size:"large"},{prefix:o(()=>[t(c(P))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[33]||(e[33]=n("label",null,"Apellido Materno",-1)),t(f,{name:"materno"},{default:o(()=>[t(N,{value:l.materno,"onUpdate:value":e[8]||(e[8]=s=>l.materno=s),placeholder:"Apellido materno",size:"large"},{prefix:o(()=>[t(c(P))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[34]||(e[34]=n("label",null,[i("Tipo "),n("span",{style:{color:"red"}},"*")],-1)),t(f,{name:"tipo_id",rules:[{required:!0,message:"Seleccione el tipo"}]},{default:o(()=>[t(F,{value:l.tipo_id,"onUpdate:value":e[9]||(e[9]=s=>l.tipo_id=s),placeholder:"Seleccione tipo",style:{width:"100%"},size:"large"},{default:o(()=>[(u(!0),_(A,null,q(B.value,s=>(u(),k(I,{key:s.value,value:s.value},{default:o(()=>[i(d(s.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[35]||(e[35]=n("label",null,"Concepto",-1)),t(f,{name:"concepto_id"},{default:o(()=>[t(F,{value:l.concepto_id,"onUpdate:value":e[10]||(e[10]=s=>l.concepto_id=s),placeholder:"Seleccione concepto",style:{width:"100%"},size:"large"},{default:o(()=>[(u(!0),_(A,null,q(L.value,s=>(u(),k(I,{key:s.id,value:s.id},{default:o(()=>[i(d(s.nombre),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:8},{default:o(()=>[e[36]||(e[36]=n("label",null,"Documento",-1)),t(f,{name:"documento_id"},{default:o(()=>[t(F,{value:l.documento_id,"onUpdate:value":e[11]||(e[11]=s=>l.documento_id=s),placeholder:"Seleccione documento",style:{width:"100%"},size:"large"},{default:o(()=>[(u(!0),_(A,null,q(V.value,s=>(u(),k(I,{key:s.value,value:s.value},{default:o(()=>[i(d(s.label),1)]),_:2},1032,["value"]))),128))]),_:1},8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:12},{default:o(()=>[e[37]||(e[37]=n("label",null,[i("Fecha Sanción "),n("span",{style:{color:"red"}},"*")],-1)),t(f,{name:"fecha_sancion",rules:[{required:!0,message:"Seleccione fecha de sanción"}]},{default:o(()=>[t(G,{value:l.fecha_sancion,"onUpdate:value":e[12]||(e[12]=s=>l.fecha_sancion=s),style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Seleccione fecha",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:12,md:12},{default:o(()=>[e[38]||(e[38]=n("label",null,"Fecha Fin Sanción",-1)),t(f,{name:"fecha_fin_sancion"},{default:o(()=>[t(G,{value:l.fecha_fin_sancion,"onUpdate:value":e[13]||(e[13]=s=>l.fecha_fin_sancion=s),style:{width:"100%"},format:"DD/MM/YYYY",placeholder:"Seleccione fecha fin",size:"large"},null,8,["value"])]),_:1})]),_:1}),t(m,{xs:24,sm:24,md:24},{default:o(()=>[e[39]||(e[39]=n("label",null,"Observaciones",-1)),t(f,{name:"observaciones"},{default:o(()=>[t(ye,{value:l.observaciones,"onUpdate:value":e[14]||(e[14]=s=>l.observaciones=s),placeholder:"Ingrese observaciones",rows:3,size:"large"},null,8,["value"])]),_:1})]),_:1})]),_:1}),n("div",Ot,[n("div",null,[t(b,{type:"primary",class:"mr-2",onClick:e[15]||(e[15]=s=>C.value=!1),style:{"border-radius":"6px",background:"none",color:"#476175",border:"1px solid #476175"},size:"large"},{default:o(()=>e[40]||(e[40]=[i(" Cancelar ")])),_:1}),t(b,{type:"primary",onClick:e[16]||(e[16]=s=>pe()),style:{"border-radius":"6px",background:"#476175",border:"none"},loading:U.value,size:"large"},{default:o(()=>[i(d(l.id?"Actualizar":"Guardar"),1)]),_:1},8,["loading"])])])]),_:1},8,["model"])]),_:1})]),_:1})])]),_:1},8,["open","title"])]),_:1})],64)}}},Xt=Qe(Et,[["__scopeId","data-v-f5f31129"]]);export{Xt as default};
