import{r as d,a1 as B,y as v,C as b,o as l,c as u,a as s,u as L,w as o,F as p,Z as O,d as f,b as i,t as m,s as A,E as H,B as U,a7 as $,a8 as j,a9 as F,h as M}from"./app-fa6a337d.js";import{_ as V}from"./AuthenticatedLayout-ea884a30.js";import"./logotiny-c4b525af.js";import"./Header-8e4d3aab.js";import"./AntdIcon-e8fd5b51.js";import"./DownOutlined-6befbc7a.js";/* empty css                                                            */const z={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4 pb-0",style:{height:"calc(100vh - 103px)"}},G={class:"flex justify-end mb-3 mr-3"},K={style:{"font-size":"0.7rem"}},P={key:3,style:{"text-align":"center"}},te={__name:"programaDiario",setup(Y){const h=d([]),_=d([]),y=d([{total_inscripciones:0}]),x=d(!1),w=d(null),k=d(0);B(async()=>{try{x.value=!0;const e=await v.post("reporte-programa-diario");h.value=e.data.datos||[],_.value=e.data.fechas||[],y.value=e.data.totales||[{total_inscripciones:0}]}catch(e){w.value=e,console.error("Error al cargar datos:",e)}finally{x.value=!1}});const S=b(()=>{const e={};return _.value.forEach(t=>{const a=t.substring(0,7);e[a]||(e[a]={monthName:new Date(t).toLocaleString("es-ES",{month:"long"}).toUpperCase(),dates:[]}),e[a].dates.push(t)}),e}),C=b(()=>{const e=[{title:"COD",dataIndex:"codigo",key:"codigo",width:20,align:"center",fixed:"left",customHeaderCell:()=>({style:{background:"#c9c9c9"}})},{title:"PROGRAMA DE ESTUDIOS",dataIndex:"programa",key:"programa",width:300,fixed:"left",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}];return Object.values(S.value).forEach(t=>{e.push({title:t.monthName,key:t.monthName,align:"center",children:t.dates.map(a=>({title:a.split("-")[2],dataIndex:`ins_${a}`,key:`ins_${a}`,width:30,customHeaderCell:()=>({style:{background:"#e3e3e3",textAlign:"center",height:"40px",width:"40px",padding:"0 0px"}})})),customHeaderCell:()=>({style:{background:"#e3e3e3"}})})}),e.push({title:"TOTAL",dataIndex:"inscripciones",key:"inscripciones",width:40,align:"center",fixed:"right",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}),e}),D=(e,t)=>t<k.value?"fila-amarilla":"",E=b(()=>{var e;return((e=y.value[0])==null?void 0:e.total_inscripciones)||0}),I=e=>{var t;return((t=y.value[0])==null?void 0:t[`ins_${e}`])||0},T=async()=>{try{const e=await v.post("reporte-programa-diario",{descargar:1},{responseType:"blob"}),t=new Date,a=[t.getFullYear(),String(t.getMonth()+1).padStart(2,"0"),String(t.getDate()).padStart(2,"0"),String(t.getHours()).padStart(2,"0"),String(t.getMinutes()).padStart(2,"0"),String(t.getSeconds()).padStart(2,"0")].join("-"),c=window.URL.createObjectURL(new Blob([e.data])),n=document.createElement("a");n.href=c,n.setAttribute("download",`${a}_resumen_inscripciones.pdf`),document.body.appendChild(n),n.click(),n.remove(),window.URL.revokeObjectURL(c)}catch(e){console.error("Error al descargar:",e),notification.error({message:"Error",description:"No se pudo descargar el archivo"})}};return(e,t)=>{const a=U,c=$,n=j,N=F,R=M;return l(),u(p,null,[s(L(O),{title:"Resumen programa diario"}),s(V,null,{default:o(()=>[f("div",z,[f("div",G,[s(a,{type:"primary",style:{"border-radius":"5px",background:"#476175",border:"none"},onClick:t[0]||(t[0]=r=>T())},{default:o(()=>t[1]||(t[1]=[i(" Descargar ")])),_:1})]),f("div",K,[s(R,{columns:C.value,"data-source":h.value,pagination:!1,size:"small",rowClassName:D,scroll:{x:200,y:"calc(100vh - 270px)"}},{bodyCell:o(({column:r,record:g})=>[r.dataIndex==="programa"?(l(),u(p,{key:0},[i(m(g.programa),1)],64)):r.dataIndex==="codigo"?(l(),u(p,{key:1},[i(m(g.codigo),1)],64)):r.dataIndex==="inscripciones"?(l(),u(p,{key:2},[i(m(g.inscripciones),1)],64)):(l(),u("div",P,m(g[r.dataIndex]),1))]),summary:o(()=>[s(N,{fixed:"bottom"},{default:o(()=>[s(n,null,{default:o(()=>[s(c,{"col-span":2,style:{"text-align":"right","font-weight":"bold"}},{default:o(()=>t[2]||(t[2]=[i(" Totales: ")])),_:1}),(l(!0),u(p,null,A(_.value,r=>(l(),H(c,{key:r,style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(m(I(r)),1)]),_:2},1024))),128)),s(c,{style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(m(E.value),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data-source"])])])]),_:1})],64)}}};export{te as default};
