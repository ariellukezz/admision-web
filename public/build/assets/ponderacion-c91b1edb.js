import{r as l,e as y,J as de,D as pe,o as f,c as x,a,u as w,w as t,d as s,F as J,y as S,M as ce,Z as me,b as i,E as _e,t as K,f as Z,G as ve,s as fe,B as ge,I as be,K as ye,H as xe,h as we,i as ke,S as Ce,j as Ie,k as Ee,q as Se,l as Ue,m as Ve,n as ze}from"./app-553d6252.js";import{L as he}from"./LayoutCalificador-98ce88bc.js";import{_ as Fe}from"./_plugin-vue_export-helper-c27b6911.js";import{S as Pe}from"./SearchOutlined-4e1d91f4.js";import{E as Ne}from"./EyeOutlined-82641a08.js";import{F as je}from"./FormOutlined-245019a7.js";import{D as De}from"./DeleteOutlined-5d5a079b.js";import"./DropdownLink-ca727573.js";import"./logotiny-c4b525af.js";/* empty css                                                                          */import"./TopMenu-42dc771f.js";import"./DownOutlined-69c1943f.js";import"./AntdIcon-80ee18ce.js";const Be={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4",style:{"border-radius":"10px",width:"100%","min-height":"calc(100vh - 95px)"}},Re={class:"flex justify-between mb-2"},Ae={class:"mr-3"},Oe={class:"flex justify-between",style:{position:"relative"}},Te={key:0,class:"flex",style:{"justify-content":"center"}},qe={style:{"font-weight":"bold"}},Ge={key:1,class:"acciones-container"},Le={class:"btn-icon-wrapper"},Me={class:"btn-icon-wrapper"},$e={class:"btn-icon-wrapper"},He={class:"flex justify-between mt-2 pr-4",style:{"margin-bottom":"-5px"}},Je={clas:"",style:{scale:"0.9","margin-right":"-20px"}},Ke={class:"mt-6"},Ze={class:"flex justify-between w-full items-center mt-2"},Qe={class:"flex gap-2"},We={__name:"ponderacion",setup(Xe){const h=l(!1),k=l(""),_=l(!1),Q=l(""),C=l(1),v=l(10),F=l(1),W=()=>{_.value=!0};let P;y(k,(o,e)=>{clearTimeout(P),P=setTimeout(()=>{getFiliales()},500)}),y(C,(o,e)=>{getFiliales()}),y(v,(o,e)=>{getFiliales()});let N;y(Q,(o,e)=>{clearTimeout(N),N=setTimeout(()=>{getUbigeosResidencia()},500)});const j=()=>{filial.id=null,filial.codigo="",filial.nombre="",filial.lugar=null,filial.direccion="",filial.estado="",residencia.value="",redseleccionado.value="",X()},D=(o,e,u)=>{ze[o]({message:e,description:u})},X=()=>{_.value=!1},B=l([]),U=async()=>{let o=await S.post("get-ponderaciones?page="+C.value,{term:k.value,paginasize:v.value});B.value=o.data.datos.data,F.value=o.data.datos.total},R=l(),c=de({id:null,nombre:"",area:null,simulacro:""}),A=l("");l(null);const Y=l([]),V=l(!1),O=async()=>{S.post("/get-simulacros",{term:A.value}).then(o=>{Y.value=o.data.datos.data}).catch(o=>{o.response?console.error("Error de servidor:",o.response.data):o.request?console.error("Error de red:",o.request):console.error("Error de configuración:",o.message)})};let T;y(A,(o,e)=>{clearTimeout(T),T=setTimeout(()=>{O()},500)});const ee=async()=>{h.value=!0;try{const o=await R.value.validateFields();S.post("save-ponderacion",c).then(e=>{D("success",e.data.titulo,e.data.mensaje),U(),_.value=!1})}catch(o){console.error(o)}},ae=async()=>{h.value=!0;try{S.post("save-ponderacion-detalle",{pesos:d.value,id_ponderacion:q.value}).then(o=>{D("success",o.data.titulo,o.data.mensaje),U(),_.value=!1})}catch(o){console.error(o)}};O(),U();const q=l(null),G=l(1),d=l([{nombre:null,ponderacion:null,n_preguntas:null}]),te=o=>{V.value=!0,q.value=o},oe=()=>{d.value.push({nombre:null,ponderacion:null,n_preguntas:null}),G.value+=1},ne={labelCol:{span:4},wrapperCol:{span:20}},le=[{title:"N°",dataIndex:"nro"},{title:"Nombre",dataIndex:"nombre"},{title:"Area",dataIndex:"area"},{title:"Acciones",dataIndex:"acciones",align:"center",width:"96px"}];return(o,e)=>{const u=ge,g=be,z=ye,se=xe,ie=we,re=ke,m=Ce,L=Ie,I=pe("sin-icono"),b=Ee,M=Se,$=ce,E=Ue,ue=Ve;return f(),x(J,null,[a(w(me),{title:"Ponderacion"}),a(he,null,{default:t(()=>[s("div",Be,[s("div",Re,[s("div",Ae,[a(u,{type:"primary",onClick:W,style:{background:"#476175",border:"none","border-radius":"5px"}},{default:t(()=>e[9]||(e[9]=[i("Nuevo")])),_:1})]),s("div",Oe,[a(g,{type:"text",placeholder:"Buscar",value:k.value,"onUpdate:value":e[0]||(e[0]=n=>k.value=n),style:{"max-width":"300px","border-radius":"6px","padding-left":"10px"}},{prefix:t(()=>[a(w(Pe))]),_:1},8,["value"])])]),(f(),_e(ie,{columns:le,"data-source":B.value,key:o.id,size:"small",pagination:!1,style:{scale:".7rem"}},{bodyCell:t(({column:n,index:r,record:p})=>[n.dataIndex==="nro"?(f(),x("div",Te,[s("span",qe,K(r+1),1)])):Z("",!0),n.dataIndex==="acciones"?(f(),x("div",Ge,[a(z,{title:"Ver detalles",placement:"top"},{default:t(()=>[a(u,{class:"accion-btn ver-btn",onClick:H=>te(p),size:"small",type:"text"},{icon:t(()=>[s("div",Le,[a(w(Ne),{class:"btn-icon"})])]),_:2},1032,["onClick"])]),_:2},1024),a(z,{title:"Editar",placement:"top"},{default:t(()=>[a(u,{class:"accion-btn editar-btn",onClick:H=>o.abrirEditarPonderacion(p),size:"small",type:"text"},{icon:t(()=>[s("div",Me,[a(w(je),{class:"btn-icon"})])]),_:2},1032,["onClick"])]),_:2},1024),a(z,{title:"Eliminar",placement:"top"},{default:t(()=>[a(se,{title:"¿Estás seguro de eliminar esta ponderación?","ok-text":"Sí, eliminar","cancel-text":"Cancelar",onConfirm:H=>o.eliminarPonderacion(p)},{default:t(()=>[a(u,{class:"accion-btn eliminar-btn",size:"small",type:"text"},{icon:t(()=>[s("div",$e,[a(w(De),{class:"btn-icon"})])]),_:1})]),_:2},1032,["onConfirm"])]),_:2},1024)])):Z("",!0)]),_:1},8,["data-source"])),s("div",He,[s("div",null,[a(re,{current:C.value,"onUpdate:current":e[1]||(e[1]=n=>C.value=n),simple:"",total:F.value,pageSize:v.value,"onUpdate:pageSize":e[2]||(e[2]=n=>v.value=n),"show-less-items":""},null,8,["current","total","pageSize"])]),s("div",Je,[a(L,{value:v.value,"onUpdate:value":e[3]||(e[3]=n=>v.value=n),style:{width:"90px"}},{default:t(()=>[a(m,{value:10},{default:t(()=>e[10]||(e[10]=[i("10 Reg.")])),_:1}),a(m,{value:20},{default:t(()=>e[11]||(e[11]=[i("20 Reg.")])),_:1}),a(m,{value:50},{default:t(()=>e[12]||(e[12]=[i("50 Reg.")])),_:1}),a(m,{value:100},{default:t(()=>e[13]||(e[13]=[i("100 Reg.")])),_:1})]),_:1},8,["value"])])])])]),_:1}),s("div",null,[a($,{open:_.value,"onUpdate:open":e[7]||(e[7]=n=>_.value=n),title:c.id?"Editar Ponderación":"Nueva ponderación"},{footer:t(()=>[a(u,{style:{"margin-left":"6px","border-radius":"4px"},onClick:j},{default:t(()=>e[17]||(e[17]=[i("Cancelar")])),_:1}),a(u,{type:"primary",style:{background:"#476175",border:"none","border-radius":"4px"},onClick:e[6]||(e[6]=n=>ee())},{default:t(()=>e[18]||(e[18]=[i("Guardar")])),_:1})]),default:t(()=>[s("div",Ke,[a(M,ve({ref_key:"formPonderacion",ref:R,name:"form",model:c},ne),{default:t(()=>[a(b,{label:"Nombre",rules:[{required:!0,message:"Ingrese el nombre",trigger:"change"}],name:"nombre"},{default:t(()=>[a(g,{type:"text",placeholder:"Ingrese el nombre",value:c.nombre,"onUpdate:value":e[4]||(e[4]=n=>c.nombre=n),autocomplete:"off"},{prefix:t(()=>[a(I)]),_:1},8,["value"])]),_:1}),a(b,{class:"mt-4",name:"area",label:"Area",rules:[{required:!0,message:"Seleccione un area",trigger:"change"}]},{default:t(()=>[a(L,{ref:"select",value:c.area,"onUpdate:value":e[5]||(e[5]=n=>c.area=n),style:{width:"100%"}},{default:t(()=>[a(m,{value:1},{default:t(()=>e[14]||(e[14]=[i("BIOMEDICAS")])),_:1}),a(m,{value:2},{default:t(()=>e[15]||(e[15]=[i("INGENIERIAS")])),_:1}),a(m,{value:3},{default:t(()=>e[16]||(e[16]=[i("SOCIALES")])),_:1})]),_:1},8,["value"])]),_:1})]),_:1},16,["model"])])]),_:1},8,["open","title"])]),s("div",null,[a($,{open:V.value,"onUpdate:open":e[8]||(e[8]=n=>V.value=n),title:"Detalle Ponderación",width:900,"body-style":"max-height: 600px; overflow-y: auto; padding: 16px;",centered:""},{footer:t(()=>[s("div",Ze,[a(u,{type:"dashed",onClick:oe},{default:t(()=>e[19]||(e[19]=[i("+ 1 más")])),_:1}),s("div",Qe,[a(u,{onClick:j},{default:t(()=>e[20]||(e[20]=[i("Cancelar")])),_:1}),a(u,{type:"primary",style:{background:"#476175",border:"none","border-radius":"4px"},onClick:ae},{default:t(()=>e[21]||(e[21]=[i(" Guardar ")])),_:1})])])]),default:t(()=>[a(M,{ref:"formPesos",name:"formpesos",model:d.value,layout:"horizontal"},{default:t(()=>[(f(!0),x(J,null,fe(G.value,(n,r)=>(f(),x("div",{key:r,class:"mb-0"},[a(ue,{gutter:[8,0],align:"middle"},{default:t(()=>[a(E,{xs:24,sm:2,md:1,class:"flex justify-center"},{default:t(()=>[a(u,{type:"default",size:"small",style:{height:"30px",width:"30px","margin-top":"-22px"}},{default:t(()=>[i(K(r+1),1)]),_:2},1024)]),_:2},1024),a(E,{xs:24,sm:11,md:15},{default:t(()=>[a(b,{name:"nombre_"+r},{default:t(()=>[a(g,{value:d.value[r].nombre,"onUpdate:value":p=>d.value[r].nombre=p,placeholder:"Asignatura",size:""},{prefix:t(()=>[a(I)]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),a(E,{xs:12,sm:6,md:4},{default:t(()=>[a(b,{name:"npreguntas_"+r},{default:t(()=>[a(g,{value:d.value[r].n_preguntas,"onUpdate:value":p=>d.value[r].n_preguntas=p,placeholder:"N° preguntas",size:""},{prefix:t(()=>[a(I)]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024),a(E,{xs:12,sm:5,md:4},{default:t(()=>[a(b,{name:"ponderacion_"+r},{default:t(()=>[a(g,{value:d.value[r].ponderacion,"onUpdate:value":p=>d.value[r].ponderacion=p,placeholder:"Ponderación 0.000",size:""},{prefix:t(()=>[a(I)]),_:2},1032,["value","onUpdate:value"])]),_:2},1032,["name"])]),_:2},1024)]),_:2},1024)]))),128))]),_:1},8,["model"])]),_:1},8,["open"])])],64)}}},ca=Fe(We,[["__scopeId","data-v-f26dab12"]]);export{ca as default};
