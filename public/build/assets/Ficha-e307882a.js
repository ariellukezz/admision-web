import{_ as me}from"./logotiny-c4b525af.js";import{_ as fe}from"./logoDAD-c76d0a0b.js";import{aa as he,ab as ge,r as n,e as G,f as b,o as A,s as xe,w as l,l as H,d as t,a as e,b as _,u as Y,S as ye,c as D,t as C,g as V,i as le,k as se,F as ne,n as be}from"./app-5ac01386.js";import{A as we}from"./LayoutSimulacro-f352424a.js";import{x as Ce}from"./xlsx-03fd725b.js";import{F as oe}from"./FormOutlined-df4fd5e6.js";import"./DropdownLink-c0aab5bc.js";import"./_plugin-vue_export-helper-c27b6911.js";var Z={exports:{}};const ke=he(Ce);(function(L,r){Object.defineProperty(r,"__esModule",{value:!0}),r.libraryName=r.xlsx=r.getWorksheetColumnWidths=r.getJsonSheetRow=r.getContentProperty=r.utils=void 0;const f=ke;Object.defineProperty(r,"utils",{enumerable:!0,get:function(){return f.utils}});const U=(a,c)=>{const p=(v,m)=>{const u=v[m[0]];return m.length===1?u??"":u===void 0||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Date?"":p(u,m.slice(1))},o=c.split(".");return p(a,o)};r.getContentProperty=U;const k=(a,c)=>{const p={};return c.forEach(o=>{typeof o.value=="function"?p[o.label]=o.value(a):p[o.label]=(0,r.getContentProperty)(a,o.value)}),p};r.getJsonSheetRow=k;const X=(a,c,p)=>{var o;for(let v=0;v<c.length;v+=1){const m=p[v];if(!m)continue;const u=f.utils.decode_col(c[v]),h=f.utils.decode_range((o=a["!ref"])!==null&&o!==void 0?o:"");for(let g=h.s.r+1;g<=h.e.r;++g){const x=f.utils.encode_cell({r:g,c:u});a[x]&&(a[x].z=m)}}},S=a=>{var c;const p=f.utils.decode_range((c=a["!ref"])!==null&&c!==void 0?c:""),o=[];for(let v=p.s.c;v<=p.e.c;v++){const m=f.utils.encode_col(v);o.push(m)}return o},B=a=>typeof a=="string"?a.length:typeof a=="number"?a.toString().length:typeof a=="boolean"?a?4:5:a instanceof Date?a.toString().length:0,N=(a,c=1)=>S(a).map(o=>({width:Object.keys(a).filter(u=>u.replace(/[0-9]/g,"")===o).reduce((u,h)=>{const g=a[h],x=B(g.v);if(!g.z)return Math.max(u,x);const P=g.z.length,q=Math.max(x,P);return Math.max(u,q)},0)+c}));r.getWorksheetColumnWidths=N;const E=(a,c)=>{let p;a.content.length>0?p=a.content.map(u=>(0,r.getJsonSheetRow)(u,a.columns)):p=a.columns.map(u=>({[u.label]:""}));const o=f.utils.json_to_sheet(p),v=S(o),m=a.columns.map(u=>{var h;return(h=u.format)!==null&&h!==void 0?h:null});return X(o,v,m),o["!cols"]=(0,r.getWorksheetColumnWidths)(o,c.extraLength),o},W=(a,c={})=>{var p,o,v,m,u;const h=!!c.RTL;(p=a.Workbook)!==null&&p!==void 0||(a.Workbook={}),(o=(u=a.Workbook).Views)!==null&&o!==void 0||(u.Views=[{}]),a.Workbook.Views.forEach(P=>{P.RTL=h});const g=`${(v=c.fileName)!==null&&v!==void 0?v:"Spreadsheet"}.xlsx`,x=(m=c.writeOptions)!==null&&m!==void 0?m:{};return c.writeMode==="write"?(0,f.write)(a,x):c.writeMode==="writeFile"?(0,f.writeFile)(a,g,x):x.type==="buffer"?(0,f.write)(a,x):(0,f.writeFile)(a,g,x)},z=(a,c={},p=()=>{})=>{if(a.length===0)return;const o=f.utils.book_new();return a.forEach((v,m)=>{var u;const h=E(v,c),g=(u=v.sheet)!==null&&u!==void 0?u:`Sheet ${m+1}`;f.utils.book_append_sheet(o,h,g)}),p(o),W(o,c)};r.xlsx=z,r.default=r.xlsx,r.libraryName="json-as-xlsx",L.exports=r.xlsx,L.exports.getContentProperty=r.getContentProperty,L.exports.getJsonSheetRow=r.getJsonSheetRow,L.exports.getWorksheetColumnWidths=r.getWorksheetColumnWidths,L.exports.utils=f.utils})(Z,Z.exports);var Ie=Z.exports;const Se=ge(Ie);const Ae={style:{}},Ne={class:"mb-2 flex justify-between"},Ee={key:0},We={style:{"font-weight":"bold","font-size":"0.9rem"}},De={key:1},Le={style:{"font-weight":"bold","font-size":"0.9rem"}},Ue={key:2,class:"flex"},ze={style:{"text-transform":"uppercase","font-size":".9rem"}},Re={key:3,class:"flex",style:{"justify-content":"center"}},Fe={style:{"font-weight":"bold"}},Pe={key:4,class:"flex",style:{"justify-content":"space-between"}},Oe={class:"flex justify-end"},Ve={class:"flex justify-center",style:{}},Be={class:"flex justify-center p-3",style:{width:"700px",background:"white",border:"solid #d9d9d9 1px","border-radius":"10px"}},Me={style:{width:"200px","margin-right":"10px"}},Je=t("div",{style:{"margin-right":"10px","text-align":"center","font-weight":"bold"}},[t("div",{style:{"font-weight":"bold"}}," HOJA DE "),_(" IDENTIFICACIÓN ")],-1),$e={class:"ml-3 pr-4",style:{}},je={class:"mt-3"},Te={class:"mt-3"},Ge=t("label",null,"N° Documento",-1),He={class:"mt-3"},Xe=t("label",null,"Nombres",-1),qe={class:"mt-3"},Qe=t("label",null,"Apellido Paterno",-1),Ke={class:"mt-3"},Ye=t("label",null,"Apellido Materno",-1),Ze=t("hr",{style:{border:"solid 1px #00000007",height:"570px","margin-right":"20px"}},null,-1),et=t("div",null,[t("div",{class:"flex justify-center",style:{height:"60px",width:"400px"}},[t("div",null,[t("img",{src:me,width:"50"})]),t("div",{class:"pl-3 pr-3",style:{"text-align":"center"}},[t("div",null,"Universidad Nacional del Altiplano"),t("div",{style:{"margin-top":"-5px"}},"Vicerrectorado Académico"),t("div",{style:{"margin-top":"-5px"}},"Dirección de Admisión")]),t("div",null,[t("img",{src:fe,width:"60"})])]),t("div",{class:"flex justify-center",style:{height:"30px",width:"400px","font-weight":"bold"}}," HOJA DE RESPUESTAS ")],-1),tt={class:"flex"},at={style:{"margin-right":"20px"}},lt={style:{padding:"0px",height:"15px","margin-bottom":"-20px",display:"flex","align-items":"center",overflow:"hidden"}},st={style:{width:"20px","font-size":".7rem"}},nt={style:{width:"200px"}},ot={style:{padding:"0px",height:"15px","margin-bottom":"-20px",display:"flex","align-items":"center",overflow:"hidden"}},it={style:{width:"20px","font-size":".7rem"}},ut={style:{"text-align":"right","margin-top":"-40px"}},dt={style:{display:"none"}},xt={__name:"Ficha",setup(L){const r=n([]),f=()=>{let d=[{sheet:"Participantes",columns:[{label:"dni",value:"dni"},{label:"Nombre",value:"nombres"},{label:"Paterno",value:"primer_apellido"},{label:"Materno",value:"segundo_apellido"},{label:"Area",value:"area"},{label:"Nota",value:"nota"}],content:r.value}];Se(d,{fileName:"Lista",extraLength:3,writeMode:"writeFile",writeOptions:{},RTL:!1})},U=n(4),k=n([]),X=()=>{R.value=!0,S.value="",B.value="",N.value="",E.value="",W.value="",z.value=4,k.value=[]},S=n(""),B=n(null),N=n("JHON ARIEL"),E=n("LUQUE"),W=n("CUSACANI"),z=n(4);n("2023");const a=n(null),c=n(null);n(!0),n(!0);const p=async()=>{let d=await H.post("get-simulacros?page="+J.value,{term:M.value,paginasize:$.value});ue.value=d.data.datos.data,ee.value=d.data.datos.total},o=async()=>{let d=await H.post("save-respuestas",{dni:S.value,nombres:N.value,paterno:E.value,materno:W.value,area:z.value,respuestas:k.value});R.value=!1,K(),v(d.data.tipo,d.data.titulo,d.data.mensaje),m()},v=(d,i,I)=>{be[d]({message:i,description:I})},m=(d,i,I)=>{a.value=null,c.value=null,x.value=null,P.value=null,q.value=null,R.value=null},u=[{title:"Nro",dataIndex:"nro",align:"center",width:"50px"},{title:"DNI",dataIndex:"dni",key:"documento",align:"left"},{title:"Nombre",dataIndex:"nombres",key:"name",align:"left"},{title:"Area",dataIndex:"area",key:"date"},{title:"Nota",dataIndex:"nota",width:"100px",align:"center"},{title:"",dataIndex:"accion",width:"50px"}],h=n([]);n(null);const g=n(""),x=n("");n([]),n(null),n("");const P=n(null);n([]),n(null),n("");const q=n("");n([]),G(U,(d,i)=>{K()});const ie=d=>{R.value=!0,B.value=d.idP,S.value=d.dni,N.value=d.nombres,E.value=d.primer_apellido,W.value=d.segundo_apellido},ue=n([]),R=n(!1);n("");const M=n(""),ee=n(0),J=n(1),$=n(100);G(M,(d,i)=>{getCertificados()}),G(J,(d,i)=>{getCertificados()}),G($,(d,i)=>{getCertificados()});const de=async()=>{const d=await H.post("/get-departamentos-codigo?page=",{term:g.value});h.value=d.data.datos.data},Q=n(""),K=async()=>{const d=await H.post("get-participantes-simulacro?page=",{term:"",examen:U.value});Q.value=d.data.datos};return K(),p(),de(),(d,i)=>{const I=b("a-select-option"),te=b("a-select"),j=b("a-button"),O=b("a-input"),re=b("a-table"),ce=b("a-pagination"),pe=b("a-card"),y=b("a-col"),w=b("a-checkbox"),ae=b("a-checkbox-group"),ve=b("a-modal");return A(),xe(we,null,{default:l(()=>[t("div",Ae,[e(pe,{style:{background:"white"},class:"m-0 p-0"},{default:l(()=>[t("div",Ne,[t("div",null,[e(te,{ref:"select",value:U.value,"onUpdate:value":i[0]||(i[0]=s=>U.value=s),style:{width:"120px"}},{default:l(()=>[e(I,{value:4},{default:l(()=>[_("BIOMEDICAS")]),_:1}),e(I,{value:6},{default:l(()=>[_("INGENIERIAS")]),_:1}),e(I,{value:5},{default:l(()=>[_("SOCIALES")]),_:1})]),_:1},8,["value"]),e(j,{type:"primary",onClick:i[1]||(i[1]=s=>X()),size:"small"},{icon:l(()=>[e(Y(oe))]),_:1})]),e(O,{placeholder:"Buscar",value:M.value,"onUpdate:value":i[2]||(i[2]=s=>M.value=s),style:{"max-width":"300px"}},{suffix:l(()=>[e(Y(ye))]),_:1},8,["value"])]),t("div",null,[e(j,{onClick:f},{default:l(()=>[_("Descargar XLSX")]),_:1}),e(re,{size:"small",dataSource:Q.value.data,columns:u,pagination:!1},{bodyCell:l(({column:s,text:T,record:F,index:_e})=>[s.dataIndex==="nro"?(A(),D("div",Ee,[t("span",We,C(_e+1),1)])):V("",!0),s.dataIndex==="cod"?(A(),D("div",De,[t("span",Le,C(F.dni),1)])):V("",!0),s.dataIndex==="nombres"?(A(),D("div",Ue,[t("span",ze,C(F.nombres)+" "+C(F.primer_apellido)+" "+C(F.segundo_apellido),1)])):V("",!0),s.dataIndex==="nota"?(A(),D("div",Re,[t("span",Fe,C(F.nota),1)])):V("",!0),s.dataIndex==="accion"?(A(),D("div",Pe,[e(j,{type:"primary",onClick:rt=>ie(F),size:"small"},{icon:l(()=>[e(Y(oe))]),_:2},1032,["onClick"])])):V("",!0)]),_:1},8,["dataSource"]),t("div",Oe,[e(ce,{current:J.value,"onUpdate:current":i[3]||(i[3]=s=>J.value=s),pageSize:$.value,"onUpdate:pageSize":i[4]||(i[4]=s=>$.value=s),total:ee.value,"show-size-changer":"","show-less-items":""},null,8,["current","pageSize","total"])])])]),_:1})]),e(ve,{visible:R.value,"onUpdate:visible":i[11]||(i[11]=s=>R.value=s),header:!1,width:"100vw","wrap-class-name":"full-modal"},{footer:l(()=>[t("div",ut,[e(j,{type:"primary",onClick:i[10]||(i[10]=s=>o())},{default:l(()=>[_("Guardar")]),_:1})])]),default:l(()=>[t("div",Ve,[t("div",Be,[t("div",Me,[Je,t("div",$e,[t("div",je,[e(te,{ref:"select",value:z.value,"onUpdate:value":i[5]||(i[5]=s=>z.value=s),style:{width:"175px"}},{default:l(()=>[e(I,{value:4},{default:l(()=>[_("BIOMEDICAS")]),_:1}),e(I,{value:6},{default:l(()=>[_("INGENIERIAS")]),_:1}),e(I,{value:5},{default:l(()=>[_("SOCIALES")]),_:1})]),_:1},8,["value"])]),t("div",Te,[Ge,e(O,{value:S.value,"onUpdate:value":i[6]||(i[6]=s=>S.value=s)},null,8,["value"])]),t("div",He,[Xe,e(O,{value:N.value,"onUpdate:value":i[7]||(i[7]=s=>N.value=s)},null,8,["value"])]),t("div",qe,[Qe,e(O,{value:E.value,"onUpdate:value":i[8]||(i[8]=s=>E.value=s)},null,8,["value"])]),t("div",Ke,[Ye,e(O,{value:W.value,"onUpdate:value":i[9]||(i[9]=s=>W.value=s)},null,8,["value"])])])]),Ze,t("div",null,[et,t("div",tt,[t("div",at,[(A(),D(ne,null,le(30,s=>t("div",{key:s,style:{padding:"0px",height:"16px"}},[e(ae,{value:k.value[s-1],"onUpdate:value":T=>k.value[s-1]=T,style:se([{width:"200px",height:"15px"},s%2==0?{backgroundColor:"#00000007"}:""])},{default:l(()=>[t("div",lt,[e(y,{span:4,style:{"margin-right":"-20px"}},{default:l(()=>[t("div",st,C(s),1)]),_:2},1024),e(y,{span:4},{default:l(()=>[e(w,{value:"A",class:"small-checkbox"},{default:l(()=>[_("A")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"B",class:"small-checkbox"},{default:l(()=>[_("B")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"C",class:"small-checkbox"},{default:l(()=>[_("C")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"D",class:"small-checkbox"},{default:l(()=>[_("D")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"E",class:"small-checkbox"},{default:l(()=>[_("E")]),_:1})]),_:1})])]),_:2},1032,["value","onUpdate:value","style"])])),64))]),t("div",nt,[(A(),D(ne,null,le(30,s=>t("div",{key:s,style:{padding:"0px",height:"16px"}},[e(ae,{value:k.value[s+29],"onUpdate:value":T=>k.value[s+29]=T,style:se([{width:"200px",height:"15px"},s%2==0?{backgroundColor:"#00000007"}:""])},{default:l(()=>[t("div",ot,[e(y,{span:4,style:{"margin-right":"-20px"}},{default:l(()=>[t("div",it,C(s+30),1)]),_:2},1024),e(y,{span:4},{default:l(()=>[e(w,{value:"A",class:"small-checkbox"},{default:l(()=>[_("A")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"B",class:"small-checkbox"},{default:l(()=>[_("B")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"C",class:"small-checkbox"},{default:l(()=>[_("C")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"D",class:"small-checkbox"},{default:l(()=>[_("D")]),_:1})]),_:1}),e(y,{span:4},{default:l(()=>[e(w,{value:"E",class:"small-checkbox"},{default:l(()=>[_("E")]),_:1})]),_:1})])]),_:2},1032,["value","onUpdate:value","style"])])),64))])])])])]),_(" "+C(k.value)+" ",1)]),_:1},8,["visible"]),t("div",dt,C(r.value=Q.value.data),1)]),_:1})}}};export{xt as default};
