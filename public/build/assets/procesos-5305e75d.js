import{r as d,C as ce,e as T,D as ue,o as h,c as pe,a as o,u as f,w as s,F as me,y as p,Z as _e,d as i,b as g,E as C,t as D,f as N,a3 as k,n as ve,B as fe,j as ge,aZ as be,_ as xe,L as we,aQ as ye,h as he,O as ke,k as Ie,I as Ee,aP as Ue,W as Ce,p as De,q as Ne,M as Se}from"./app-d94ab509.js";import{_ as Ye}from"./AuthenticatedLayout-c745db55.js";import{L as Oe}from"./LinkOutlined-a810db14.js";import{F as Pe}from"./FormOutlined-83040a87.js";import{D as Me}from"./DeleteOutlined-7dacb522.js";import"./logotiny-c4b525af.js";import"./Header-05192c94.js";import"./AntdIcon-c56eb973.js";import"./perfil-2cd2fa85.js";/* empty css                                                               */import"./_plugin-vue_export-helper-c27b6911.js";import"./UserOutlined-deee76e7.js";import"./SafetyCertificateOutlined-17e2c446.js";import"./EditOutlined-7757bf87.js";import"./DownOutlined-e7a41506.js";/* empty css                                                            */const Fe={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4 md:p-6",style:{height:"calc(100vh - 100px)"}},qe={class:"flex flex-col lg:flex-row justify-between mb-6 gap-4"},Ae={class:"flex flex-col sm:flex-row gap-3 w-full lg:w-auto"},Re={class:"overflow-x-auto"},je={class:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6"},Le={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4"},Te={class:"space-y-4"},Ve={class:"space-y-4"},ze={class:"space-y-4"},Be={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-4 mt-6"},$e={class:"mt-6"},Ge={class:"flex justify-end gap-3 pt-4 border-t"},uo={__name:"procesos",setup(We){const S=window.location.origin,b=d(null),x=d(""),Y=d([]),O=d([]),P=d([]),m=d(!1),M=d([]),F=d(null),q=d([]),I=d(!1),l=ce({id:null,nombre:"",convocatoria:"",slug:"",sede:null,tipo:null,ciclo:null,modalidad:null,fec_examen:"",anio:new Date().getFullYear(),estado:!0,f_inicio:null,f_fin:null,dia_1:null,dia_2:null,nivel:null,cod_proceso:"",id_reglamento:null,observacion:""}),V=[{title:"Nombre",dataIndex:"nombre",key:"nombre",ellipsis:!0},{title:"Sede",dataIndex:"sede",key:"sede",align:"center",responsive:["md"]},{title:"Tipo",dataIndex:"tipo",key:"tipo",align:"center",width:"120px",responsive:["lg"]},{title:"Modalidad",dataIndex:"modalidad",key:"modalidad",align:"center",width:"140px"},{title:"Año",dataIndex:"anio",key:"anio",align:"center",width:"80px"},{title:"Estado",dataIndex:"estado",key:"estado",align:"center",width:"100px"},{title:"Acciones",dataIndex:"acciones",key:"acciones",align:"center",width:"120px",fixed:"right"}],A=d([{value:1,label:"Pre grado"},{value:2,label:"Segunda especialidad"}]),z=d([{value:"1",label:"I"},{value:"2",label:"II"}]),B=()=>{ee(),m.value=!0},$=e=>{Object.assign(l,{id:e.id,nombre:e.nombre,slug:e.slug,sede:e.id_sede,convocatoria:e.convocatoria,nivel:e.nivel,ciclo:e.ciclo,fec_examen:e.fecha_examen,f_inicio:e.fec_inicio?k(e.fec_inicio):null,f_fin:e.fec_fin?k(e.fec_fin):null,dia_1:e.fec_1?k(e.fec_1):null,dia_2:e.fec_2?k(e.fec_2):null,tipo:e.id_tipo,id_reglamento:e.id_reglamento,cod_proceso:e.codigo_proceso,observacion:e.observacion,modalidad:e.id_modalidad,anio:e.anio,estado:e.estado==1}),m.value=!0},_=async()=>{try{const e=await p.post("/admin/procesos/get-procesos",{term:x.value,nivel:b.value});P.value=e.data.datos.data}catch(e){console.error("Error al obtener procesos:",e)}},G=async()=>{try{const e=await p.post("get-sedes");Y.value=e.data.datos.data}catch(e){console.error("Error al obtener sedes:",e)}},W=async()=>{try{const e=await p.get("procesos/get-tipos");O.value=e.data.datos}catch(e){console.error("Error al obtener tipos:",e)}},Z=async()=>{try{const e=await p.get("procesos/get-modalidades");M.value=e.data.datos}catch(e){console.error("Error al obtener modalidades:",e)}},Q=async()=>{try{const e=await p.get("get-select-reglamentos");q.value=e.data.datos}catch(e){console.error("Error al obtener reglamentos:",e)}},X=async()=>{var e,a;try{I.value=!0,await F.value.validate();const r=await p.post("save-proceso",l);E("success",r.data.titulo,r.data.mensaje),_(),m.value=!1}catch(r){if((a=(e=r.response)==null?void 0:e.data)!=null&&a.errors){const c=r.response.data.errors;Object.keys(c).forEach(w=>{E("error","Error",c[w][0])})}}finally{I.value=!1}},H=e=>{confirm(`¿Está seguro de eliminar el proceso "${e.nombre}"?`)&&p.get("eliminar-proceso/"+e.id).then(a=>{_(),E("warning","PROCESO ELIMINADO",a.data.mensaje)})},E=(e,a,r)=>{ve[e]({message:a,description:r,placement:"topRight"})},J=()=>{m.value=!1},K=e=>{window.open(S+"/"+e.slug+"/preinscripcion","_blank")},ee=()=>{Object.keys(l).forEach(e=>{e==="anio"?l[e]=new Date().getFullYear():e==="estado"?l[e]=!0:l[e]=null}),l.nombre="",l.convocatoria="",l.slug="",l.fec_examen="",l.cod_proceso="",l.observacion=""},oe=(e,a)=>a.label.toLowerCase().indexOf(e.toLowerCase())>=0;let R;return T(x,e=>{clearTimeout(R),R=setTimeout(()=>{_()},500)}),T(b,()=>{_()}),_(),G(),W(),Z(),Q(),(e,a)=>{const r=fe,c=ge,w=ue("sin-icono"),ae=be,j=xe,U=we,le=ye,ne=he,se=ke,t=Ie,v=Ee,te=Ue,y=Ce,re=De,ie=Ne,de=Se;return h(),pe(me,null,[o(f(_e),{title:"Procesos"}),o(Ye,null,{default:s(()=>[i("div",Fe,[i("div",qe,[i("div",null,[o(r,{type:"primary",style:{background:"#476175",border:"none","border-radius":"5px"},onClick:B,class:"w-full lg:w-auto"},{default:s(()=>a[21]||(a[21]=[g(" Nuevo Proceso ")])),_:1})]),i("div",Ae,[o(c,{ref:"Nivel",options:A.value,value:b.value,"onUpdate:value":a[0]||(a[0]=n=>b.value=n),placeholder:"Nivel",class:"min-w-[140px]"},null,8,["options","value"]),o(ae,{value:x.value,"onUpdate:value":a[1]||(a[1]=n=>x.value=n),placeholder:"Buscar procesos...",class:"max-w-full",onSearch:_},{prefix:s(()=>[o(w)]),_:1},8,["value"])])]),i("div",Re,[o(ne,{columns:V,"data-source":P.value,pagination:{pageSize:50},size:"small",scroll:{x:"max-content",y:"calc(100vh - 280px)"}},{bodyCell:s(({column:n,record:u})=>[n.dataIndex==="modalidad"?(h(),C(j,{key:0,color:{CEPREUNA:"cyan",GENERAL:"orange",EXTRAORDINARIO:"pink"}[u.modalidad]},{default:s(()=>[g(D(u.modalidad),1)]),_:2},1032,["color"])):N("",!0),n.dataIndex==="estado"?(h(),C(j,{key:1,color:u.estado==1?"green":"red"},{default:s(()=>[g(D(u.estado==1?"VIGENTE":"NO VIGENTE"),1)]),_:2},1032,["color"])):N("",!0),n.dataIndex==="acciones"?(h(),C(le,{key:2,size:"small",class:"flex flex-wrap"},{default:s(()=>[o(U,{title:"Ver preinscripción"},{default:s(()=>[o(r,{onClick:L=>K(u),size:"small",type:"text",class:"text-green-600 hover:text-green-800"},{icon:s(()=>[o(f(Oe))]),_:2},1032,["onClick"])]),_:2},1024),o(U,{title:"Editar"},{default:s(()=>[o(r,{onClick:L=>$(u),size:"small",type:"text",class:"text-blue-600 hover:text-blue-800"},{icon:s(()=>[o(f(Pe))]),_:2},1032,["onClick"])]),_:2},1024),o(U,{title:"Eliminar"},{default:s(()=>[o(r,{onClick:L=>H(u),size:"small",type:"text",danger:""},{icon:s(()=>[o(f(Me))]),_:2},1032,["onClick"])]),_:2},1024)]),_:2},1024)):N("",!0)]),_:1},8,["data-source"])])]),o(de,{open:m.value,"onUpdate:open":a[20]||(a[20]=n=>m.value=n),centered:"",title:l.id?"Editar Proceso":"Nuevo Proceso",width:"90%",style:{maxWidth:"900px"},footer:null},{default:s(()=>[o(ie,{ref_key:"formProceso",ref:F,name:"proceso",model:l,rules:e.formRules,layout:"vertical",onFinish:X},{default:s(()=>[i("div",je,[o(t,{label:"Estado",name:"estado",class:"mb-0"},{default:s(()=>[o(se,{checked:l.estado,"onUpdate:checked":a[2]||(a[2]=n=>l.estado=n),"checked-children":"Activo","un-checked-children":"Inactivo"},null,8,["checked"])]),_:1}),o(t,{label:"Ciclo",name:"ciclo",rules:[{required:!0,message:"Seleccione el ciclo"}],class:"mb-0"},{default:s(()=>[o(c,{value:l.ciclo,"onUpdate:value":a[3]||(a[3]=n=>l.ciclo=n),options:z.value,placeholder:"Seleccionar ciclo","allow-clear":""},null,8,["value","options"])]),_:1}),o(t,{label:"Nivel",name:"nivel",rules:[{required:!0,message:"Seleccione el nivel"}],class:"mb-0"},{default:s(()=>[o(c,{value:l.nivel,"onUpdate:value":a[4]||(a[4]=n=>l.nivel=n),options:A.value,placeholder:"Seleccionar nivel","allow-clear":""},null,8,["value","options"])]),_:1})]),i("div",Le,[i("div",Te,[o(t,{label:"Nombre",name:"nombre",rules:[{required:!0,message:"Ingrese el nombre del proceso"}]},{default:s(()=>[o(v,{value:l.nombre,"onUpdate:value":a[5]||(a[5]=n=>l.nombre=n),placeholder:"Nombre del proceso","allow-clear":""},{prefix:s(()=>[o(w)]),_:1},8,["value"])]),_:1}),o(t,{label:"N° Convocatoria",name:"convocatoria"},{default:s(()=>[o(v,{value:l.convocatoria,"onUpdate:value":a[6]||(a[6]=n=>l.convocatoria=n),placeholder:"Número de convocatoria","allow-clear":""},null,8,["value"])]),_:1}),o(t,{label:"Año",name:"anio",rules:[{required:!0,message:"Ingrese el año"}]},{default:s(()=>[o(te,{value:l.anio,"onUpdate:value":a[7]||(a[7]=n=>l.anio=n),min:2e3,max:2100,class:"w-full",placeholder:"Año"},null,8,["value"])]),_:1}),o(t,{label:"Slug",name:"slug",rules:[{required:!0,message:"Ingrese el slug"}]},{default:s(()=>[o(v,{value:l.slug,"onUpdate:value":a[8]||(a[8]=n=>l.slug=n),placeholder:"slug-proceso","allow-clear":""},null,8,["value"])]),_:1})]),i("div",Ve,[o(t,{label:"Sede",name:"sede",rules:[{required:!0,message:"Seleccione la sede"}]},{default:s(()=>[o(c,{value:l.sede,"onUpdate:value":a[9]||(a[9]=n=>l.sede=n),options:Y.value,label:"label",placeholder:"Seleccionar sede","allow-clear":""},null,8,["value","options"])]),_:1}),o(t,{label:"Tipo de estudio",name:"tipo",rules:[{required:!0,message:"Seleccione el tipo de estudio"}]},{default:s(()=>[o(c,{value:l.tipo,"onUpdate:value":a[10]||(a[10]=n=>l.tipo=n),options:O.value,placeholder:"Seleccionar tipo","allow-clear":""},null,8,["value","options"])]),_:1}),o(t,{label:"Modalidad de examen",name:"modalidad",rules:[{required:!0,message:"Seleccione la modalidad"}]},{default:s(()=>[o(c,{value:l.modalidad,"onUpdate:value":a[11]||(a[11]=n=>l.modalidad=n),options:M.value,placeholder:"Seleccionar modalidad","allow-clear":""},null,8,["value","options"])]),_:1}),o(t,{label:"Fecha de examen",name:"fec_examen",rules:[{required:!0,message:"Ingrese la fecha de examen"}]},{default:s(()=>[o(v,{value:l.fec_examen,"onUpdate:value":a[12]||(a[12]=n=>l.fec_examen=n),placeholder:"Fecha de examen","allow-clear":""},null,8,["value"])]),_:1})]),i("div",ze,[o(t,{label:"URL de preinscripción"},{default:s(()=>[o(v,{value:f(S)+"/"+(l.slug||"slug")+"/preinscripcion",disabled:"",class:"bg-gray-50"},null,8,["value"])]),_:1}),o(t,{label:"Código de proceso",name:"cod_proceso",rules:[{required:!0,message:"Ingrese el código del proceso"}]},{default:s(()=>[o(v,{value:l.cod_proceso,"onUpdate:value":a[13]||(a[13]=n=>l.cod_proceso=n),placeholder:"Código del proceso","allow-clear":""},null,8,["value"])]),_:1}),o(t,{label:"Reglamento",name:"id_reglamento"},{default:s(()=>[o(c,{value:l.id_reglamento,"onUpdate:value":a[14]||(a[14]=n=>l.id_reglamento=n),options:q.value,placeholder:"Seleccionar reglamento","allow-clear":"","show-search":"","filter-option":oe},null,8,["value","options"])]),_:1})])]),i("div",Be,[o(t,{label:"Fecha de inicio",name:"f_inicio"},{default:s(()=>[o(y,{value:l.f_inicio,"onUpdate:value":a[15]||(a[15]=n=>l.f_inicio=n),format:"DD/MM/YYYY",placeholder:"Fecha inicio",class:"w-full"},null,8,["value"])]),_:1}),o(t,{label:"Fecha de fin",name:"f_fin"},{default:s(()=>[o(y,{value:l.f_fin,"onUpdate:value":a[16]||(a[16]=n=>l.f_fin=n),format:"DD/MM/YYYY",placeholder:"Fecha fin",class:"w-full"},null,8,["value"])]),_:1}),o(t,{label:"Día 1",name:"dia_1",rules:[{required:!0,message:"Seleccione el día 1"}]},{default:s(()=>[o(y,{value:l.dia_1,"onUpdate:value":a[17]||(a[17]=n=>l.dia_1=n),format:"DD/MM/YYYY",placeholder:"Día 1",class:"w-full"},null,8,["value"])]),_:1}),o(t,{label:"Día 2",name:"dia_2"},{default:s(()=>[o(y,{value:l.dia_2,"onUpdate:value":a[18]||(a[18]=n=>l.dia_2=n),format:"DD/MM/YYYY",placeholder:"Día 2",class:"w-full"},null,8,["value"])]),_:1})]),i("div",$e,[o(t,{label:"Observaciones",name:"observacion"},{default:s(()=>[o(re,{value:l.observacion,"onUpdate:value":a[19]||(a[19]=n=>l.observacion=n),placeholder:"Ingrese observaciones adicionales...",rows:3,"show-count":"",maxlength:500},null,8,["value"])]),_:1})]),i("div",Ge,[o(r,{onClick:J},{default:s(()=>a[22]||(a[22]=[g(" Cancelar ")])),_:1}),o(r,{type:"primary","html-type":"submit",style:{background:"#476175",border:"none"},loading:I.value},{default:s(()=>[g(D(l.id?"Actualizar":"Guardar"),1)]),_:1},8,["loading"])])]),_:1},8,["model","rules"])]),_:1},8,["open","title"])]),_:1})],64)}}};export{uo as default};
