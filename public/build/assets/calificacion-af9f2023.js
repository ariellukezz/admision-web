import{r as n,e as J,D as K,o as f,c as g,d as o,a as s,w as l,f as y,y as p,B as Q,h as W,M as X,b as c,t as D,F as Z,u as ee,S as te,j as oe,I as ae,L as ne}from"./app-ede6f9ca.js";import{D as se}from"./DownOutlined-75ab2def.js";import"./AntdIcon-6b9d6525.js";const le={class:"mt-0 mb-4"},re={class:"class flex justify-between"},de={class:"mt-0 mb-4"},ie={class:"flex",style:{gap:"5px"}},ue={key:0,class:"mt-0 mb-4"},ce={class:"mt-0 mb-4"},pe={key:0},ve={key:0},me={class:"mt-4 mb-2"},fe={style:{display:"flex",gap:"16px"},class:"mt-4"},ge={class:"mt-3"},be={class:"flex justify-end mt-4"},_e={class:"mr-2"},Ie={__name:"calificacion",props:["proceso"],setup(N){const v=N,x=n(""),b=n(null),_=n(""),I=n([]),L=(t,e)=>{b.value=e};J(_,(t,e)=>{U()});const j=n([]),R=n(0),B=n(1),M=n(10);n("");const E=n(1),k=n(0),C=n(0),O=n([]),F=n([]),P=n([]);n(null),n(null),n(null);const U=async()=>{let t=await p.post("calificacion/get-ponderaciones-select?page="+B.value,{term:_.value,paginasize:M.value});j.value=t.data.datos.data,R.value=t.data.datos.total},V=async()=>{await p.post("/calificar-examen",{id_simulacro:v.proceso,id_ponderacion:b.value.key,correctas:E.value,incorrectas:k.value,blanco:C.value,area:x.value}),S.value=!1,A()},A=async()=>{let t=await p.post("/get-puntajes-examen",{id_simulacro:v.proceso});I.value=t.data.datos};A();const S=n(!1);U();const h=t=>Number(t).toFixed(2),z=n([{title:"N째",dataIndex:"nro",align:"center"},{title:"DNI",dataIndex:"dni"},{title:"Ap. Paterno",dataIndex:"paterno"},{title:"Ap. Materno",dataIndex:"materno"},{title:"Nombres",dataIndex:"nombres"},{title:"Puntaje",dataIndex:"puntaje",align:"center"}]);(async()=>{p.get("/calificacion/get-select-puestos/"+v.proceso).then(t=>{O.value=t.data.puestos,F.value=t.data.codigos_puesto,P.value=t.data.unidades}).catch(t=>{t.response?console.error("Error de servidor:",t.response.data):t.request?console.error("Error de red:",t.request):console.error("Error de configuraci처n:",t.message)})})();const T=async t=>{try{const e=await p.post("/get-pdf-resultados/"+v.proceso,{},{responseType:"blob"});if(e.status!==200)throw new Error("Error al obtener el archivo");const d=window.URL.createObjectURL(new Blob([e.data])),i=document.createElement("a");i.href=d;const r=new Date,m=`${`${r.getDate().toString().padStart(2,"0")}-${(r.getMonth()+1).toString().padStart(2,"0")}-${r.getFullYear()}_${r.getHours().toString().padStart(2,"0")}-${r.getMinutes().toString().padStart(2,"0")}-${r.getSeconds().toString().padStart(2,"0")}`}_resultados.pdf`;i.setAttribute("download",m),document.body.appendChild(i),i.click(),document.body.removeChild(i),window.URL.revokeObjectURL(d)}catch(e){console.error("Error al descargar el archivo:",e)}},q=async()=>{try{const t=await p.get("calificacion/descargar-excel",{params:{descargar:1,id_proceso:v.proceso},responseType:"blob"});if(t.status!==200)throw new Error("Error al obtener el archivo");const e=new Date,i=`${`${e.getDate().toString().padStart(2,"0")}-${(e.getMonth()+1).toString().padStart(2,"0")}-${e.getFullYear()}_${e.getHours().toString().padStart(2,"0")}-${e.getMinutes().toString().padStart(2,"0")}-${e.getSeconds().toString().padStart(2,"0")}`}_lista_postulantes.xlsx`,r=window.URL.createObjectURL(new Blob([t.data])),u=document.createElement("a");u.href=r,u.setAttribute("download",i),document.body.appendChild(u),u.click(),document.body.removeChild(u),window.URL.revokeObjectURL(r)}catch(t){console.error("Error al descargar el archivo:",t)}};return(t,e)=>{const d=Q,i=W,r=te,u=oe,m=K("Icono"),w=ae,G=ne,H=X;return f(),g("div",null,[o("div",le,[o("div",re,[o("div",de,[s(d,{onClick:e[0]||(e[0]=a=>S.value=!0)},{default:l(()=>e[11]||(e[11]=[c("Calificar")])),_:1})]),o("div",ie,[I.value!=[]?(f(),g("div",ue,[s(d,{style:{width:"140px",background:"crimson",border:"none",color:"white"},onClick:e[1]||(e[1]=a=>T())},{default:l(()=>e[12]||(e[12]=[c("Descargar")])),_:1})])):y("",!0),o("div",ce,[s(d,{style:{width:"140px",background:"green",border:"none",color:"white"},onClick:e[2]||(e[2]=a=>q())},{default:l(()=>e[13]||(e[13]=[c("Descargar Excel")])),_:1})])])])]),s(i,{dataSource:I.value,columns:z.value,size:"small",pagination:!1},{bodyCell:l(({column:a,index:Y,record:$})=>[a.dataIndex==="nro"?(f(),g("span",pe,D(Y+1),1)):y("",!0),a.dataIndex==="puntaje"?(f(),g(Z,{key:1},[$.puntaje!==null&&$.puntaje!==void 0?(f(),g("div",ve,[o("span",null,D(h($.puntaje)),1)])):y("",!0)],64)):y("",!0)]),_:1},8,["dataSource","columns"]),s(H,{title:"Modal de calificaci처n",open:S.value,"onUpdate:open":e[10]||(e[10]=a=>S.value=a),footer:!1},{default:l(()=>[o("div",me,[e[17]||(e[17]=o("label",null,"Area",-1)),s(u,{ref:"select",value:x.value,"onUpdate:value":e[3]||(e[3]=a=>x.value=a),style:{width:"100%"}},{default:l(()=>[s(r,{value:"BIOMEDICAS"},{default:l(()=>e[14]||(e[14]=[c("BIOMEDICAS")])),_:1}),s(r,{value:"SOCIALES"},{default:l(()=>e[15]||(e[15]=[c("SOCIALES")])),_:1}),s(r,{value:"INGENIERIAS"},{default:l(()=>e[16]||(e[16]=[c("INGENIERIAS")])),_:1})]),_:1},8,["value"])]),o("div",fe,[o("div",null,[e[18]||(e[18]=o("label",null,"Correctas",-1)),s(w,{ref:"select",value:E.value,"onUpdate:value":e[4]||(e[4]=a=>E.value=a),style:{width:"100%"}},{suffix:l(()=>[s(m)]),_:1},8,["value"])]),o("div",null,[e[19]||(e[19]=o("label",null,"Incorrectas",-1)),s(w,{ref:"select",value:k.value,"onUpdate:value":e[5]||(e[5]=a=>k.value=a),style:{width:"100%"}},{suffix:l(()=>[s(m)]),_:1},8,["value"])]),o("div",null,[e[20]||(e[20]=o("label",null,"En Blanco",-1)),s(w,{ref:"select",value:C.value,"onUpdate:value":e[6]||(e[6]=a=>C.value=a),style:{width:"100%"}},{suffix:l(()=>[s(m)]),_:1},8,["value"])])]),o("div",ge,[e[21]||(e[21]=o("label",null,"Ponderacion",-1)),o("div",null,[s(G,{value:b.value,"onUpdate:value":e[8]||(e[8]=a=>b.value=a),options:j.value,onSelect:L,style:{width:"100%"}},{default:l(()=>[s(w,{placeholder:"Ponderaci처n ...",value:_.value,"onUpdate:value":e[7]||(e[7]=a=>_.value=a)},{suffix:l(()=>[s(ee(se))]),_:1},8,["value"])]),_:1},8,["value","options"])])]),o("div",be,[o("div",_e,[s(d,{style:{"margin-left":"6px","border-radius":"4px"}},{default:l(()=>e[22]||(e[22]=[c("Cancelar")])),_:1})]),o("div",null,[s(d,{type:"primary",onClick:e[9]||(e[9]=a=>V()),style:{background:"#476175",border:"none","border-radius":"4px"}},{default:l(()=>e[23]||(e[23]=[c("Calificar")])),_:1})])])]),_:1},8,["open"])])}}};export{Ie as default};
