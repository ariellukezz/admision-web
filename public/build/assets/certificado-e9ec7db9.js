import{a6 as Q,a7 as W,I as X,r as u,x as Z,f as r,o as y,c as x,a as t,w as s,d as e,F as A,b as _,t as p,i as ee,g as E,u as oe,l as j,a8 as F}from"./app-ac99223e.js";var te={exports:{}};(function(k,v){(function(h,g){k.exports=g(Q)})(W,function(h){function g(d){return d&&typeof d=="object"&&"default"in d?d:{default:d}}var D=g(h),c={name:"es",monthsShort:"ene_feb_mar_abr_may_jun_jul_ago_sep_oct_nov_dic".split("_"),weekdays:"domingo_lunes_martes_miércoles_jueves_viernes_sábado".split("_"),weekdaysShort:"dom._lun._mar._mié._jue._vie._sáb.".split("_"),weekdaysMin:"do_lu_ma_mi_ju_vi_sá".split("_"),months:"enero_febrero_marzo_abril_mayo_junio_julio_agosto_septiembre_octubre_noviembre_diciembre".split("_"),weekStart:1,formats:{LT:"H:mm",LTS:"H:mm:ss",L:"DD/MM/YYYY",LL:"D [de] MMMM [de] YYYY",LLL:"D [de] MMMM [de] YYYY H:mm",LLLL:"dddd, D [de] MMMM [de] YYYY H:mm"},relativeTime:{future:"en %s",past:"hace %s",s:"unos segundos",m:"un minuto",mm:"%d minutos",h:"una hora",hh:"%d horas",d:"un día",dd:"%d días",M:"un mes",MM:"%d meses",y:"un año",yy:"%d años"},ordinal:function(d){return d+"º"}};return D.default.locale(c,null,!0),c})})(te);const se={class:"flex justify-between border-b-2",style:{"border-bottom":"solid 2px #009DD1","padding-bottom":"8px"}},ae=e("div",null,[e("span",{style:{"font-weight":"bold","font-size":"1rem",color:"#009DD1"}},"CERTIFIACDO DE ESTUDIOS")],-1),le={style:{"margin-top":"-5px"}},ne={class:"mt-3"},ie={class:"flex justify-between",style:{}},re={class:""},de={style:{"margin-bottom":"-5px","margin-top":"-2px"}},ue={style:{"font-size":".8rem"}},ce={class:"font-bold",style:{"font-size":"1rem"}},_e={style:{"font-style":"italic",color:"#009DD1"}},pe={class:"flex",style:{"margin-top":"0px"}},me=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-eye"},[e("path",{d:"M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z"}),e("circle",{cx:"12",cy:"12",r:"3"})],-1),fe=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"#1a2843","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-edit-2"},[e("path",{d:"M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"})],-1),ve=e("svg",{xmlns:"http://www.w3.org/2000/svg",width:"12",height:"12",viewBox:"0 0 24 24",fill:"none",stroke:"currentColor","stroke-width":"2","stroke-linecap":"round","stroke-linejoin":"round",class:"feather feather-trash"},[e("polyline",{points:"3 6 5 6 21 6"}),e("path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"})],-1),he={class:""},ge=e("label",null,[_("Tipo"),e("span",{style:{color:"red"}},"*")],-1),be=e("label",null,[_("Observación"),e("span",{style:{color:"red"}},"*")],-1),ye=e("label",null,[_("Archivo PDF (Max. 2mb)"),e("span",{style:{color:"red"}},"*")],-1),xe={key:0,class:"mt-2"},we=["src"],ke={class:"flex justify-end"},De={key:0,class:"mt-2"},Le=["src"],Me={class:"flex justify-end"},je={__name:"certificado",props:["id_proceso","dni"],setup(k){const v=k,h=window.location.origin;X.locale("es");const g=()=>{c.value=!0},D=o=>{n.id=o.id,n.observacion=o.observacion,m.value=h+"/"+o.url,n.tipo=o.id_tipo,c.value=!0},c=u(!1),d=u([]),U=u([{value:1,label:"CERTIFICADO BLANCO"},{value:2,label:"CERTIFICADO AMARILLO"}]),w=u(!1),L=u(null),I=o=>{L.value=o,w.value=!0},Y=u(),n=Z({id:null,observacion:"",tipo:null,fileList:[]}),P=o=>{console.log(`selected ${o}`)},B=async o=>{(await j.get("/eliminar-titulo/"+o)).data.estado==!0?R():console.log("Ocurrió un error")},b=u(!1),m=u(null),O=u(0),z=o=>{if(o.type==="application/pdf"){const a=new FileReader;a.onload=i=>{m.value=i.target.result},a.readAsDataURL(o),n.fileList=[o]}else F.error("¡Solo puedes cargar archivos PDF!");return!1},R=async()=>{const o=await j.get("/get-titulos-usuario");o.data.estado==!0?d.value=o.data.datos:console.log("No se encontraron datos")},N=()=>{m.value=null,n.fileList=[]},V=async()=>{console.log("PROCESO ID ",v.id_proceso),await Y.value.validateFields();const o=new FormData;n.fileList[0]&&o.append("file",n.fileList[0]),n.id!=null&&o.append("id",n.id),o.append("id_proceso",v.id_proceso),o.append("dni",v.dni),o.append("observacion",n.observacion),o.append("tipo",n.tipo);try{b.value=!0,O.value=0;const a=await j.post("/save-certificado",o,{headers:{"Content-Type":"multipart/form-data",Authorization:"Bearer your-auth-token"},onUploadProgress:i=>{O.value=Math.round(i.loaded*100/i.total)}});c.value=!1,b.value=!1,n.value=!1,F.success("¡Archivo PDF cargado exitosamente!"),await R()}catch(a){b.value=!1,F.error("Error al cargar el archivo."),console.error("File upload failed:",a)}};return(o,a)=>{const i=r("a-button"),f=r("a-col"),M=r("a-row"),$=r("a-card"),H=r("a-select"),C=r("a-form-item"),q=r("a-input"),G=r("upload-outlined"),J=r("a-upload"),K=r("a-form"),S=r("a-modal");return y(),x(A,null,[t($,{class:"mx-2 my-2 mt-2"},{default:s(()=>[e("div",null,[e("div",se,[ae,e("div",le,[t(i,{onClick:a[0]||(a[0]=l=>g())},{default:s(()=>[_("Agregar")]),_:1})])]),e("div",ne,[_(p(v)+" ",1),(y(!0),x(A,null,ee(d.value,l=>(y(),x("div",{class:"mb-2",key:l},[t(M,{gutter:16},{default:s(()=>[t(f,{xs:24,sm:4,md:4,lg:2},{default:s(()=>[e("div",null,p(o.voltearFecha(l.fec_expedicion)),1)]),_:2},1024),t(f,{xs:24,sm:20,md:20,lg:22},{default:s(()=>[e("div",ie,[e("div",re,[e("div",de,[e("span",ue,p(l.tipo_nombre),1)]),e("div",null,[e("span",ce,p(l.denominacion),1)]),e("div",null,p(l.institucion),1),e("div",null,[e("span",_e,p(l.reg_sunedu==0?"Sin registro":"Registrado en SUNEDU"),1)])]),e("div",pe,[t(i,{onClick:T=>I(l.url),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>[me]),_:2},1032,["onClick"]),t(i,{onClick:T=>D(l),class:"mr-2",style:{width:"20px",height:"20px","padding-left":"3px",border:"solid #1a2843 1px"}},{default:s(()=>[fe]),_:2},1032,["onClick"]),t(i,{danger:"",onClick:T=>B(l.id),style:{width:"20px",height:"20px","padding-left":"3px"}},{default:s(()=>[ve]),_:2},1032,["onClick"])])])]),_:2},1024)]),_:2},1024)]))),128))])])]),_:1}),e("div",he,[t(S,{visible:c.value,"onUpdate:visible":a[3]||(a[3]=l=>c.value=l),width:"800px",class:"w-full md:w-3/4",title:"Registro de certificado",onOk:o.handleOk},{footer:s(()=>[e("div",ke,[t(i,{type:"primary",disabled:!m.value,loading:b.value,style:{"margin-top":"16px"},onClick:V},{default:s(()=>[_(p(b.value?"Subiendo...":"Guardar datos"),1)]),_:1},8,["disabled","loading"])])]),default:s(()=>[t(K,{ref_key:"formDatos",ref:Y,name:"form",model:n,rules:o.formRules},{default:s(()=>[t(M,{gutter:16},{default:s(()=>[t(f,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[ge,t(C,{name:"tipo",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t(H,{ref:"select",value:n.tipo,"onUpdate:value":a[1]||(a[1]=l=>n.tipo=l),style:{width:"100%"},options:U.value,onFocus:o.focus,onChange:P},null,8,["value","options","onFocus"])]),_:1})]),_:1}),t(f,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[be,t(C,{name:"observacion"},{default:s(()=>[t(q,{value:n.observacion,"onUpdate:value":a[2]||(a[2]=l=>n.observacion=l),style:{height:"32px"}},{suffix:s(()=>[]),_:1},8,["value"])]),_:1})]),_:1}),t(f,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[ye,t(C,{name:"fileList",rules:[{required:!0,message:"Este campo es obligatorio"}]},{default:s(()=>[t(J,{"file-list":n.fileList,"before-upload":z,onRemove:N},{default:s(()=>[t(i,null,{default:s(()=>[t(G),_(" Seleccionar archivo PDF ")]),_:1})]),_:1},8,["file-list"]),m.value?(y(),x("div",xe,[e("iframe",{src:m.value,width:"100%",height:"300px"},null,8,we)])):E("",!0)]),_:1})]),_:1})]),_:1})]),_:1},8,["model","rules"])]),_:1},8,["visible","onOk"]),t(S,{visible:w.value,"onUpdate:visible":a[5]||(a[5]=l=>w.value=l),title:"Registro de título",style:{"min-width":"1000px"}},{footer:s(()=>[e("div",Me,[t(i,{onClick:a[4]||(a[4]=l=>w.value==!1)},{default:s(()=>[_(" Aceptar ")]),_:1})])]),default:s(()=>[t(M,{gutter:16},{default:s(()=>[t(f,{xs:24,sm:24,md:24,lg:24},{default:s(()=>[L.value?(y(),x("div",De,[e("iframe",{src:oe(h)+"/"+L.value,width:"100%",height:"500px"},null,8,Le)])):E("",!0)]),_:1})]),_:1})]),_:1},8,["visible"])])],64)}}};export{je as default};
