import{r as p,a1 as B,y as w,C as b,o as l,c as u,a as s,u as R,w as o,F as _,Z as L,d as f,b as i,t as c,s as O,E as U,B as $,a7 as j,a8 as H,a9 as A,h as F}from"./app-5e7105fb.js";import{_ as M}from"./AuthenticatedLayout-ff76e053.js";import"./logotiny-c4b525af.js";import"./Header-86d9ab08.js";import"./AntdIcon-fd0a2438.js";import"./DownOutlined-b16e9bc5.js";/* empty css                                                            */const V={class:"bg-white overflow-hidden shadow-sm sm:rounded-lg p-4 pb-0",style:{height:"calc(100vh - 103px)"}},z={class:"flex justify-end mb-3 mr-3"},G={style:{"font-size":"0.7rem"}},K={key:3,style:{"text-align":"center"}},ee={__name:"usuarioDiario",setup(Y){const g=p([]),y=p([]),h=p([{total_inscripciones:0}]),v=p(!1),x=p(null);B(async()=>{try{v.value=!0;const e=await w.post("reporte-usuarios");g.value=e.data.datos||[],y.value=e.data.fechas||[],h.value=e.data.totales||[{total_inscripciones:0}]}catch(e){x.value=e,console.error("Error al cargar datos:",e)}finally{v.value=!1}});const k=b(()=>{const e={};return y.value.forEach(t=>{const a=t.substring(0,7);e[a]||(e[a]={monthName:new Date(t).toLocaleString("es-ES",{month:"long"}).toUpperCase(),dates:[]}),e[a].dates.push(t)}),e}),S=b(()=>{const e=[{title:"NOMBRE DE USUARIO",dataIndex:"name",key:"name",width:300,fixed:"left",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}];return Object.values(k.value).forEach(t=>{e.push({title:t.monthName,key:t.monthName,align:"center",children:t.dates.map(a=>({title:a.split("-")[2],dataIndex:`${a}`,key:`${a}`,width:30,customHeaderCell:()=>({style:{background:"#e3e3e3",textAlign:"center",height:"40px",width:"40px",padding:"0 0px"}})})),customHeaderCell:()=>({style:{background:"#e3e3e3"}})})}),e.push({title:"TOTAL",dataIndex:"total",key:"total",width:40,align:"center",fixed:"right",customHeaderCell:()=>({style:{background:"#e3e3e3"}})}),e}),E=b(()=>!g.value||g.value.length===0?[{key:"no-data",codigo:"",programa:x.value?"Error al cargar datos":"No se encontraron datos",...Object.fromEntries((y.value||[]).map(e=>[`${e}`,""])),inscripciones:""}]:g.value.map((e,t)=>({key:t,...e}))),C=b(()=>{var e;return((e=h.value[0])==null?void 0:e.total_inscripciones)||0}),D=e=>{var t;return((t=h.value[0])==null?void 0:t[`${e}`])||0},I=async()=>{try{const e=await w.post("reporte-usuarios",{descargar:1},{responseType:"blob"}),t=new Date,a=[t.getFullYear(),String(t.getMonth()+1).padStart(2,"0"),String(t.getDate()).padStart(2,"0"),String(t.getHours()).padStart(2,"0"),String(t.getMinutes()).padStart(2,"0"),String(t.getSeconds()).padStart(2,"0")].join("-"),d=window.URL.createObjectURL(new Blob([e.data])),r=document.createElement("a");r.href=d,r.setAttribute("download",`${a}_resumen_inscripciones.pdf`),document.body.appendChild(r),r.click(),r.remove(),window.URL.revokeObjectURL(d)}catch(e){console.error("Error al descargar:",e),notification.error({message:"Error",description:"No se pudo descargar el archivo"})}};return(e,t)=>{const a=$,d=j,r=H,N=A,T=F;return l(),u(_,null,[s(R(L),{title:"Resumen programa diario"}),s(M,null,{default:o(()=>[f("div",V,[f("div",z,[s(a,{type:"primary",style:{"border-radius":"5px",background:"#476175",border:"none"},onClick:t[0]||(t[0]=n=>I())},{default:o(()=>t[1]||(t[1]=[i(" Descargar ")])),_:1})]),f("div",G,[s(T,{columns:S.value,"data-source":E.value,bordered:"",size:"small",pagination:!1,scroll:{x:200,y:"calc(100vh - 270px)"}},{bodyCell:o(({column:n,record:m})=>[n.dataIndex==="name"?(l(),u(_,{key:0},[i(c(m.name)+" "+c(m.paterno),1)],64)):n.dataIndex==="codigo"?(l(),u(_,{key:1},[i(c(m.codigo),1)],64)):n.dataIndex==="inscripciones"?(l(),u(_,{key:2},[i(c(m.inscripciones),1)],64)):(l(),u("div",K,c(m[n.dataIndex]),1))]),summary:o(()=>[s(N,{fixed:"bottom"},{default:o(()=>[s(r,null,{default:o(()=>[s(d,{"col-span":1,style:{"text-align":"right","font-weight":"bold"}},{default:o(()=>t[2]||(t[2]=[i(" Totales: ")])),_:1}),(l(!0),u(_,null,O(y.value,n=>(l(),U(d,{key:n,style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(c(D(n)),1)]),_:2},1024))),128)),s(d,{style:{"text-align":"center","font-weight":"bold"}},{default:o(()=>[i(c(C.value),1)]),_:1})]),_:1})]),_:1})]),_:1},8,["columns","data-source"])])])]),_:1})],64)}}};export{ee as default};
