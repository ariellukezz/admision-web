import{a as e,r as m,C as de,e as ce,o as b,c as k,u as c,w as t,F as R,Z as pe,d as O,b as x,t as v,f as y,E as $,a5 as V,M as T,I as fe,B as me,an as _e,_ as ve,h as ge,P as be,a6 as Oe,k as xe,l as ye,j as he,O as we,m as Ue,q as Pe,G as Ce}from"./app-6dd2fb5e.js";import{_ as ke}from"./AuthenticatedLayout-b9ac0019.js";import"./es-d40d286d.js";import{_ as Ie}from"./_plugin-vue_export-helper-c27b6911.js";import{A as z}from"./AntdIcon-8fcb511c.js";import{S as je}from"./SearchOutlined-63ff9026.js";import{U}from"./UserOutlined-ab3658c5.js";import{I as G}from"./IdcardOutlined-7faae8d9.js";import{F as Ae}from"./FormOutlined-f76475c6.js";import{D as Se}from"./DeleteOutlined-116f711d.js";import{T as $e}from"./TeamOutlined-17c83d74.js";import"./logotiny-c4b525af.js";import"./Header-ae457ec7.js";import"./perfil-8483bf70.js";/* empty css                                                               */import"./SafetyCertificateOutlined-69c10da4.js";import"./EditOutlined-9229ec09.js";import"./DownOutlined-0336cddf.js";/* empty css                                                            */var Ve={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M908 640H804V488c0-4.4-3.6-8-8-8H548v-96h108c8.8 0 16-7.2 16-16V80c0-8.8-7.2-16-16-16H368c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h108v96H228c-4.4 0-8 3.6-8 8v152H116c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16H292v-88h440v88H620c-8.8 0-16 7.2-16 16v288c0 8.8 7.2 16 16 16h288c8.8 0 16-7.2 16-16V656c0-8.8-7.2-16-16-16zm-564 76v168H176V716h168zm84-408V140h168v168H428zm420 576H680V716h168v168z"}}]},name:"apartment",theme:"outlined"};const ze=Ve;var Ee={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M928 160H96c-17.7 0-32 14.3-32 32v640c0 17.7 14.3 32 32 32h832c17.7 0 32-14.3 32-32V192c0-17.7-14.3-32-32-32zm-40 110.8V792H136V270.8l-27.6-21.5 39.3-50.5 42.8 33.3h643.1l42.8-33.3 39.3 50.5-27.7 21.5zM833.6 232L512 482 190.4 232l-42.8-33.3-39.3 50.5 27.6 21.5 341.6 265.6a55.99 55.99 0 0068.7 0L888 270.8l27.6-21.5-39.3-50.5-42.7 33.2z"}}]},name:"mail",theme:"outlined"};const Me=Ee;var De={icon:{tag:"svg",attrs:{viewBox:"64 64 896 896",focusable:"false"},children:[{tag:"path",attrs:{d:"M877.1 238.7L770.6 132.3c-13-13-30.4-20.3-48.8-20.3s-35.8 7.2-48.8 20.3L558.3 246.8c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l89.6 89.7a405.46 405.46 0 01-86.4 127.3c-36.7 36.9-79.6 66-127.2 86.6l-89.6-89.7c-13-13-30.4-20.3-48.8-20.3a68.2 68.2 0 00-48.8 20.3L132.3 673c-13 13-20.3 30.5-20.3 48.9 0 18.5 7.2 35.8 20.3 48.9l106.4 106.4c22.2 22.2 52.8 34.9 84.2 34.9 6.5 0 12.8-.5 19.2-1.6 132.4-21.8 263.8-92.3 369.9-198.3C818 606 888.4 474.6 910.4 342.1c6.3-37.6-6.3-76.3-33.3-103.4zm-37.6 91.5c-19.5 117.9-82.9 235.5-178.4 331s-213 158.9-330.9 178.4c-14.8 2.5-30-2.5-40.8-13.2L184.9 721.9 295.7 611l119.8 120 .9.9 21.6-8a481.29 481.29 0 00285.7-285.8l8-21.6-120.8-120.7 110.8-110.9 104.5 104.5c10.8 10.8 15.8 26 13.3 40.8z"}}]},name:"phone",theme:"outlined"};const He=De;function q(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),i.forEach(function(d){Ne(s,d,o[d])})}return s}function Ne(s,n,o){return n in s?Object.defineProperty(s,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[n]=o,s}var E=function(n,o){var i=q({},n,o.attrs);return e(z,q({},i,{icon:ze}),null)};E.displayName="ApartmentOutlined";E.inheritAttrs=!1;const Be=E;function Z(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),i.forEach(function(d){Fe(s,d,o[d])})}return s}function Fe(s,n,o){return n in s?Object.defineProperty(s,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[n]=o,s}var M=function(n,o){var i=Z({},n,o.attrs);return e(z,Z({},i,{icon:Me}),null)};M.displayName="MailOutlined";M.inheritAttrs=!1;const Le=M;function J(s){for(var n=1;n<arguments.length;n++){var o=arguments[n]!=null?Object(arguments[n]):{},i=Object.keys(o);typeof Object.getOwnPropertySymbols=="function"&&(i=i.concat(Object.getOwnPropertySymbols(o).filter(function(d){return Object.getOwnPropertyDescriptor(o,d).enumerable}))),i.forEach(function(d){Re(s,d,o[d])})}return s}function Re(s,n,o){return n in s?Object.defineProperty(s,n,{value:o,enumerable:!0,configurable:!0,writable:!0}):s[n]=o,s}var D=function(n,o){var i=J({},n,o.attrs);return e(z,J({},i,{icon:He}),null)};D.displayName="PhoneOutlined";D.inheritAttrs=!1;const Te=D;const Ge={class:"header"},qe={class:"header-actions"},Ze={key:0,class:"user-cell"},Je={class:"user-info"},Qe={class:"user-name"},We={class:"user-dni"},Xe={key:5,style:{display:"flex",gap:"2px"}},Ye={class:"foto-box"},Ke={__name:"index",setup(s){const n=m(!1),o=m(""),i=m([]),d=m([]),Q=m([{value:1,label:"Administrador"},{value:2,label:"Revisor"},{value:3,label:"Segundas Director"},{value:6,label:"Simulacro"},{value:7,label:"Calificador"}]),h=m(!1),I=m(!1),j=m(null),P=m(null),r=de({id:null,dni:"",name:"",paterno:"",materno:"",email:"",celular:"",rol_id:null,rol:"",id_proceso:null,procesoso:"",estado:!0}),W=[{title:"Usuario",dataIndex:"usuario"},{title:"Email",dataIndex:"email"},{title:"Rol",dataIndex:"rol"},{title:"Proceso",dataIndex:"proceso"},{title:"Estado",dataIndex:"estado",width:90,align:"center"},{title:"Acciones",dataIndex:"acciones",width:100,align:"center"}];ce(o,C);function X(u){j.value=u.file,P.value=URL.createObjectURL(u.file)}function Y(){Object.assign(r,{id:null,dni:"",name:"",paterno:"",materno:"",email:"",celular:"",rol_id:null,id_proceso:null,estado:!0}),P.value=null,h.value=!0}function K(u){Object.assign(r,u),P.value=u.foto_url||null,h.value=!0}async function ee(){I.value=!0;const u=new FormData;Object.keys(r).forEach(a=>u.append(a,r[a])),j.value&&u.append("foto",j.value),await axios.post("save-user",u),I.value=!1,h.value=!1,V.success("Usuario guardado"),C()}function te(u){T.confirm({title:"Eliminar usuario",content:"Esta acción no se puede deshacer",okType:"danger",onOk:async()=>{await axios.post("delete-user",{id:u}),C()}})}async function C(){const{data:u}=await axios.post("get-usuarios",{term:o.value});i.value=u.usuarios}async function ae(){const{data:u}=await axios.get("get-select-procesos");d.value=u.datos}const A=m(""),ne=async()=>{const u=await axios.post("/crear-certificado-digital",{dni:r.dni,email:r.email,usuario:`${r.name} ${r.paterno} ${r.materno}`,rol:r.rol,departamento:"Dirección de admisión",password_p12:A.value,valid_days:365});u.data.success?(V.success(u.data.message||"Certificado creado exitosamente"),signatureModalVisible.value=!1):V.error(u.data.message||"Error al crear certificado")};return C(),ae(),(u,a)=>{const g=fe,w=me,H=_e,S=ve,oe=ge,le=be,re=Oe,f=xe,_=ye,N=he,se=we,ie=Ue,B=Pe,F=T,ue=Ce;return b(),k(R,null,[e(c(pe),{title:"Usuarios"}),e(ke,null,{default:t(()=>[e(le,{class:"mac-card",bordered:!1},{default:t(()=>[O("div",Ge,[a[15]||(a[15]=O("h2",null,"Gestión de Usuarios",-1)),O("div",qe,[e(g,{value:o.value,"onUpdate:value":a[0]||(a[0]=l=>o.value=l),placeholder:"Buscar usuario","allow-clear":"",style:{width:"260px"}},{prefix:t(()=>[e(c(je))]),_:1},8,["value"]),e(w,{type:"primary",onClick:Y},{default:t(()=>a[14]||(a[14]=[x(" Nuevo Usuario ")])),_:1})])]),e(oe,{"data-source":i.value,columns:W,"row-key":"id",class:"mac-table"},{bodyCell:t(({column:l,record:p})=>[l.dataIndex==="usuario"?(b(),k("div",Ze,[e(H,{src:p.foto_url,size:"large"},{icon:t(()=>[e(c(U))]),_:2},1032,["src"]),O("div",Je,[O("div",Qe,v(p.name)+" "+v(p.paterno)+" "+v(p.materno),1),O("div",We," DNI: "+v(p.dni),1)])])):y("",!0),l.dataIndex==="email"?(b(),k(R,{key:1},[x(v(p.email),1)],64)):y("",!0),l.dataIndex==="rol"?(b(),$(S,{key:2,color:"blue"},{default:t(()=>[x(v(p.rol),1)]),_:2},1024)):y("",!0),l.dataIndex==="proceso"?(b(),$(S,{key:3,color:"purple"},{default:t(()=>[x(v(p.proceso),1)]),_:2},1024)):y("",!0),l.dataIndex==="estado"?(b(),$(S,{key:4,color:p.estado?"green":"red"},{default:t(()=>[x(v(p.estado?"Activo":"Inactivo"),1)]),_:2},1032,["color"])):y("",!0),l.dataIndex==="acciones"?(b(),k("div",Xe,[e(w,{onClick:a[1]||(a[1]=L=>n.value=!0),size:"small",style:{background:"white",height:"28px",border:"1px solid #d9d9d9",color:"green",display:"flex","align-items":"center"}},{default:t(()=>[e(c(G))]),_:1}),e(w,{onClick:L=>K(p),size:"small",style:{background:"white",height:"28px",border:"1px solid #d9d9d9",color:"#1890ff",display:"flex","align-items":"center"}},{default:t(()=>[e(c(Ae))]),_:2},1032,["onClick"]),e(w,{onClick:L=>te(p),size:"small",style:{background:"white",height:"28px",border:"1px solid #d9d9d9",color:"#ff4d4f",display:"flex","align-items":"center"}},{default:t(()=>[e(c(Se))]),_:2},1032,["onClick"])])):y("",!0)]),_:1},8,["data-source"])]),_:1}),e(F,{open:h.value,"onUpdate:open":a[11]||(a[11]=l=>h.value=l),title:r.id?"Editar Usuario":"Nuevo Usuario",width:"780px","confirm-loading":I.value,onOk:ee},{default:t(()=>[e(B,{layout:"vertical"},{default:t(()=>[e(f,{label:"Foto"},{default:t(()=>[O("div",Ye,[e(H,{size:96,src:P.value},{icon:t(()=>[e(c(U))]),_:1},8,["src"]),e(re,{"before-upload":()=>!1,"show-upload-list":!1,onChange:X},{default:t(()=>[e(w,{size:"small"},{default:t(()=>a[16]||(a[16]=[x("Cambiar foto")])),_:1})]),_:1})])]),_:1}),e(ie,{gutter:16},{default:t(()=>[e(_,{span:8},{default:t(()=>[e(f,{label:"DNI"},{default:t(()=>[e(g,{value:r.dni,"onUpdate:value":a[2]||(a[2]=l=>r.dni=l)},{prefix:t(()=>[e(c(G))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Celular"},{default:t(()=>[e(g,{value:r.celular,"onUpdate:value":a[3]||(a[3]=l=>r.celular=l)},{prefix:t(()=>[e(c(Te))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Email"},{default:t(()=>[e(g,{value:r.email,"onUpdate:value":a[4]||(a[4]=l=>r.email=l)},{prefix:t(()=>[e(c(Le))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Nombres"},{default:t(()=>[e(g,{value:r.name,"onUpdate:value":a[5]||(a[5]=l=>r.name=l)},{prefix:t(()=>[e(c(U))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Apellido Paterno"},{default:t(()=>[e(g,{value:r.paterno,"onUpdate:value":a[6]||(a[6]=l=>r.paterno=l)},{prefix:t(()=>[e(c(U))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Apellido Materno"},{default:t(()=>[e(g,{value:r.materno,"onUpdate:value":a[7]||(a[7]=l=>r.materno=l)},{prefix:t(()=>[e(c(U))]),_:1},8,["value"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Rol"},{default:t(()=>[e(N,{value:r.rol_id,"onUpdate:value":a[8]||(a[8]=l=>r.rol_id=l),options:Q.value},{prefix:t(()=>[e(c($e))]),_:1},8,["value","options"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Proceso"},{default:t(()=>[e(N,{value:r.id_proceso,"onUpdate:value":a[9]||(a[9]=l=>r.id_proceso=l),options:d.value},{prefix:t(()=>[e(c(Be))]),_:1},8,["value","options"])]),_:1})]),_:1}),e(_,{span:8},{default:t(()=>[e(f,{label:"Estado"},{default:t(()=>[e(se,{checked:r.estado,"onUpdate:checked":a[10]||(a[10]=l=>r.estado=l)},null,8,["checked"])]),_:1})]),_:1})]),_:1})]),_:1})]),_:1},8,["open","title","confirm-loading"]),e(F,{open:n.value,"onUpdate:open":a[13]||(a[13]=l=>n.value=l),title:"Certificado Digital",width:"480px",onOk:ne,"ok-text":"Crear certificado"},{default:t(()=>[e(B,{layout:"vertical"},{default:t(()=>[e(f,{label:"Contraseña para el archivo .p12"},{default:t(()=>[e(ue,{value:A.value,"onUpdate:value":a[12]||(a[12]=l=>A.value=l),placeholder:"Ingrese una contraseña segura"},null,8,["value"])]),_:1})]),_:1})]),_:1},8,["open"])]),_:1})],64)}}},Ot=Ie(Ke,[["__scopeId","data-v-e7781e83"]]);export{Ot as default};
