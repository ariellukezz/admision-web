import{r as l,o as k,c as B,a,u as N,w as c,F as P,Z as R,d as o,v as A,b as x,y as C,B as F,b3 as M,h as D}from"./app-d59ad026.js";import{L as U}from"./LayoutCalificador-a051b094.js";import{r as V,u as E}from"./xlsx-4f9172c7.js";import{_ as L}from"./_plugin-vue_export-helper-c27b6911.js";import"./DropdownLink-79e72b4e.js";import"./logotiny-c4b525af.js";/* empty css                                                                          */import"./TopMenu-af03151c.js";import"./perfil-81e8a979.js";/* empty css                                                               */import"./UserOutlined-fc2e5cab.js";import"./AntdIcon-fb17ae9a.js";import"./EditOutlined-8ce5359b.js";import"./DownOutlined-562c666f.js";const O={class:"p-4",style:{width:"100%","max-width":"1300px",background:"white","border-radius":"8px"}},G={class:"flex justify-between"},T={style:{display:"flex","justify-content":"flex-end"}},Z={style:{display:"flex"}},q={__name:"SubirResultado",setup(z){const i=l([]),r=l(0),p=l(""),m=async()=>{r.value=0;try{const t=await C.post("subir-excel-simulacro",{data:i.value},{onUploadProgress:e=>{e.lengthComputable&&(r.value=Math.round(e.loaded/e.total*100))}});console.log("Respuesta del servidor:",t.data),r.value=100}catch(t){r.value=70,p.value="exception",console.error("Error:",t)}},b=t=>{const e=t.target.files[0],s=new FileReader;s.onload=d=>{const u=new Uint8Array(d.target.result),n=V(u,{type:"array"}),y=n.SheetNames[0],v=n.Sheets[y],_=E.sheet_to_json(v,{header:1}),g=_[0],w=_.slice(1).map(I=>{const f={};return g.forEach((S,j)=>{f[S]=I[j]}),f});i.value=w},s.readAsArrayBuffer(e)},h=l([{title:"DNI",dataIndex:"dni"},{title:"Ap. Paterno",dataIndex:"paterno"},{title:"Ap. Materno",dataIndex:"materno"},{title:"Mombres",dataIndex:"nombres"},{title:"Puntaje",dataIndex:"puntaje"},{title:"Fecha",dataIndex:"fecha"},{title:"Puesto Programa",dataIndex:"puesto_programa"},{title:"Puesto General",dataIndex:"puesto_general"}]);return(t,e)=>{const s=F,d=M,u=D;return k(),B(P,null,[a(N(R),{title:"Inicio"}),a(U,null,{default:c(()=>[o("div",O,[o("form",{onSubmit:e[0]||(e[0]=A((...n)=>t.submit&&t.submit(...n),["prevent"]))},[o("div",G,[o("input",{type:"file",onChange:b},null,32),o("div",T,[a(s,{class:"mr-2",style:{"border-radius":"5px",height:"38px",border:"solid 1px var(--primary-color)",color:"var(--primary-color)"},onClick:m},{default:c(()=>e[1]||(e[1]=[x("Ejemplo")])),_:1}),a(s,{style:{height:"38px","border-radius":"5px",border:"none",color:"white",background:"var(--primary-color)"},onClick:m},{default:c(()=>e[2]||(e[2]=[x(" Subir resultado")])),_:1})])])],32),o("div",Z,[a(d,{percent:r.value,status:p.value},null,8,["percent","status"])]),o("div",null,[a(u,{dataSource:i.value,columns:h.value},null,8,["dataSource","columns"])])])]),_:1})],64)}}},ne=L(q,[["__scopeId","data-v-84322550"]]);export{ne as default};
