import{a3 as b,a4 as k}from"./app-03b39463.js";import{x as L}from"./xlsx-dd522480.js";var g={},P={get exports(){return g},set exports(h){g=h}};const F=b(L);(function(h,o){Object.defineProperty(o,"__esModule",{value:!0}),o.libraryName=o.xlsx=o.getWorksheetColumnWidths=o.getJsonSheetRow=o.getContentProperty=o.utils=void 0;const u=F;Object.defineProperty(o,"utils",{enumerable:!0,get:function(){return u.utils}});const v=(e,r)=>{const l=(s,i)=>{const n=s[i[0]];return i.length===1?n??"":n===void 0||typeof n=="string"||typeof n=="boolean"||typeof n=="number"||n instanceof Date?"":l(n,i.slice(1))},t=r.split(".");return l(e,t)};o.getContentProperty=v;const C=(e,r)=>{const l={};return r.forEach(t=>{typeof t.value=="function"?l[t.label]=t.value(e):l[t.label]=(0,o.getContentProperty)(e,t.value)}),l};o.getJsonSheetRow=C;const _=(e,r,l)=>{var t;for(let s=0;s<r.length;s+=1){const i=l[s];if(!i)continue;const n=u.utils.decode_col(r[s]),a=u.utils.decode_range((t=e["!ref"])!==null&&t!==void 0?t:"");for(let c=a.s.r+1;c<=a.e.r;++c){const f=u.utils.encode_cell({r:c,c:n});e[f]&&(e[f].z=i)}}},m=e=>{var r;const l=u.utils.decode_range((r=e["!ref"])!==null&&r!==void 0?r:""),t=[];for(let s=l.s.c;s<=l.e.c;s++){const i=u.utils.encode_col(s);t.push(i)}return t},p=e=>typeof e=="string"?e.length:typeof e=="number"?e.toString().length:typeof e=="boolean"?e?4:5:e instanceof Date?e.toString().length:0,W=(e,r=1)=>m(e).map(t=>({width:Object.keys(e).filter(n=>n.replace(/[0-9]/g,"")===t).reduce((n,a)=>{const c=e[a],f=p(c.v);if(!c.z)return Math.max(n,f);const d=c.z.length,R=Math.max(f,d);return Math.max(n,R)},0)+r}));o.getWorksheetColumnWidths=W;const w=(e,r)=>{let l;e.content.length>0?l=e.content.map(n=>(0,o.getJsonSheetRow)(n,e.columns)):l=e.columns.map(n=>({[n.label]:""}));const t=u.utils.json_to_sheet(l),s=m(t),i=e.columns.map(n=>{var a;return(a=n.format)!==null&&a!==void 0?a:null});return _(t,s,i),t["!cols"]=(0,o.getWorksheetColumnWidths)(t,r.extraLength),t},y=(e,r={})=>{var l,t,s,i,n;const a=!!r.RTL;(l=e.Workbook)!==null&&l!==void 0||(e.Workbook={}),(t=(n=e.Workbook).Views)!==null&&t!==void 0||(n.Views=[{}]),e.Workbook.Views.forEach(d=>{d.RTL=a});const c=`${(s=r.fileName)!==null&&s!==void 0?s:"Spreadsheet"}.xlsx`,f=(i=r.writeOptions)!==null&&i!==void 0?i:{};return r.writeMode==="write"?(0,u.write)(e,f):r.writeMode==="writeFile"?(0,u.writeFile)(e,c,f):f.type==="buffer"?(0,u.write)(e,f):(0,u.writeFile)(e,c,f)},x=(e,r={},l=()=>{})=>{if(e.length===0)return;const t=u.utils.book_new();return e.forEach((s,i)=>{var n;const a=w(s,r),c=(n=s.sheet)!==null&&n!==void 0?n:`Sheet ${i+1}`;u.utils.book_append_sheet(t,a,c)}),l(t),y(t,r)};o.xlsx=x,o.default=o.xlsx,o.libraryName="json-as-xlsx",h.exports=o.xlsx,h.exports.getContentProperty=o.getContentProperty,h.exports.getJsonSheetRow=o.getJsonSheetRow,h.exports.getWorksheetColumnWidths=o.getWorksheetColumnWidths,h.exports.utils=u.utils})(P,g);const O=k(g);export{O as x};
